var Ly=r=>{throw TypeError(r)};var Dd=(r,t,e)=>t.has(r)||Ly("Cannot "+e);var Zt=(r,t,e)=>(Dd(r,t,"read from private field"),e?e.call(r):t.get(r)),Gn=(r,t,e)=>t.has(r)?Ly("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),Ze=(r,t,e,n)=>(Dd(r,t,"write to private field"),n?n.call(r,e):t.set(r,e),e),qn=(r,t,e)=>(Dd(r,t,"access private method"),e);var Iy=(r,t,e,n)=>({set _(s){Ze(r,t,s,e)},get _(){return Zt(r,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();var Md={exports:{}},so={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Py;function zE(){if(Py)return so;Py=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(n,s,o){var c=null;if(o!==void 0&&(c=""+o),s.key!==void 0&&(c=""+s.key),"key"in s){o={};for(var h in s)h!=="key"&&(o[h]=s[h])}else o=s;return s=o.ref,{$$typeof:r,type:n,key:c,ref:s!==void 0?s:null,props:o}}return so.Fragment=t,so.jsx=e,so.jsxs=e,so}var By;function UE(){return By||(By=1,Md.exports=zE()),Md.exports}var st=UE(),Nd={exports:{}},wt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fy;function jE(){if(Fy)return wt;Fy=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function y(R){return R===null||typeof R!="object"?null:(R=_&&R[_]||R["@@iterator"],typeof R=="function"?R:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,S={};function w(R,$,J){this.props=R,this.context=$,this.refs=S,this.updater=J||b}w.prototype.isReactComponent={},w.prototype.setState=function(R,$){if(typeof R!="object"&&typeof R!="function"&&R!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,R,$,"setState")},w.prototype.forceUpdate=function(R){this.updater.enqueueForceUpdate(this,R,"forceUpdate")};function C(){}C.prototype=w.prototype;function D(R,$,J){this.props=R,this.context=$,this.refs=S,this.updater=J||b}var x=D.prototype=new C;x.constructor=D,A(x,w.prototype),x.isPureReactComponent=!0;var I=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},P=Object.prototype.hasOwnProperty;function G(R,$,J,N,q,K){return J=K.ref,{$$typeof:r,type:R,key:$,ref:J!==void 0?J:null,props:K}}function Y(R,$){return G(R.type,$,void 0,void 0,void 0,R.props)}function j(R){return typeof R=="object"&&R!==null&&R.$$typeof===r}function at(R){var $={"=":"=0",":":"=2"};return"$"+R.replace(/[=:]/g,function(J){return $[J]})}var nt=/\/+/g;function pt(R,$){return typeof R=="object"&&R!==null&&R.key!=null?at(""+R.key):$.toString(36)}function et(){}function Et(R){switch(R.status){case"fulfilled":return R.value;case"rejected":throw R.reason;default:switch(typeof R.status=="string"?R.then(et,et):(R.status="pending",R.then(function($){R.status==="pending"&&(R.status="fulfilled",R.value=$)},function($){R.status==="pending"&&(R.status="rejected",R.reason=$)})),R.status){case"fulfilled":return R.value;case"rejected":throw R.reason}}throw R}function St(R,$,J,N,q){var K=typeof R;(K==="undefined"||K==="boolean")&&(R=null);var Q=!1;if(R===null)Q=!0;else switch(K){case"bigint":case"string":case"number":Q=!0;break;case"object":switch(R.$$typeof){case r:case t:Q=!0;break;case g:return Q=R._init,St(Q(R._payload),$,J,N,q)}}if(Q)return q=q(R),Q=N===""?"."+pt(R,0):N,I(q)?(J="",Q!=null&&(J=Q.replace(nt,"$&/")+"/"),St(q,$,J,"",function(Ut){return Ut})):q!=null&&(j(q)&&(q=Y(q,J+(q.key==null||R&&R.key===q.key?"":(""+q.key).replace(nt,"$&/")+"/")+Q)),$.push(q)),1;Q=0;var Z=N===""?".":N+":";if(I(R))for(var rt=0;rt<R.length;rt++)N=R[rt],K=Z+pt(N,rt),Q+=St(N,$,J,K,q);else if(rt=y(R),typeof rt=="function")for(R=rt.call(R),rt=0;!(N=R.next()).done;)N=N.value,K=Z+pt(N,rt++),Q+=St(N,$,J,K,q);else if(K==="object"){if(typeof R.then=="function")return St(Et(R),$,J,N,q);throw $=String(R),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return Q}function k(R,$,J){if(R==null)return R;var N=[],q=0;return St(R,N,"","",function(K){return $.call(J,K,q++)}),N}function U(R){if(R._status===-1){var $=R._result;$=$(),$.then(function(J){(R._status===0||R._status===-1)&&(R._status=1,R._result=J)},function(J){(R._status===0||R._status===-1)&&(R._status=2,R._result=J)}),R._status===-1&&(R._status=0,R._result=$)}if(R._status===1)return R._result.default;throw R._result}var it=typeof reportError=="function"?reportError:function(R){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof R=="object"&&R!==null&&typeof R.message=="string"?String(R.message):String(R),error:R});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",R);return}console.error(R)};function bt(){}return wt.Children={map:k,forEach:function(R,$,J){k(R,function(){$.apply(this,arguments)},J)},count:function(R){var $=0;return k(R,function(){$++}),$},toArray:function(R){return k(R,function($){return $})||[]},only:function(R){if(!j(R))throw Error("React.Children.only expected to receive a single React element child.");return R}},wt.Component=w,wt.Fragment=e,wt.Profiler=s,wt.PureComponent=D,wt.StrictMode=n,wt.Suspense=d,wt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,wt.__COMPILER_RUNTIME={__proto__:null,c:function(R){return O.H.useMemoCache(R)}},wt.cache=function(R){return function(){return R.apply(null,arguments)}},wt.cloneElement=function(R,$,J){if(R==null)throw Error("The argument must be a React element, but you passed "+R+".");var N=A({},R.props),q=R.key,K=void 0;if($!=null)for(Q in $.ref!==void 0&&(K=void 0),$.key!==void 0&&(q=""+$.key),$)!P.call($,Q)||Q==="key"||Q==="__self"||Q==="__source"||Q==="ref"&&$.ref===void 0||(N[Q]=$[Q]);var Q=arguments.length-2;if(Q===1)N.children=J;else if(1<Q){for(var Z=Array(Q),rt=0;rt<Q;rt++)Z[rt]=arguments[rt+2];N.children=Z}return G(R.type,q,void 0,void 0,K,N)},wt.createContext=function(R){return R={$$typeof:c,_currentValue:R,_currentValue2:R,_threadCount:0,Provider:null,Consumer:null},R.Provider=R,R.Consumer={$$typeof:o,_context:R},R},wt.createElement=function(R,$,J){var N,q={},K=null;if($!=null)for(N in $.key!==void 0&&(K=""+$.key),$)P.call($,N)&&N!=="key"&&N!=="__self"&&N!=="__source"&&(q[N]=$[N]);var Q=arguments.length-2;if(Q===1)q.children=J;else if(1<Q){for(var Z=Array(Q),rt=0;rt<Q;rt++)Z[rt]=arguments[rt+2];q.children=Z}if(R&&R.defaultProps)for(N in Q=R.defaultProps,Q)q[N]===void 0&&(q[N]=Q[N]);return G(R,K,void 0,void 0,null,q)},wt.createRef=function(){return{current:null}},wt.forwardRef=function(R){return{$$typeof:h,render:R}},wt.isValidElement=j,wt.lazy=function(R){return{$$typeof:g,_payload:{_status:-1,_result:R},_init:U}},wt.memo=function(R,$){return{$$typeof:f,type:R,compare:$===void 0?null:$}},wt.startTransition=function(R){var $=O.T,J={};O.T=J;try{var N=R(),q=O.S;q!==null&&q(J,N),typeof N=="object"&&N!==null&&typeof N.then=="function"&&N.then(bt,it)}catch(K){it(K)}finally{O.T=$}},wt.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},wt.use=function(R){return O.H.use(R)},wt.useActionState=function(R,$,J){return O.H.useActionState(R,$,J)},wt.useCallback=function(R,$){return O.H.useCallback(R,$)},wt.useContext=function(R){return O.H.useContext(R)},wt.useDebugValue=function(){},wt.useDeferredValue=function(R,$){return O.H.useDeferredValue(R,$)},wt.useEffect=function(R,$,J){var N=O.H;if(typeof J=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return N.useEffect(R,$)},wt.useId=function(){return O.H.useId()},wt.useImperativeHandle=function(R,$,J){return O.H.useImperativeHandle(R,$,J)},wt.useInsertionEffect=function(R,$){return O.H.useInsertionEffect(R,$)},wt.useLayoutEffect=function(R,$){return O.H.useLayoutEffect(R,$)},wt.useMemo=function(R,$){return O.H.useMemo(R,$)},wt.useOptimistic=function(R,$){return O.H.useOptimistic(R,$)},wt.useReducer=function(R,$,J){return O.H.useReducer(R,$,J)},wt.useRef=function(R){return O.H.useRef(R)},wt.useState=function(R){return O.H.useState(R)},wt.useSyncExternalStore=function(R,$,J){return O.H.useSyncExternalStore(R,$,J)},wt.useTransition=function(){return O.H.useTransition()},wt.version="19.1.1",wt}var Hy;function Uf(){return Hy||(Hy=1,Nd.exports=jE()),Nd.exports}var ht=Uf(),Od={exports:{}},ao={},kd={exports:{}},Ld={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zy;function GE(){return zy||(zy=1,(function(r){function t(k,U){var it=k.length;k.push(U);t:for(;0<it;){var bt=it-1>>>1,R=k[bt];if(0<s(R,U))k[bt]=U,k[it]=R,it=bt;else break t}}function e(k){return k.length===0?null:k[0]}function n(k){if(k.length===0)return null;var U=k[0],it=k.pop();if(it!==U){k[0]=it;t:for(var bt=0,R=k.length,$=R>>>1;bt<$;){var J=2*(bt+1)-1,N=k[J],q=J+1,K=k[q];if(0>s(N,it))q<R&&0>s(K,N)?(k[bt]=K,k[q]=it,bt=q):(k[bt]=N,k[J]=it,bt=J);else if(q<R&&0>s(K,it))k[bt]=K,k[q]=it,bt=q;else break t}}return U}function s(k,U){var it=k.sortIndex-U.sortIndex;return it!==0?it:k.id-U.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;r.unstable_now=function(){return o.now()}}else{var c=Date,h=c.now();r.unstable_now=function(){return c.now()-h}}var d=[],f=[],g=1,_=null,y=3,b=!1,A=!1,S=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function I(k){for(var U=e(f);U!==null;){if(U.callback===null)n(f);else if(U.startTime<=k)n(f),U.sortIndex=U.expirationTime,t(d,U);else break;U=e(f)}}function O(k){if(S=!1,I(k),!A)if(e(d)!==null)A=!0,P||(P=!0,pt());else{var U=e(f);U!==null&&St(O,U.startTime-k)}}var P=!1,G=-1,Y=5,j=-1;function at(){return w?!0:!(r.unstable_now()-j<Y)}function nt(){if(w=!1,P){var k=r.unstable_now();j=k;var U=!0;try{t:{A=!1,S&&(S=!1,D(G),G=-1),b=!0;var it=y;try{e:{for(I(k),_=e(d);_!==null&&!(_.expirationTime>k&&at());){var bt=_.callback;if(typeof bt=="function"){_.callback=null,y=_.priorityLevel;var R=bt(_.expirationTime<=k);if(k=r.unstable_now(),typeof R=="function"){_.callback=R,I(k),U=!0;break e}_===e(d)&&n(d),I(k)}else n(d);_=e(d)}if(_!==null)U=!0;else{var $=e(f);$!==null&&St(O,$.startTime-k),U=!1}}break t}finally{_=null,y=it,b=!1}U=void 0}}finally{U?pt():P=!1}}}var pt;if(typeof x=="function")pt=function(){x(nt)};else if(typeof MessageChannel<"u"){var et=new MessageChannel,Et=et.port2;et.port1.onmessage=nt,pt=function(){Et.postMessage(null)}}else pt=function(){C(nt,0)};function St(k,U){G=C(function(){k(r.unstable_now())},U)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(k){k.callback=null},r.unstable_forceFrameRate=function(k){0>k||125<k?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Y=0<k?Math.floor(1e3/k):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_next=function(k){switch(y){case 1:case 2:case 3:var U=3;break;default:U=y}var it=y;y=U;try{return k()}finally{y=it}},r.unstable_requestPaint=function(){w=!0},r.unstable_runWithPriority=function(k,U){switch(k){case 1:case 2:case 3:case 4:case 5:break;default:k=3}var it=y;y=k;try{return U()}finally{y=it}},r.unstable_scheduleCallback=function(k,U,it){var bt=r.unstable_now();switch(typeof it=="object"&&it!==null?(it=it.delay,it=typeof it=="number"&&0<it?bt+it:bt):it=bt,k){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=it+R,k={id:g++,callback:U,priorityLevel:k,startTime:it,expirationTime:R,sortIndex:-1},it>bt?(k.sortIndex=it,t(f,k),e(d)===null&&k===e(f)&&(S?(D(G),G=-1):S=!0,St(O,it-bt))):(k.sortIndex=R,t(d,k),A||b||(A=!0,P||(P=!0,pt()))),k},r.unstable_shouldYield=at,r.unstable_wrapCallback=function(k){var U=y;return function(){var it=y;y=U;try{return k.apply(this,arguments)}finally{y=it}}}})(Ld)),Ld}var Uy;function qE(){return Uy||(Uy=1,kd.exports=GE()),kd.exports}var Id={exports:{}},He={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jy;function VE(){if(jy)return He;jy=1;var r=Uf();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var n={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(d,f,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:_==null?null:""+_,children:d,containerInfo:f,implementation:g}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return He.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,He.createPortal=function(d,f){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return o(d,f,null,g)},He.flushSync=function(d){var f=c.T,g=n.p;try{if(c.T=null,n.p=2,d)return d()}finally{c.T=f,n.p=g,n.d.f()}},He.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,n.d.C(d,f))},He.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},He.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var g=f.as,_=h(g,f.crossOrigin),y=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;g==="style"?n.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:_,integrity:y,fetchPriority:b}):g==="script"&&n.d.X(d,{crossOrigin:_,integrity:y,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},He.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var g=h(f.as,f.crossOrigin);n.d.M(d,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&n.d.M(d)},He.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var g=f.as,_=h(g,f.crossOrigin);n.d.L(d,g,{crossOrigin:_,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},He.preloadModule=function(d,f){if(typeof d=="string")if(f){var g=h(f.as,f.crossOrigin);n.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else n.d.m(d)},He.requestFormReset=function(d){n.d.r(d)},He.unstable_batchedUpdates=function(d,f){return d(f)},He.useFormState=function(d,f,g){return c.H.useFormState(d,f,g)},He.useFormStatus=function(){return c.H.useHostTransitionStatus()},He.version="19.1.1",He}var Gy;function YE(){if(Gy)return Id.exports;Gy=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Id.exports=VE(),Id.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qy;function XE(){if(qy)return ao;qy=1;var r=qE(),t=Uf(),e=YE();function n(i){var a="https://react.dev/errors/"+i;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)a+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var a=i,l=i;if(i.alternate)for(;a.return;)a=a.return;else{i=a;do a=i,(a.flags&4098)!==0&&(l=a.return),i=a.return;while(i)}return a.tag===3?l:null}function c(i){if(i.tag===13){var a=i.memoizedState;if(a===null&&(i=i.alternate,i!==null&&(a=i.memoizedState)),a!==null)return a.dehydrated}return null}function h(i){if(o(i)!==i)throw Error(n(188))}function d(i){var a=i.alternate;if(!a){if(a=o(i),a===null)throw Error(n(188));return a!==i?null:i}for(var l=i,u=a;;){var p=l.return;if(p===null)break;var m=p.alternate;if(m===null){if(u=p.return,u!==null){l=u;continue}break}if(p.child===m.child){for(m=p.child;m;){if(m===l)return h(p),i;if(m===u)return h(p),a;m=m.sibling}throw Error(n(188))}if(l.return!==u.return)l=p,u=m;else{for(var v=!1,E=p.child;E;){if(E===l){v=!0,l=p,u=m;break}if(E===u){v=!0,u=p,l=m;break}E=E.sibling}if(!v){for(E=m.child;E;){if(E===l){v=!0,l=m,u=p;break}if(E===u){v=!0,u=m,l=p;break}E=E.sibling}if(!v)throw Error(n(189))}}if(l.alternate!==u)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?i:a}function f(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i;for(i=i.child;i!==null;){if(a=f(i),a!==null)return a;i=i.sibling}return null}var g=Object.assign,_=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),D=Symbol.for("react.consumer"),x=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),j=Symbol.for("react.activity"),at=Symbol.for("react.memo_cache_sentinel"),nt=Symbol.iterator;function pt(i){return i===null||typeof i!="object"?null:(i=nt&&i[nt]||i["@@iterator"],typeof i=="function"?i:null)}var et=Symbol.for("react.client.reference");function Et(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===et?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case A:return"Fragment";case w:return"Profiler";case S:return"StrictMode";case O:return"Suspense";case P:return"SuspenseList";case j:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case b:return"Portal";case x:return(i.displayName||"Context")+".Provider";case D:return(i._context.displayName||"Context")+".Consumer";case I:var a=i.render;return i=i.displayName,i||(i=a.displayName||a.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case G:return a=i.displayName||null,a!==null?a:Et(i.type)||"Memo";case Y:a=i._payload,i=i._init;try{return Et(i(a))}catch{}}return null}var St=Array.isArray,k=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,it={pending:!1,data:null,method:null,action:null},bt=[],R=-1;function $(i){return{current:i}}function J(i){0>R||(i.current=bt[R],bt[R]=null,R--)}function N(i,a){R++,bt[R]=i.current,i.current=a}var q=$(null),K=$(null),Q=$(null),Z=$(null);function rt(i,a){switch(N(Q,a),N(K,i),N(q,null),a.nodeType){case 9:case 11:i=(i=a.documentElement)&&(i=i.namespaceURI)?ly(i):0;break;default:if(i=a.tagName,a=a.namespaceURI)a=ly(a),i=cy(a,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}J(q),N(q,i)}function Ut(){J(q),J(K),J(Q)}function Ye(i){i.memoizedState!==null&&N(Z,i);var a=q.current,l=cy(a,i.type);a!==l&&(N(K,i),N(q,l))}function De(i){K.current===i&&(J(q),J(K)),Z.current===i&&(J(Z),Jr._currentValue=it)}var rs=Object.prototype.hasOwnProperty,qs=r.unstable_scheduleCallback,rr=r.unstable_cancelCallback,yA=r.unstable_shouldYield,bA=r.unstable_requestPaint,Bn=r.unstable_now,vA=r.unstable_getCurrentPriorityLevel,jp=r.unstable_ImmediatePriority,Gp=r.unstable_UserBlockingPriority,Ko=r.unstable_NormalPriority,AA=r.unstable_LowPriority,qp=r.unstable_IdlePriority,SA=r.log,EA=r.unstable_setDisableYieldValue,or=null,sn=null;function wi(i){if(typeof SA=="function"&&EA(i),sn&&typeof sn.setStrictMode=="function")try{sn.setStrictMode(or,i)}catch{}}var an=Math.clz32?Math.clz32:TA,wA=Math.log,CA=Math.LN2;function TA(i){return i>>>=0,i===0?32:31-(wA(i)/CA|0)|0}var Qo=256,Zo=4194304;function os(i){var a=i&42;if(a!==0)return a;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Jo(i,a,l){var u=i.pendingLanes;if(u===0)return 0;var p=0,m=i.suspendedLanes,v=i.pingedLanes;i=i.warmLanes;var E=u&134217727;return E!==0?(u=E&~m,u!==0?p=os(u):(v&=E,v!==0?p=os(v):l||(l=E&~i,l!==0&&(p=os(l))))):(E=u&~m,E!==0?p=os(E):v!==0?p=os(v):l||(l=u&~i,l!==0&&(p=os(l)))),p===0?0:a!==0&&a!==p&&(a&m)===0&&(m=p&-p,l=a&-a,m>=l||m===32&&(l&4194048)!==0)?a:p}function lr(i,a){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&a)===0}function xA(i,a){switch(i){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Vp(){var i=Qo;return Qo<<=1,(Qo&4194048)===0&&(Qo=256),i}function Yp(){var i=Zo;return Zo<<=1,(Zo&62914560)===0&&(Zo=4194304),i}function yu(i){for(var a=[],l=0;31>l;l++)a.push(i);return a}function cr(i,a){i.pendingLanes|=a,a!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function RA(i,a,l,u,p,m){var v=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var E=i.entanglements,T=i.expirationTimes,F=i.hiddenUpdates;for(l=v&~l;0<l;){var V=31-an(l),W=1<<V;E[V]=0,T[V]=-1;var H=F[V];if(H!==null)for(F[V]=null,V=0;V<H.length;V++){var z=H[V];z!==null&&(z.lane&=-536870913)}l&=~W}u!==0&&Xp(i,u,0),m!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=m&~(v&~a))}function Xp(i,a,l){i.pendingLanes|=a,i.suspendedLanes&=~a;var u=31-an(a);i.entangledLanes|=a,i.entanglements[u]=i.entanglements[u]|1073741824|l&4194090}function $p(i,a){var l=i.entangledLanes|=a;for(i=i.entanglements;l;){var u=31-an(l),p=1<<u;p&a|i[u]&a&&(i[u]|=a),l&=~p}}function bu(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function vu(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Wp(){var i=U.p;return i!==0?i:(i=window.event,i===void 0?32:Ry(i.type))}function DA(i,a){var l=U.p;try{return U.p=i,a()}finally{U.p=l}}var Ci=Math.random().toString(36).slice(2),Be="__reactFiber$"+Ci,Xe="__reactProps$"+Ci,Vs="__reactContainer$"+Ci,Au="__reactEvents$"+Ci,MA="__reactListeners$"+Ci,NA="__reactHandles$"+Ci,Kp="__reactResources$"+Ci,ur="__reactMarker$"+Ci;function Su(i){delete i[Be],delete i[Xe],delete i[Au],delete i[MA],delete i[NA]}function Ys(i){var a=i[Be];if(a)return a;for(var l=i.parentNode;l;){if(a=l[Vs]||l[Be]){if(l=a.alternate,a.child!==null||l!==null&&l.child!==null)for(i=fy(i);i!==null;){if(l=i[Be])return l;i=fy(i)}return a}i=l,l=i.parentNode}return null}function Xs(i){if(i=i[Be]||i[Vs]){var a=i.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return i}return null}function hr(i){var a=i.tag;if(a===5||a===26||a===27||a===6)return i.stateNode;throw Error(n(33))}function $s(i){var a=i[Kp];return a||(a=i[Kp]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function be(i){i[ur]=!0}var Qp=new Set,Zp={};function ls(i,a){Ws(i,a),Ws(i+"Capture",a)}function Ws(i,a){for(Zp[i]=a,i=0;i<a.length;i++)Qp.add(a[i])}var OA=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Jp={},tg={};function kA(i){return rs.call(tg,i)?!0:rs.call(Jp,i)?!1:OA.test(i)?tg[i]=!0:(Jp[i]=!0,!1)}function tl(i,a,l){if(kA(a))if(l===null)i.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(a);return;case"boolean":var u=a.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){i.removeAttribute(a);return}}i.setAttribute(a,""+l)}}function el(i,a,l){if(l===null)i.removeAttribute(a);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(a);return}i.setAttribute(a,""+l)}}function ni(i,a,l,u){if(u===null)i.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(a,l,""+u)}}var Eu,eg;function Ks(i){if(Eu===void 0)try{throw Error()}catch(l){var a=l.stack.trim().match(/\n( *(at )?)/);Eu=a&&a[1]||"",eg=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Eu+i+eg}var wu=!1;function Cu(i,a){if(!i||wu)return"";wu=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(a){var W=function(){throw Error()};if(Object.defineProperty(W.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(W,[])}catch(z){var H=z}Reflect.construct(i,[],W)}else{try{W.call()}catch(z){H=z}i.call(W.prototype)}}else{try{throw Error()}catch(z){H=z}(W=i())&&typeof W.catch=="function"&&W.catch(function(){})}}catch(z){if(z&&H&&typeof z.stack=="string")return[z.stack,H.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=u.DetermineComponentFrameRoot(),v=m[0],E=m[1];if(v&&E){var T=v.split(`
`),F=E.split(`
`);for(p=u=0;u<T.length&&!T[u].includes("DetermineComponentFrameRoot");)u++;for(;p<F.length&&!F[p].includes("DetermineComponentFrameRoot");)p++;if(u===T.length||p===F.length)for(u=T.length-1,p=F.length-1;1<=u&&0<=p&&T[u]!==F[p];)p--;for(;1<=u&&0<=p;u--,p--)if(T[u]!==F[p]){if(u!==1||p!==1)do if(u--,p--,0>p||T[u]!==F[p]){var V=`
`+T[u].replace(" at new "," at ");return i.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",i.displayName)),V}while(1<=u&&0<=p);break}}}finally{wu=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?Ks(l):""}function LA(i){switch(i.tag){case 26:case 27:case 5:return Ks(i.type);case 16:return Ks("Lazy");case 13:return Ks("Suspense");case 19:return Ks("SuspenseList");case 0:case 15:return Cu(i.type,!1);case 11:return Cu(i.type.render,!1);case 1:return Cu(i.type,!0);case 31:return Ks("Activity");default:return""}}function ng(i){try{var a="";do a+=LA(i),i=i.return;while(i);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function gn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ig(i){var a=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function IA(i){var a=ig(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,a),u=""+i[a];if(!i.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var p=l.get,m=l.set;return Object.defineProperty(i,a,{configurable:!0,get:function(){return p.call(this)},set:function(v){u=""+v,m.call(this,v)}}),Object.defineProperty(i,a,{enumerable:l.enumerable}),{getValue:function(){return u},setValue:function(v){u=""+v},stopTracking:function(){i._valueTracker=null,delete i[a]}}}}function nl(i){i._valueTracker||(i._valueTracker=IA(i))}function sg(i){if(!i)return!1;var a=i._valueTracker;if(!a)return!0;var l=a.getValue(),u="";return i&&(u=ig(i)?i.checked?"true":"false":i.value),i=u,i!==l?(a.setValue(i),!0):!1}function il(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var PA=/[\n"\\]/g;function mn(i){return i.replace(PA,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function Tu(i,a,l,u,p,m,v,E){i.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?i.type=v:i.removeAttribute("type"),a!=null?v==="number"?(a===0&&i.value===""||i.value!=a)&&(i.value=""+gn(a)):i.value!==""+gn(a)&&(i.value=""+gn(a)):v!=="submit"&&v!=="reset"||i.removeAttribute("value"),a!=null?xu(i,v,gn(a)):l!=null?xu(i,v,gn(l)):u!=null&&i.removeAttribute("value"),p==null&&m!=null&&(i.defaultChecked=!!m),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?i.name=""+gn(E):i.removeAttribute("name")}function ag(i,a,l,u,p,m,v,E){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(i.type=m),a!=null||l!=null){if(!(m!=="submit"&&m!=="reset"||a!=null))return;l=l!=null?""+gn(l):"",a=a!=null?""+gn(a):l,E||a===i.value||(i.value=a),i.defaultValue=a}u=u??p,u=typeof u!="function"&&typeof u!="symbol"&&!!u,i.checked=E?i.checked:!!u,i.defaultChecked=!!u,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.name=v)}function xu(i,a,l){a==="number"&&il(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function Qs(i,a,l,u){if(i=i.options,a){a={};for(var p=0;p<l.length;p++)a["$"+l[p]]=!0;for(l=0;l<i.length;l++)p=a.hasOwnProperty("$"+i[l].value),i[l].selected!==p&&(i[l].selected=p),p&&u&&(i[l].defaultSelected=!0)}else{for(l=""+gn(l),a=null,p=0;p<i.length;p++){if(i[p].value===l){i[p].selected=!0,u&&(i[p].defaultSelected=!0);return}a!==null||i[p].disabled||(a=i[p])}a!==null&&(a.selected=!0)}}function rg(i,a,l){if(a!=null&&(a=""+gn(a),a!==i.value&&(i.value=a),l==null)){i.defaultValue!==a&&(i.defaultValue=a);return}i.defaultValue=l!=null?""+gn(l):""}function og(i,a,l,u){if(a==null){if(u!=null){if(l!=null)throw Error(n(92));if(St(u)){if(1<u.length)throw Error(n(93));u=u[0]}l=u}l==null&&(l=""),a=l}l=gn(a),i.defaultValue=l,u=i.textContent,u===l&&u!==""&&u!==null&&(i.value=u)}function Zs(i,a){if(a){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=a;return}}i.textContent=a}var BA=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lg(i,a,l){var u=a.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?i.setProperty(a,""):a==="float"?i.cssFloat="":i[a]="":u?i.setProperty(a,l):typeof l!="number"||l===0||BA.has(a)?a==="float"?i.cssFloat=l:i[a]=(""+l).trim():i[a]=l+"px"}function cg(i,a,l){if(a!=null&&typeof a!="object")throw Error(n(62));if(i=i.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||a!=null&&a.hasOwnProperty(u)||(u.indexOf("--")===0?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="");for(var p in a)u=a[p],a.hasOwnProperty(p)&&l[p]!==u&&lg(i,p,u)}else for(var m in a)a.hasOwnProperty(m)&&lg(i,m,a[m])}function Ru(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var FA=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),HA=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function sl(i){return HA.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Du=null;function Mu(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Js=null,ta=null;function ug(i){var a=Xs(i);if(a&&(i=a.stateNode)){var l=i[Xe]||null;t:switch(i=a.stateNode,a.type){case"input":if(Tu(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),a=l.name,l.type==="radio"&&a!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+mn(""+a)+'"][type="radio"]'),a=0;a<l.length;a++){var u=l[a];if(u!==i&&u.form===i.form){var p=u[Xe]||null;if(!p)throw Error(n(90));Tu(u,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(a=0;a<l.length;a++)u=l[a],u.form===i.form&&sg(u)}break t;case"textarea":rg(i,l.value,l.defaultValue);break t;case"select":a=l.value,a!=null&&Qs(i,!!l.multiple,a,!1)}}}var Nu=!1;function hg(i,a,l){if(Nu)return i(a,l);Nu=!0;try{var u=i(a);return u}finally{if(Nu=!1,(Js!==null||ta!==null)&&(Gl(),Js&&(a=Js,i=ta,ta=Js=null,ug(a),i)))for(a=0;a<i.length;a++)ug(i[a])}}function dr(i,a){var l=i.stateNode;if(l===null)return null;var u=l[Xe]||null;if(u===null)return null;l=u[a];t:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(i=i.type,u=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!u;break t;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(n(231,a,typeof l));return l}var ii=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ou=!1;if(ii)try{var fr={};Object.defineProperty(fr,"passive",{get:function(){Ou=!0}}),window.addEventListener("test",fr,fr),window.removeEventListener("test",fr,fr)}catch{Ou=!1}var Ti=null,ku=null,al=null;function dg(){if(al)return al;var i,a=ku,l=a.length,u,p="value"in Ti?Ti.value:Ti.textContent,m=p.length;for(i=0;i<l&&a[i]===p[i];i++);var v=l-i;for(u=1;u<=v&&a[l-u]===p[m-u];u++);return al=p.slice(i,1<u?1-u:void 0)}function rl(i){var a=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&a===13&&(i=13)):i=a,i===10&&(i=13),32<=i||i===13?i:0}function ol(){return!0}function fg(){return!1}function $e(i){function a(l,u,p,m,v){this._reactName=l,this._targetInst=p,this.type=u,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var E in i)i.hasOwnProperty(E)&&(l=i[E],this[E]=l?l(m):m[E]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?ol:fg,this.isPropagationStopped=fg,this}return g(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ol)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ol)},persist:function(){},isPersistent:ol}),a}var cs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ll=$e(cs),pr=g({},cs,{view:0,detail:0}),zA=$e(pr),Lu,Iu,gr,cl=g({},pr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bu,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==gr&&(gr&&i.type==="mousemove"?(Lu=i.screenX-gr.screenX,Iu=i.screenY-gr.screenY):Iu=Lu=0,gr=i),Lu)},movementY:function(i){return"movementY"in i?i.movementY:Iu}}),pg=$e(cl),UA=g({},cl,{dataTransfer:0}),jA=$e(UA),GA=g({},pr,{relatedTarget:0}),Pu=$e(GA),qA=g({},cs,{animationName:0,elapsedTime:0,pseudoElement:0}),VA=$e(qA),YA=g({},cs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),XA=$e(YA),$A=g({},cs,{data:0}),gg=$e($A),WA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},KA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},QA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ZA(i){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(i):(i=QA[i])?!!a[i]:!1}function Bu(){return ZA}var JA=g({},pr,{key:function(i){if(i.key){var a=WA[i.key]||i.key;if(a!=="Unidentified")return a}return i.type==="keypress"?(i=rl(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?KA[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bu,charCode:function(i){return i.type==="keypress"?rl(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?rl(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),tS=$e(JA),eS=g({},cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mg=$e(eS),nS=g({},pr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bu}),iS=$e(nS),sS=g({},cs,{propertyName:0,elapsedTime:0,pseudoElement:0}),aS=$e(sS),rS=g({},cl,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),oS=$e(rS),lS=g({},cs,{newState:0,oldState:0}),cS=$e(lS),uS=[9,13,27,32],Fu=ii&&"CompositionEvent"in window,mr=null;ii&&"documentMode"in document&&(mr=document.documentMode);var hS=ii&&"TextEvent"in window&&!mr,_g=ii&&(!Fu||mr&&8<mr&&11>=mr),yg=" ",bg=!1;function vg(i,a){switch(i){case"keyup":return uS.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ag(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ea=!1;function dS(i,a){switch(i){case"compositionend":return Ag(a);case"keypress":return a.which!==32?null:(bg=!0,yg);case"textInput":return i=a.data,i===yg&&bg?null:i;default:return null}}function fS(i,a){if(ea)return i==="compositionend"||!Fu&&vg(i,a)?(i=dg(),al=ku=Ti=null,ea=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return _g&&a.locale!=="ko"?null:a.data;default:return null}}var pS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Sg(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a==="input"?!!pS[i.type]:a==="textarea"}function Eg(i,a,l,u){Js?ta?ta.push(u):ta=[u]:Js=u,a=Wl(a,"onChange"),0<a.length&&(l=new ll("onChange","change",null,l,u),i.push({event:l,listeners:a}))}var _r=null,yr=null;function gS(i){iy(i,0)}function ul(i){var a=hr(i);if(sg(a))return i}function wg(i,a){if(i==="change")return a}var Cg=!1;if(ii){var Hu;if(ii){var zu="oninput"in document;if(!zu){var Tg=document.createElement("div");Tg.setAttribute("oninput","return;"),zu=typeof Tg.oninput=="function"}Hu=zu}else Hu=!1;Cg=Hu&&(!document.documentMode||9<document.documentMode)}function xg(){_r&&(_r.detachEvent("onpropertychange",Rg),yr=_r=null)}function Rg(i){if(i.propertyName==="value"&&ul(yr)){var a=[];Eg(a,yr,i,Mu(i)),hg(gS,a)}}function mS(i,a,l){i==="focusin"?(xg(),_r=a,yr=l,_r.attachEvent("onpropertychange",Rg)):i==="focusout"&&xg()}function _S(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ul(yr)}function yS(i,a){if(i==="click")return ul(a)}function bS(i,a){if(i==="input"||i==="change")return ul(a)}function vS(i,a){return i===a&&(i!==0||1/i===1/a)||i!==i&&a!==a}var rn=typeof Object.is=="function"?Object.is:vS;function br(i,a){if(rn(i,a))return!0;if(typeof i!="object"||i===null||typeof a!="object"||a===null)return!1;var l=Object.keys(i),u=Object.keys(a);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var p=l[u];if(!rs.call(a,p)||!rn(i[p],a[p]))return!1}return!0}function Dg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Mg(i,a){var l=Dg(i);i=0;for(var u;l;){if(l.nodeType===3){if(u=i+l.textContent.length,i<=a&&u>=a)return{node:l,offset:a-i};i=u}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=Dg(l)}}function Ng(i,a){return i&&a?i===a?!0:i&&i.nodeType===3?!1:a&&a.nodeType===3?Ng(i,a.parentNode):"contains"in i?i.contains(a):i.compareDocumentPosition?!!(i.compareDocumentPosition(a)&16):!1:!1}function Og(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var a=il(i.document);a instanceof i.HTMLIFrameElement;){try{var l=typeof a.contentWindow.location.href=="string"}catch{l=!1}if(l)i=a.contentWindow;else break;a=il(i.document)}return a}function Uu(i){var a=i&&i.nodeName&&i.nodeName.toLowerCase();return a&&(a==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||a==="textarea"||i.contentEditable==="true")}var AS=ii&&"documentMode"in document&&11>=document.documentMode,na=null,ju=null,vr=null,Gu=!1;function kg(i,a,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Gu||na==null||na!==il(u)||(u=na,"selectionStart"in u&&Uu(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),vr&&br(vr,u)||(vr=u,u=Wl(ju,"onSelect"),0<u.length&&(a=new ll("onSelect","select",null,a,l),i.push({event:a,listeners:u}),a.target=na)))}function us(i,a){var l={};return l[i.toLowerCase()]=a.toLowerCase(),l["Webkit"+i]="webkit"+a,l["Moz"+i]="moz"+a,l}var ia={animationend:us("Animation","AnimationEnd"),animationiteration:us("Animation","AnimationIteration"),animationstart:us("Animation","AnimationStart"),transitionrun:us("Transition","TransitionRun"),transitionstart:us("Transition","TransitionStart"),transitioncancel:us("Transition","TransitionCancel"),transitionend:us("Transition","TransitionEnd")},qu={},Lg={};ii&&(Lg=document.createElement("div").style,"AnimationEvent"in window||(delete ia.animationend.animation,delete ia.animationiteration.animation,delete ia.animationstart.animation),"TransitionEvent"in window||delete ia.transitionend.transition);function hs(i){if(qu[i])return qu[i];if(!ia[i])return i;var a=ia[i],l;for(l in a)if(a.hasOwnProperty(l)&&l in Lg)return qu[i]=a[l];return i}var Ig=hs("animationend"),Pg=hs("animationiteration"),Bg=hs("animationstart"),SS=hs("transitionrun"),ES=hs("transitionstart"),wS=hs("transitioncancel"),Fg=hs("transitionend"),Hg=new Map,Vu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Vu.push("scrollEnd");function Dn(i,a){Hg.set(i,a),ls(a,[i])}var zg=new WeakMap;function _n(i,a){if(typeof i=="object"&&i!==null){var l=zg.get(i);return l!==void 0?l:(a={value:i,source:a,stack:ng(a)},zg.set(i,a),a)}return{value:i,source:a,stack:ng(a)}}var yn=[],sa=0,Yu=0;function hl(){for(var i=sa,a=Yu=sa=0;a<i;){var l=yn[a];yn[a++]=null;var u=yn[a];yn[a++]=null;var p=yn[a];yn[a++]=null;var m=yn[a];if(yn[a++]=null,u!==null&&p!==null){var v=u.pending;v===null?p.next=p:(p.next=v.next,v.next=p),u.pending=p}m!==0&&Ug(l,p,m)}}function dl(i,a,l,u){yn[sa++]=i,yn[sa++]=a,yn[sa++]=l,yn[sa++]=u,Yu|=u,i.lanes|=u,i=i.alternate,i!==null&&(i.lanes|=u)}function Xu(i,a,l,u){return dl(i,a,l,u),fl(i)}function aa(i,a){return dl(i,null,null,a),fl(i)}function Ug(i,a,l){i.lanes|=l;var u=i.alternate;u!==null&&(u.lanes|=l);for(var p=!1,m=i.return;m!==null;)m.childLanes|=l,u=m.alternate,u!==null&&(u.childLanes|=l),m.tag===22&&(i=m.stateNode,i===null||i._visibility&1||(p=!0)),i=m,m=m.return;return i.tag===3?(m=i.stateNode,p&&a!==null&&(p=31-an(l),i=m.hiddenUpdates,u=i[p],u===null?i[p]=[a]:u.push(a),a.lane=l|536870912),m):null}function fl(i){if(50<Vr)throw Vr=0,Jh=null,Error(n(185));for(var a=i.return;a!==null;)i=a,a=i.return;return i.tag===3?i.stateNode:null}var ra={};function CS(i,a,l,u){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(i,a,l,u){return new CS(i,a,l,u)}function $u(i){return i=i.prototype,!(!i||!i.isReactComponent)}function si(i,a){var l=i.alternate;return l===null?(l=on(i.tag,a,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=a,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,a=i.dependencies,l.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function jg(i,a){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=a,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,a=l.dependencies,i.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),i}function pl(i,a,l,u,p,m){var v=0;if(u=i,typeof i=="function")$u(i)&&(v=1);else if(typeof i=="string")v=xE(i,l,q.current)?26:i==="html"||i==="head"||i==="body"?27:5;else t:switch(i){case j:return i=on(31,l,a,p),i.elementType=j,i.lanes=m,i;case A:return ds(l.children,p,m,a);case S:v=8,p|=24;break;case w:return i=on(12,l,a,p|2),i.elementType=w,i.lanes=m,i;case O:return i=on(13,l,a,p),i.elementType=O,i.lanes=m,i;case P:return i=on(19,l,a,p),i.elementType=P,i.lanes=m,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case C:case x:v=10;break t;case D:v=9;break t;case I:v=11;break t;case G:v=14;break t;case Y:v=16,u=null;break t}v=29,l=Error(n(130,i===null?"null":typeof i,"")),u=null}return a=on(v,l,a,p),a.elementType=i,a.type=u,a.lanes=m,a}function ds(i,a,l,u){return i=on(7,i,u,a),i.lanes=l,i}function Wu(i,a,l){return i=on(6,i,null,a),i.lanes=l,i}function Ku(i,a,l){return a=on(4,i.children!==null?i.children:[],i.key,a),a.lanes=l,a.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},a}var oa=[],la=0,gl=null,ml=0,bn=[],vn=0,fs=null,ai=1,ri="";function ps(i,a){oa[la++]=ml,oa[la++]=gl,gl=i,ml=a}function Gg(i,a,l){bn[vn++]=ai,bn[vn++]=ri,bn[vn++]=fs,fs=i;var u=ai;i=ri;var p=32-an(u)-1;u&=~(1<<p),l+=1;var m=32-an(a)+p;if(30<m){var v=p-p%5;m=(u&(1<<v)-1).toString(32),u>>=v,p-=v,ai=1<<32-an(a)+p|l<<p|u,ri=m+i}else ai=1<<m|l<<p|u,ri=i}function Qu(i){i.return!==null&&(ps(i,1),Gg(i,1,0))}function Zu(i){for(;i===gl;)gl=oa[--la],oa[la]=null,ml=oa[--la],oa[la]=null;for(;i===fs;)fs=bn[--vn],bn[vn]=null,ri=bn[--vn],bn[vn]=null,ai=bn[--vn],bn[vn]=null}var ze=null,se=null,Pt=!1,gs=null,Fn=!1,Ju=Error(n(519));function ms(i){var a=Error(n(418,""));throw Er(_n(a,i)),Ju}function qg(i){var a=i.stateNode,l=i.type,u=i.memoizedProps;switch(a[Be]=i,a[Xe]=u,l){case"dialog":Ot("cancel",a),Ot("close",a);break;case"iframe":case"object":case"embed":Ot("load",a);break;case"video":case"audio":for(l=0;l<Xr.length;l++)Ot(Xr[l],a);break;case"source":Ot("error",a);break;case"img":case"image":case"link":Ot("error",a),Ot("load",a);break;case"details":Ot("toggle",a);break;case"input":Ot("invalid",a),ag(a,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),nl(a);break;case"select":Ot("invalid",a);break;case"textarea":Ot("invalid",a),og(a,u.value,u.defaultValue,u.children),nl(a)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||a.textContent===""+l||u.suppressHydrationWarning===!0||oy(a.textContent,l)?(u.popover!=null&&(Ot("beforetoggle",a),Ot("toggle",a)),u.onScroll!=null&&Ot("scroll",a),u.onScrollEnd!=null&&Ot("scrollend",a),u.onClick!=null&&(a.onclick=Kl),a=!0):a=!1,a||ms(i)}function Vg(i){for(ze=i.return;ze;)switch(ze.tag){case 5:case 13:Fn=!1;return;case 27:case 3:Fn=!0;return;default:ze=ze.return}}function Ar(i){if(i!==ze)return!1;if(!Pt)return Vg(i),Pt=!0,!1;var a=i.tag,l;if((l=a!==3&&a!==27)&&((l=a===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||gd(i.type,i.memoizedProps)),l=!l),l&&se&&ms(i),Vg(i),a===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));t:{for(i=i.nextSibling,a=0;i;){if(i.nodeType===8)if(l=i.data,l==="/$"){if(a===0){se=Nn(i.nextSibling);break t}a--}else l!=="$"&&l!=="$!"&&l!=="$?"||a++;i=i.nextSibling}se=null}}else a===27?(a=se,ji(i.type)?(i=bd,bd=null,se=i):se=a):se=ze?Nn(i.stateNode.nextSibling):null;return!0}function Sr(){se=ze=null,Pt=!1}function Yg(){var i=gs;return i!==null&&(Qe===null?Qe=i:Qe.push.apply(Qe,i),gs=null),i}function Er(i){gs===null?gs=[i]:gs.push(i)}var th=$(null),_s=null,oi=null;function xi(i,a,l){N(th,a._currentValue),a._currentValue=l}function li(i){i._currentValue=th.current,J(th)}function eh(i,a,l){for(;i!==null;){var u=i.alternate;if((i.childLanes&a)!==a?(i.childLanes|=a,u!==null&&(u.childLanes|=a)):u!==null&&(u.childLanes&a)!==a&&(u.childLanes|=a),i===l)break;i=i.return}}function nh(i,a,l,u){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var m=p.dependencies;if(m!==null){var v=p.child;m=m.firstContext;t:for(;m!==null;){var E=m;m=p;for(var T=0;T<a.length;T++)if(E.context===a[T]){m.lanes|=l,E=m.alternate,E!==null&&(E.lanes|=l),eh(m.return,l,i),u||(v=null);break t}m=E.next}}else if(p.tag===18){if(v=p.return,v===null)throw Error(n(341));v.lanes|=l,m=v.alternate,m!==null&&(m.lanes|=l),eh(v,l,i),v=null}else v=p.child;if(v!==null)v.return=p;else for(v=p;v!==null;){if(v===i){v=null;break}if(p=v.sibling,p!==null){p.return=v.return,v=p;break}v=v.return}p=v}}function wr(i,a,l,u){i=null;for(var p=a,m=!1;p!==null;){if(!m){if((p.flags&524288)!==0)m=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var v=p.alternate;if(v===null)throw Error(n(387));if(v=v.memoizedProps,v!==null){var E=p.type;rn(p.pendingProps.value,v.value)||(i!==null?i.push(E):i=[E])}}else if(p===Z.current){if(v=p.alternate,v===null)throw Error(n(387));v.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(Jr):i=[Jr])}p=p.return}i!==null&&nh(a,i,l,u),a.flags|=262144}function _l(i){for(i=i.firstContext;i!==null;){if(!rn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ys(i){_s=i,oi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Fe(i){return Xg(_s,i)}function yl(i,a){return _s===null&&ys(i),Xg(i,a)}function Xg(i,a){var l=a._currentValue;if(a={context:a,memoizedValue:l,next:null},oi===null){if(i===null)throw Error(n(308));oi=a,i.dependencies={lanes:0,firstContext:a},i.flags|=524288}else oi=oi.next=a;return l}var TS=typeof AbortController<"u"?AbortController:function(){var i=[],a=this.signal={aborted:!1,addEventListener:function(l,u){i.push(u)}};this.abort=function(){a.aborted=!0,i.forEach(function(l){return l()})}},xS=r.unstable_scheduleCallback,RS=r.unstable_NormalPriority,_e={$$typeof:x,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ih(){return{controller:new TS,data:new Map,refCount:0}}function Cr(i){i.refCount--,i.refCount===0&&xS(RS,function(){i.controller.abort()})}var Tr=null,sh=0,ca=0,ua=null;function DS(i,a){if(Tr===null){var l=Tr=[];sh=0,ca=rd(),ua={status:"pending",value:void 0,then:function(u){l.push(u)}}}return sh++,a.then($g,$g),a}function $g(){if(--sh===0&&Tr!==null){ua!==null&&(ua.status="fulfilled");var i=Tr;Tr=null,ca=0,ua=null;for(var a=0;a<i.length;a++)(0,i[a])()}}function MS(i,a){var l=[],u={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return i.then(function(){u.status="fulfilled",u.value=a;for(var p=0;p<l.length;p++)(0,l[p])(a)},function(p){for(u.status="rejected",u.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),u}var Wg=k.S;k.S=function(i,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&DS(i,a),Wg!==null&&Wg(i,a)};var bs=$(null);function ah(){var i=bs.current;return i!==null?i:$t.pooledCache}function bl(i,a){a===null?N(bs,bs.current):N(bs,a.pool)}function Kg(){var i=ah();return i===null?null:{parent:_e._currentValue,pool:i}}var xr=Error(n(460)),Qg=Error(n(474)),vl=Error(n(542)),rh={then:function(){}};function Zg(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Al(){}function Jg(i,a,l){switch(l=i[l],l===void 0?i.push(a):l!==a&&(a.then(Al,Al),a=l),a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,em(i),i;default:if(typeof a.status=="string")a.then(Al,Al);else{if(i=$t,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=a,i.status="pending",i.then(function(u){if(a.status==="pending"){var p=a;p.status="fulfilled",p.value=u}},function(u){if(a.status==="pending"){var p=a;p.status="rejected",p.reason=u}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw i=a.reason,em(i),i}throw Rr=a,xr}}var Rr=null;function tm(){if(Rr===null)throw Error(n(459));var i=Rr;return Rr=null,i}function em(i){if(i===xr||i===vl)throw Error(n(483))}var Ri=!1;function oh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lh(i,a){i=i.updateQueue,a.updateQueue===i&&(a.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Di(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Mi(i,a,l){var u=i.updateQueue;if(u===null)return null;if(u=u.shared,(Ft&2)!==0){var p=u.pending;return p===null?a.next=a:(a.next=p.next,p.next=a),u.pending=a,a=fl(i),Ug(i,null,l),a}return dl(i,u,a,l),fl(i)}function Dr(i,a,l){if(a=a.updateQueue,a!==null&&(a=a.shared,(l&4194048)!==0)){var u=a.lanes;u&=i.pendingLanes,l|=u,a.lanes=l,$p(i,l)}}function ch(i,a){var l=i.updateQueue,u=i.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var p=null,m=null;if(l=l.firstBaseUpdate,l!==null){do{var v={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};m===null?p=m=v:m=m.next=v,l=l.next}while(l!==null);m===null?p=m=a:m=m.next=a}else p=m=a;l={baseState:u.baseState,firstBaseUpdate:p,lastBaseUpdate:m,shared:u.shared,callbacks:u.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=a:i.next=a,l.lastBaseUpdate=a}var uh=!1;function Mr(){if(uh){var i=ua;if(i!==null)throw i}}function Nr(i,a,l,u){uh=!1;var p=i.updateQueue;Ri=!1;var m=p.firstBaseUpdate,v=p.lastBaseUpdate,E=p.shared.pending;if(E!==null){p.shared.pending=null;var T=E,F=T.next;T.next=null,v===null?m=F:v.next=F,v=T;var V=i.alternate;V!==null&&(V=V.updateQueue,E=V.lastBaseUpdate,E!==v&&(E===null?V.firstBaseUpdate=F:E.next=F,V.lastBaseUpdate=T))}if(m!==null){var W=p.baseState;v=0,V=F=T=null,E=m;do{var H=E.lane&-536870913,z=H!==E.lane;if(z?(Lt&H)===H:(u&H)===H){H!==0&&H===ca&&(uh=!0),V!==null&&(V=V.next={lane:0,tag:E.tag,payload:E.payload,callback:null,next:null});t:{var _t=i,ft=E;H=a;var qt=l;switch(ft.tag){case 1:if(_t=ft.payload,typeof _t=="function"){W=_t.call(qt,W,H);break t}W=_t;break t;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=ft.payload,H=typeof _t=="function"?_t.call(qt,W,H):_t,H==null)break t;W=g({},W,H);break t;case 2:Ri=!0}}H=E.callback,H!==null&&(i.flags|=64,z&&(i.flags|=8192),z=p.callbacks,z===null?p.callbacks=[H]:z.push(H))}else z={lane:H,tag:E.tag,payload:E.payload,callback:E.callback,next:null},V===null?(F=V=z,T=W):V=V.next=z,v|=H;if(E=E.next,E===null){if(E=p.shared.pending,E===null)break;z=E,E=z.next,z.next=null,p.lastBaseUpdate=z,p.shared.pending=null}}while(!0);V===null&&(T=W),p.baseState=T,p.firstBaseUpdate=F,p.lastBaseUpdate=V,m===null&&(p.shared.lanes=0),Fi|=v,i.lanes=v,i.memoizedState=W}}function nm(i,a){if(typeof i!="function")throw Error(n(191,i));i.call(a)}function im(i,a){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)nm(l[i],a)}var ha=$(null),Sl=$(0);function sm(i,a){i=gi,N(Sl,i),N(ha,a),gi=i|a.baseLanes}function hh(){N(Sl,gi),N(ha,ha.current)}function dh(){gi=Sl.current,J(ha),J(Sl)}var Ni=0,Ct=null,jt=null,he=null,El=!1,da=!1,vs=!1,wl=0,Or=0,fa=null,NS=0;function re(){throw Error(n(321))}function fh(i,a){if(a===null)return!1;for(var l=0;l<a.length&&l<i.length;l++)if(!rn(i[l],a[l]))return!1;return!0}function ph(i,a,l,u,p,m){return Ni=m,Ct=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,k.H=i===null||i.memoizedState===null?Um:jm,vs=!1,m=l(u,p),vs=!1,da&&(m=rm(a,l,u,p)),am(i),m}function am(i){k.H=Ml;var a=jt!==null&&jt.next!==null;if(Ni=0,he=jt=Ct=null,El=!1,Or=0,fa=null,a)throw Error(n(300));i===null||ve||(i=i.dependencies,i!==null&&_l(i)&&(ve=!0))}function rm(i,a,l,u){Ct=i;var p=0;do{if(da&&(fa=null),Or=0,da=!1,25<=p)throw Error(n(301));if(p+=1,he=jt=null,i.updateQueue!=null){var m=i.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}k.H=FS,m=a(l,u)}while(da);return m}function OS(){var i=k.H,a=i.useState()[0];return a=typeof a.then=="function"?kr(a):a,i=i.useState()[0],(jt!==null?jt.memoizedState:null)!==i&&(Ct.flags|=1024),a}function gh(){var i=wl!==0;return wl=0,i}function mh(i,a,l){a.updateQueue=i.updateQueue,a.flags&=-2053,i.lanes&=~l}function _h(i){if(El){for(i=i.memoizedState;i!==null;){var a=i.queue;a!==null&&(a.pending=null),i=i.next}El=!1}Ni=0,he=jt=Ct=null,da=!1,Or=wl=0,fa=null}function We(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return he===null?Ct.memoizedState=he=i:he=he.next=i,he}function de(){if(jt===null){var i=Ct.alternate;i=i!==null?i.memoizedState:null}else i=jt.next;var a=he===null?Ct.memoizedState:he.next;if(a!==null)he=a,jt=i;else{if(i===null)throw Ct.alternate===null?Error(n(467)):Error(n(310));jt=i,i={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},he===null?Ct.memoizedState=he=i:he=he.next=i}return he}function yh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function kr(i){var a=Or;return Or+=1,fa===null&&(fa=[]),i=Jg(fa,i,a),a=Ct,(he===null?a.memoizedState:he.next)===null&&(a=a.alternate,k.H=a===null||a.memoizedState===null?Um:jm),i}function Cl(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return kr(i);if(i.$$typeof===x)return Fe(i)}throw Error(n(438,String(i)))}function bh(i){var a=null,l=Ct.updateQueue;if(l!==null&&(a=l.memoCache),a==null){var u=Ct.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(a={data:u.data.map(function(p){return p.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),l===null&&(l=yh(),Ct.updateQueue=l),l.memoCache=a,l=a.data[a.index],l===void 0)for(l=a.data[a.index]=Array(i),u=0;u<i;u++)l[u]=at;return a.index++,l}function ci(i,a){return typeof a=="function"?a(i):a}function Tl(i){var a=de();return vh(a,jt,i)}function vh(i,a,l){var u=i.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=l;var p=i.baseQueue,m=u.pending;if(m!==null){if(p!==null){var v=p.next;p.next=m.next,m.next=v}a.baseQueue=p=m,u.pending=null}if(m=i.baseState,p===null)i.memoizedState=m;else{a=p.next;var E=v=null,T=null,F=a,V=!1;do{var W=F.lane&-536870913;if(W!==F.lane?(Lt&W)===W:(Ni&W)===W){var H=F.revertLane;if(H===0)T!==null&&(T=T.next={lane:0,revertLane:0,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null}),W===ca&&(V=!0);else if((Ni&H)===H){F=F.next,H===ca&&(V=!0);continue}else W={lane:0,revertLane:F.revertLane,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},T===null?(E=T=W,v=m):T=T.next=W,Ct.lanes|=H,Fi|=H;W=F.action,vs&&l(m,W),m=F.hasEagerState?F.eagerState:l(m,W)}else H={lane:W,revertLane:F.revertLane,action:F.action,hasEagerState:F.hasEagerState,eagerState:F.eagerState,next:null},T===null?(E=T=H,v=m):T=T.next=H,Ct.lanes|=W,Fi|=W;F=F.next}while(F!==null&&F!==a);if(T===null?v=m:T.next=E,!rn(m,i.memoizedState)&&(ve=!0,V&&(l=ua,l!==null)))throw l;i.memoizedState=m,i.baseState=v,i.baseQueue=T,u.lastRenderedState=m}return p===null&&(u.lanes=0),[i.memoizedState,u.dispatch]}function Ah(i){var a=de(),l=a.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=i;var u=l.dispatch,p=l.pending,m=a.memoizedState;if(p!==null){l.pending=null;var v=p=p.next;do m=i(m,v.action),v=v.next;while(v!==p);rn(m,a.memoizedState)||(ve=!0),a.memoizedState=m,a.baseQueue===null&&(a.baseState=m),l.lastRenderedState=m}return[m,u]}function om(i,a,l){var u=Ct,p=de(),m=Pt;if(m){if(l===void 0)throw Error(n(407));l=l()}else l=a();var v=!rn((jt||p).memoizedState,l);v&&(p.memoizedState=l,ve=!0),p=p.queue;var E=um.bind(null,u,p,i);if(Lr(2048,8,E,[i]),p.getSnapshot!==a||v||he!==null&&he.memoizedState.tag&1){if(u.flags|=2048,pa(9,xl(),cm.bind(null,u,p,l,a),null),$t===null)throw Error(n(349));m||(Ni&124)!==0||lm(u,a,l)}return l}function lm(i,a,l){i.flags|=16384,i={getSnapshot:a,value:l},a=Ct.updateQueue,a===null?(a=yh(),Ct.updateQueue=a,a.stores=[i]):(l=a.stores,l===null?a.stores=[i]:l.push(i))}function cm(i,a,l,u){a.value=l,a.getSnapshot=u,hm(a)&&dm(i)}function um(i,a,l){return l(function(){hm(a)&&dm(i)})}function hm(i){var a=i.getSnapshot;i=i.value;try{var l=a();return!rn(i,l)}catch{return!0}}function dm(i){var a=aa(i,2);a!==null&&dn(a,i,2)}function Sh(i){var a=We();if(typeof i=="function"){var l=i;if(i=l(),vs){wi(!0);try{l()}finally{wi(!1)}}}return a.memoizedState=a.baseState=i,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:i},a}function fm(i,a,l,u){return i.baseState=l,vh(i,jt,typeof u=="function"?u:ci)}function kS(i,a,l,u,p){if(Dl(i))throw Error(n(485));if(i=a.action,i!==null){var m={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};k.T!==null?l(!0):m.isTransition=!1,u(m),l=a.pending,l===null?(m.next=a.pending=m,pm(a,m)):(m.next=l.next,a.pending=l.next=m)}}function pm(i,a){var l=a.action,u=a.payload,p=i.state;if(a.isTransition){var m=k.T,v={};k.T=v;try{var E=l(p,u),T=k.S;T!==null&&T(v,E),gm(i,a,E)}catch(F){Eh(i,a,F)}finally{k.T=m}}else try{m=l(p,u),gm(i,a,m)}catch(F){Eh(i,a,F)}}function gm(i,a,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){mm(i,a,u)},function(u){return Eh(i,a,u)}):mm(i,a,l)}function mm(i,a,l){a.status="fulfilled",a.value=l,_m(a),i.state=l,a=i.pending,a!==null&&(l=a.next,l===a?i.pending=null:(l=l.next,a.next=l,pm(i,l)))}function Eh(i,a,l){var u=i.pending;if(i.pending=null,u!==null){u=u.next;do a.status="rejected",a.reason=l,_m(a),a=a.next;while(a!==u)}i.action=null}function _m(i){i=i.listeners;for(var a=0;a<i.length;a++)(0,i[a])()}function ym(i,a){return a}function bm(i,a){if(Pt){var l=$t.formState;if(l!==null){t:{var u=Ct;if(Pt){if(se){e:{for(var p=se,m=Fn;p.nodeType!==8;){if(!m){p=null;break e}if(p=Nn(p.nextSibling),p===null){p=null;break e}}m=p.data,p=m==="F!"||m==="F"?p:null}if(p){se=Nn(p.nextSibling),u=p.data==="F!";break t}}ms(u)}u=!1}u&&(a=l[0])}}return l=We(),l.memoizedState=l.baseState=a,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ym,lastRenderedState:a},l.queue=u,l=Fm.bind(null,Ct,u),u.dispatch=l,u=Sh(!1),m=Rh.bind(null,Ct,!1,u.queue),u=We(),p={state:a,dispatch:null,action:i,pending:null},u.queue=p,l=kS.bind(null,Ct,p,m,l),p.dispatch=l,u.memoizedState=i,[a,l,!1]}function vm(i){var a=de();return Am(a,jt,i)}function Am(i,a,l){if(a=vh(i,a,ym)[0],i=Tl(ci)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var u=kr(a)}catch(v){throw v===xr?vl:v}else u=a;a=de();var p=a.queue,m=p.dispatch;return l!==a.memoizedState&&(Ct.flags|=2048,pa(9,xl(),LS.bind(null,p,l),null)),[u,m,i]}function LS(i,a){i.action=a}function Sm(i){var a=de(),l=jt;if(l!==null)return Am(a,l,i);de(),a=a.memoizedState,l=de();var u=l.queue.dispatch;return l.memoizedState=i,[a,u,!1]}function pa(i,a,l,u){return i={tag:i,create:l,deps:u,inst:a,next:null},a=Ct.updateQueue,a===null&&(a=yh(),Ct.updateQueue=a),l=a.lastEffect,l===null?a.lastEffect=i.next=i:(u=l.next,l.next=i,i.next=u,a.lastEffect=i),i}function xl(){return{destroy:void 0,resource:void 0}}function Em(){return de().memoizedState}function Rl(i,a,l,u){var p=We();u=u===void 0?null:u,Ct.flags|=i,p.memoizedState=pa(1|a,xl(),l,u)}function Lr(i,a,l,u){var p=de();u=u===void 0?null:u;var m=p.memoizedState.inst;jt!==null&&u!==null&&fh(u,jt.memoizedState.deps)?p.memoizedState=pa(a,m,l,u):(Ct.flags|=i,p.memoizedState=pa(1|a,m,l,u))}function wm(i,a){Rl(8390656,8,i,a)}function Cm(i,a){Lr(2048,8,i,a)}function Tm(i,a){return Lr(4,2,i,a)}function xm(i,a){return Lr(4,4,i,a)}function Rm(i,a){if(typeof a=="function"){i=i();var l=a(i);return function(){typeof l=="function"?l():a(null)}}if(a!=null)return i=i(),a.current=i,function(){a.current=null}}function Dm(i,a,l){l=l!=null?l.concat([i]):null,Lr(4,4,Rm.bind(null,a,i),l)}function wh(){}function Mm(i,a){var l=de();a=a===void 0?null:a;var u=l.memoizedState;return a!==null&&fh(a,u[1])?u[0]:(l.memoizedState=[i,a],i)}function Nm(i,a){var l=de();a=a===void 0?null:a;var u=l.memoizedState;if(a!==null&&fh(a,u[1]))return u[0];if(u=i(),vs){wi(!0);try{i()}finally{wi(!1)}}return l.memoizedState=[u,a],u}function Ch(i,a,l){return l===void 0||(Ni&1073741824)!==0?i.memoizedState=a:(i.memoizedState=l,i=L_(),Ct.lanes|=i,Fi|=i,l)}function Om(i,a,l,u){return rn(l,a)?l:ha.current!==null?(i=Ch(i,l,u),rn(i,a)||(ve=!0),i):(Ni&42)===0?(ve=!0,i.memoizedState=l):(i=L_(),Ct.lanes|=i,Fi|=i,a)}function km(i,a,l,u,p){var m=U.p;U.p=m!==0&&8>m?m:8;var v=k.T,E={};k.T=E,Rh(i,!1,a,l);try{var T=p(),F=k.S;if(F!==null&&F(E,T),T!==null&&typeof T=="object"&&typeof T.then=="function"){var V=MS(T,u);Ir(i,a,V,hn(i))}else Ir(i,a,u,hn(i))}catch(W){Ir(i,a,{then:function(){},status:"rejected",reason:W},hn())}finally{U.p=m,k.T=v}}function IS(){}function Th(i,a,l,u){if(i.tag!==5)throw Error(n(476));var p=Lm(i).queue;km(i,p,a,it,l===null?IS:function(){return Im(i),l(u)})}function Lm(i){var a=i.memoizedState;if(a!==null)return a;a={memoizedState:it,baseState:it,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:it},next:null};var l={};return a.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:l},next:null},i.memoizedState=a,i=i.alternate,i!==null&&(i.memoizedState=a),a}function Im(i){var a=Lm(i).next.queue;Ir(i,a,{},hn())}function xh(){return Fe(Jr)}function Pm(){return de().memoizedState}function Bm(){return de().memoizedState}function PS(i){for(var a=i.return;a!==null;){switch(a.tag){case 24:case 3:var l=hn();i=Di(l);var u=Mi(a,i,l);u!==null&&(dn(u,a,l),Dr(u,a,l)),a={cache:ih()},i.payload=a;return}a=a.return}}function BS(i,a,l){var u=hn();l={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Dl(i)?Hm(a,l):(l=Xu(i,a,l,u),l!==null&&(dn(l,i,u),zm(l,a,u)))}function Fm(i,a,l){var u=hn();Ir(i,a,l,u)}function Ir(i,a,l,u){var p={lane:u,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Dl(i))Hm(a,p);else{var m=i.alternate;if(i.lanes===0&&(m===null||m.lanes===0)&&(m=a.lastRenderedReducer,m!==null))try{var v=a.lastRenderedState,E=m(v,l);if(p.hasEagerState=!0,p.eagerState=E,rn(E,v))return dl(i,a,p,0),$t===null&&hl(),!1}catch{}finally{}if(l=Xu(i,a,p,u),l!==null)return dn(l,i,u),zm(l,a,u),!0}return!1}function Rh(i,a,l,u){if(u={lane:2,revertLane:rd(),action:u,hasEagerState:!1,eagerState:null,next:null},Dl(i)){if(a)throw Error(n(479))}else a=Xu(i,l,u,2),a!==null&&dn(a,i,2)}function Dl(i){var a=i.alternate;return i===Ct||a!==null&&a===Ct}function Hm(i,a){da=El=!0;var l=i.pending;l===null?a.next=a:(a.next=l.next,l.next=a),i.pending=a}function zm(i,a,l){if((l&4194048)!==0){var u=a.lanes;u&=i.pendingLanes,l|=u,a.lanes=l,$p(i,l)}}var Ml={readContext:Fe,use:Cl,useCallback:re,useContext:re,useEffect:re,useImperativeHandle:re,useLayoutEffect:re,useInsertionEffect:re,useMemo:re,useReducer:re,useRef:re,useState:re,useDebugValue:re,useDeferredValue:re,useTransition:re,useSyncExternalStore:re,useId:re,useHostTransitionStatus:re,useFormState:re,useActionState:re,useOptimistic:re,useMemoCache:re,useCacheRefresh:re},Um={readContext:Fe,use:Cl,useCallback:function(i,a){return We().memoizedState=[i,a===void 0?null:a],i},useContext:Fe,useEffect:wm,useImperativeHandle:function(i,a,l){l=l!=null?l.concat([i]):null,Rl(4194308,4,Rm.bind(null,a,i),l)},useLayoutEffect:function(i,a){return Rl(4194308,4,i,a)},useInsertionEffect:function(i,a){Rl(4,2,i,a)},useMemo:function(i,a){var l=We();a=a===void 0?null:a;var u=i();if(vs){wi(!0);try{i()}finally{wi(!1)}}return l.memoizedState=[u,a],u},useReducer:function(i,a,l){var u=We();if(l!==void 0){var p=l(a);if(vs){wi(!0);try{l(a)}finally{wi(!1)}}}else p=a;return u.memoizedState=u.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},u.queue=i,i=i.dispatch=BS.bind(null,Ct,i),[u.memoizedState,i]},useRef:function(i){var a=We();return i={current:i},a.memoizedState=i},useState:function(i){i=Sh(i);var a=i.queue,l=Fm.bind(null,Ct,a);return a.dispatch=l,[i.memoizedState,l]},useDebugValue:wh,useDeferredValue:function(i,a){var l=We();return Ch(l,i,a)},useTransition:function(){var i=Sh(!1);return i=km.bind(null,Ct,i.queue,!0,!1),We().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,a,l){var u=Ct,p=We();if(Pt){if(l===void 0)throw Error(n(407));l=l()}else{if(l=a(),$t===null)throw Error(n(349));(Lt&124)!==0||lm(u,a,l)}p.memoizedState=l;var m={value:l,getSnapshot:a};return p.queue=m,wm(um.bind(null,u,m,i),[i]),u.flags|=2048,pa(9,xl(),cm.bind(null,u,m,l,a),null),l},useId:function(){var i=We(),a=$t.identifierPrefix;if(Pt){var l=ri,u=ai;l=(u&~(1<<32-an(u)-1)).toString(32)+l,a="«"+a+"R"+l,l=wl++,0<l&&(a+="H"+l.toString(32)),a+="»"}else l=NS++,a="«"+a+"r"+l.toString(32)+"»";return i.memoizedState=a},useHostTransitionStatus:xh,useFormState:bm,useActionState:bm,useOptimistic:function(i){var a=We();a.memoizedState=a.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=l,a=Rh.bind(null,Ct,!0,l),l.dispatch=a,[i,a]},useMemoCache:bh,useCacheRefresh:function(){return We().memoizedState=PS.bind(null,Ct)}},jm={readContext:Fe,use:Cl,useCallback:Mm,useContext:Fe,useEffect:Cm,useImperativeHandle:Dm,useInsertionEffect:Tm,useLayoutEffect:xm,useMemo:Nm,useReducer:Tl,useRef:Em,useState:function(){return Tl(ci)},useDebugValue:wh,useDeferredValue:function(i,a){var l=de();return Om(l,jt.memoizedState,i,a)},useTransition:function(){var i=Tl(ci)[0],a=de().memoizedState;return[typeof i=="boolean"?i:kr(i),a]},useSyncExternalStore:om,useId:Pm,useHostTransitionStatus:xh,useFormState:vm,useActionState:vm,useOptimistic:function(i,a){var l=de();return fm(l,jt,i,a)},useMemoCache:bh,useCacheRefresh:Bm},FS={readContext:Fe,use:Cl,useCallback:Mm,useContext:Fe,useEffect:Cm,useImperativeHandle:Dm,useInsertionEffect:Tm,useLayoutEffect:xm,useMemo:Nm,useReducer:Ah,useRef:Em,useState:function(){return Ah(ci)},useDebugValue:wh,useDeferredValue:function(i,a){var l=de();return jt===null?Ch(l,i,a):Om(l,jt.memoizedState,i,a)},useTransition:function(){var i=Ah(ci)[0],a=de().memoizedState;return[typeof i=="boolean"?i:kr(i),a]},useSyncExternalStore:om,useId:Pm,useHostTransitionStatus:xh,useFormState:Sm,useActionState:Sm,useOptimistic:function(i,a){var l=de();return jt!==null?fm(l,jt,i,a):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:bh,useCacheRefresh:Bm},ga=null,Pr=0;function Nl(i){var a=Pr;return Pr+=1,ga===null&&(ga=[]),Jg(ga,i,a)}function Br(i,a){a=a.props.ref,i.ref=a!==void 0?a:null}function Ol(i,a){throw a.$$typeof===_?Error(n(525)):(i=Object.prototype.toString.call(a),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":i)))}function Gm(i){var a=i._init;return a(i._payload)}function qm(i){function a(L,M){if(i){var B=L.deletions;B===null?(L.deletions=[M],L.flags|=16):B.push(M)}}function l(L,M){if(!i)return null;for(;M!==null;)a(L,M),M=M.sibling;return null}function u(L){for(var M=new Map;L!==null;)L.key!==null?M.set(L.key,L):M.set(L.index,L),L=L.sibling;return M}function p(L,M){return L=si(L,M),L.index=0,L.sibling=null,L}function m(L,M,B){return L.index=B,i?(B=L.alternate,B!==null?(B=B.index,B<M?(L.flags|=67108866,M):B):(L.flags|=67108866,M)):(L.flags|=1048576,M)}function v(L){return i&&L.alternate===null&&(L.flags|=67108866),L}function E(L,M,B,X){return M===null||M.tag!==6?(M=Wu(B,L.mode,X),M.return=L,M):(M=p(M,B),M.return=L,M)}function T(L,M,B,X){var lt=B.type;return lt===A?V(L,M,B.props.children,X,B.key):M!==null&&(M.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===Y&&Gm(lt)===M.type)?(M=p(M,B.props),Br(M,B),M.return=L,M):(M=pl(B.type,B.key,B.props,null,L.mode,X),Br(M,B),M.return=L,M)}function F(L,M,B,X){return M===null||M.tag!==4||M.stateNode.containerInfo!==B.containerInfo||M.stateNode.implementation!==B.implementation?(M=Ku(B,L.mode,X),M.return=L,M):(M=p(M,B.children||[]),M.return=L,M)}function V(L,M,B,X,lt){return M===null||M.tag!==7?(M=ds(B,L.mode,X,lt),M.return=L,M):(M=p(M,B),M.return=L,M)}function W(L,M,B){if(typeof M=="string"&&M!==""||typeof M=="number"||typeof M=="bigint")return M=Wu(""+M,L.mode,B),M.return=L,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case y:return B=pl(M.type,M.key,M.props,null,L.mode,B),Br(B,M),B.return=L,B;case b:return M=Ku(M,L.mode,B),M.return=L,M;case Y:var X=M._init;return M=X(M._payload),W(L,M,B)}if(St(M)||pt(M))return M=ds(M,L.mode,B,null),M.return=L,M;if(typeof M.then=="function")return W(L,Nl(M),B);if(M.$$typeof===x)return W(L,yl(L,M),B);Ol(L,M)}return null}function H(L,M,B,X){var lt=M!==null?M.key:null;if(typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint")return lt!==null?null:E(L,M,""+B,X);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case y:return B.key===lt?T(L,M,B,X):null;case b:return B.key===lt?F(L,M,B,X):null;case Y:return lt=B._init,B=lt(B._payload),H(L,M,B,X)}if(St(B)||pt(B))return lt!==null?null:V(L,M,B,X,null);if(typeof B.then=="function")return H(L,M,Nl(B),X);if(B.$$typeof===x)return H(L,M,yl(L,B),X);Ol(L,B)}return null}function z(L,M,B,X,lt){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return L=L.get(B)||null,E(M,L,""+X,lt);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case y:return L=L.get(X.key===null?B:X.key)||null,T(M,L,X,lt);case b:return L=L.get(X.key===null?B:X.key)||null,F(M,L,X,lt);case Y:var xt=X._init;return X=xt(X._payload),z(L,M,B,X,lt)}if(St(X)||pt(X))return L=L.get(B)||null,V(M,L,X,lt,null);if(typeof X.then=="function")return z(L,M,B,Nl(X),lt);if(X.$$typeof===x)return z(L,M,B,yl(M,X),lt);Ol(M,X)}return null}function _t(L,M,B,X){for(var lt=null,xt=null,ut=M,gt=M=0,Se=null;ut!==null&&gt<B.length;gt++){ut.index>gt?(Se=ut,ut=null):Se=ut.sibling;var It=H(L,ut,B[gt],X);if(It===null){ut===null&&(ut=Se);break}i&&ut&&It.alternate===null&&a(L,ut),M=m(It,M,gt),xt===null?lt=It:xt.sibling=It,xt=It,ut=Se}if(gt===B.length)return l(L,ut),Pt&&ps(L,gt),lt;if(ut===null){for(;gt<B.length;gt++)ut=W(L,B[gt],X),ut!==null&&(M=m(ut,M,gt),xt===null?lt=ut:xt.sibling=ut,xt=ut);return Pt&&ps(L,gt),lt}for(ut=u(ut);gt<B.length;gt++)Se=z(ut,L,gt,B[gt],X),Se!==null&&(i&&Se.alternate!==null&&ut.delete(Se.key===null?gt:Se.key),M=m(Se,M,gt),xt===null?lt=Se:xt.sibling=Se,xt=Se);return i&&ut.forEach(function(Xi){return a(L,Xi)}),Pt&&ps(L,gt),lt}function ft(L,M,B,X){if(B==null)throw Error(n(151));for(var lt=null,xt=null,ut=M,gt=M=0,Se=null,It=B.next();ut!==null&&!It.done;gt++,It=B.next()){ut.index>gt?(Se=ut,ut=null):Se=ut.sibling;var Xi=H(L,ut,It.value,X);if(Xi===null){ut===null&&(ut=Se);break}i&&ut&&Xi.alternate===null&&a(L,ut),M=m(Xi,M,gt),xt===null?lt=Xi:xt.sibling=Xi,xt=Xi,ut=Se}if(It.done)return l(L,ut),Pt&&ps(L,gt),lt;if(ut===null){for(;!It.done;gt++,It=B.next())It=W(L,It.value,X),It!==null&&(M=m(It,M,gt),xt===null?lt=It:xt.sibling=It,xt=It);return Pt&&ps(L,gt),lt}for(ut=u(ut);!It.done;gt++,It=B.next())It=z(ut,L,gt,It.value,X),It!==null&&(i&&It.alternate!==null&&ut.delete(It.key===null?gt:It.key),M=m(It,M,gt),xt===null?lt=It:xt.sibling=It,xt=It);return i&&ut.forEach(function(HE){return a(L,HE)}),Pt&&ps(L,gt),lt}function qt(L,M,B,X){if(typeof B=="object"&&B!==null&&B.type===A&&B.key===null&&(B=B.props.children),typeof B=="object"&&B!==null){switch(B.$$typeof){case y:t:{for(var lt=B.key;M!==null;){if(M.key===lt){if(lt=B.type,lt===A){if(M.tag===7){l(L,M.sibling),X=p(M,B.props.children),X.return=L,L=X;break t}}else if(M.elementType===lt||typeof lt=="object"&&lt!==null&&lt.$$typeof===Y&&Gm(lt)===M.type){l(L,M.sibling),X=p(M,B.props),Br(X,B),X.return=L,L=X;break t}l(L,M);break}else a(L,M);M=M.sibling}B.type===A?(X=ds(B.props.children,L.mode,X,B.key),X.return=L,L=X):(X=pl(B.type,B.key,B.props,null,L.mode,X),Br(X,B),X.return=L,L=X)}return v(L);case b:t:{for(lt=B.key;M!==null;){if(M.key===lt)if(M.tag===4&&M.stateNode.containerInfo===B.containerInfo&&M.stateNode.implementation===B.implementation){l(L,M.sibling),X=p(M,B.children||[]),X.return=L,L=X;break t}else{l(L,M);break}else a(L,M);M=M.sibling}X=Ku(B,L.mode,X),X.return=L,L=X}return v(L);case Y:return lt=B._init,B=lt(B._payload),qt(L,M,B,X)}if(St(B))return _t(L,M,B,X);if(pt(B)){if(lt=pt(B),typeof lt!="function")throw Error(n(150));return B=lt.call(B),ft(L,M,B,X)}if(typeof B.then=="function")return qt(L,M,Nl(B),X);if(B.$$typeof===x)return qt(L,M,yl(L,B),X);Ol(L,B)}return typeof B=="string"&&B!==""||typeof B=="number"||typeof B=="bigint"?(B=""+B,M!==null&&M.tag===6?(l(L,M.sibling),X=p(M,B),X.return=L,L=X):(l(L,M),X=Wu(B,L.mode,X),X.return=L,L=X),v(L)):l(L,M)}return function(L,M,B,X){try{Pr=0;var lt=qt(L,M,B,X);return ga=null,lt}catch(ut){if(ut===xr||ut===vl)throw ut;var xt=on(29,ut,null,L.mode);return xt.lanes=X,xt.return=L,xt}finally{}}}var ma=qm(!0),Vm=qm(!1),An=$(null),Hn=null;function Oi(i){var a=i.alternate;N(ye,ye.current&1),N(An,i),Hn===null&&(a===null||ha.current!==null||a.memoizedState!==null)&&(Hn=i)}function Ym(i){if(i.tag===22){if(N(ye,ye.current),N(An,i),Hn===null){var a=i.alternate;a!==null&&a.memoizedState!==null&&(Hn=i)}}else ki()}function ki(){N(ye,ye.current),N(An,An.current)}function ui(i){J(An),Hn===i&&(Hn=null),J(ye)}var ye=$(0);function kl(i){for(var a=i;a!==null;){if(a.tag===13){var l=a.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||yd(l)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function Dh(i,a,l,u){a=i.memoizedState,l=l(u,a),l=l==null?a:g({},a,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Mh={enqueueSetState:function(i,a,l){i=i._reactInternals;var u=hn(),p=Di(u);p.payload=a,l!=null&&(p.callback=l),a=Mi(i,p,u),a!==null&&(dn(a,i,u),Dr(a,i,u))},enqueueReplaceState:function(i,a,l){i=i._reactInternals;var u=hn(),p=Di(u);p.tag=1,p.payload=a,l!=null&&(p.callback=l),a=Mi(i,p,u),a!==null&&(dn(a,i,u),Dr(a,i,u))},enqueueForceUpdate:function(i,a){i=i._reactInternals;var l=hn(),u=Di(l);u.tag=2,a!=null&&(u.callback=a),a=Mi(i,u,l),a!==null&&(dn(a,i,l),Dr(a,i,l))}};function Xm(i,a,l,u,p,m,v){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(u,m,v):a.prototype&&a.prototype.isPureReactComponent?!br(l,u)||!br(p,m):!0}function $m(i,a,l,u){i=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(l,u),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(l,u),a.state!==i&&Mh.enqueueReplaceState(a,a.state,null)}function As(i,a){var l=a;if("ref"in a){l={};for(var u in a)u!=="ref"&&(l[u]=a[u])}if(i=i.defaultProps){l===a&&(l=g({},l));for(var p in i)l[p]===void 0&&(l[p]=i[p])}return l}var Ll=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Wm(i){Ll(i)}function Km(i){console.error(i)}function Qm(i){Ll(i)}function Il(i,a){try{var l=i.onUncaughtError;l(a.value,{componentStack:a.stack})}catch(u){setTimeout(function(){throw u})}}function Zm(i,a,l){try{var u=i.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Nh(i,a,l){return l=Di(l),l.tag=3,l.payload={element:null},l.callback=function(){Il(i,a)},l}function Jm(i){return i=Di(i),i.tag=3,i}function t_(i,a,l,u){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var m=u.value;i.payload=function(){return p(m)},i.callback=function(){Zm(a,l,u)}}var v=l.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(i.callback=function(){Zm(a,l,u),typeof p!="function"&&(Hi===null?Hi=new Set([this]):Hi.add(this));var E=u.stack;this.componentDidCatch(u.value,{componentStack:E!==null?E:""})})}function HS(i,a,l,u,p){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(a=l.alternate,a!==null&&wr(a,l,p,!0),l=An.current,l!==null){switch(l.tag){case 13:return Hn===null?ed():l.alternate===null&&ae===0&&(ae=3),l.flags&=-257,l.flags|=65536,l.lanes=p,u===rh?l.flags|=16384:(a=l.updateQueue,a===null?l.updateQueue=new Set([u]):a.add(u),id(i,u,p)),!1;case 22:return l.flags|=65536,u===rh?l.flags|=16384:(a=l.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=a):(l=a.retryQueue,l===null?a.retryQueue=new Set([u]):l.add(u)),id(i,u,p)),!1}throw Error(n(435,l.tag))}return id(i,u,p),ed(),!1}if(Pt)return a=An.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=p,u!==Ju&&(i=Error(n(422),{cause:u}),Er(_n(i,l)))):(u!==Ju&&(a=Error(n(423),{cause:u}),Er(_n(a,l))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,u=_n(u,l),p=Nh(i.stateNode,u,p),ch(i,p),ae!==4&&(ae=2)),!1;var m=Error(n(520),{cause:u});if(m=_n(m,l),qr===null?qr=[m]:qr.push(m),ae!==4&&(ae=2),a===null)return!0;u=_n(u,l),l=a;do{switch(l.tag){case 3:return l.flags|=65536,i=p&-p,l.lanes|=i,i=Nh(l.stateNode,u,i),ch(l,i),!1;case 1:if(a=l.type,m=l.stateNode,(l.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Hi===null||!Hi.has(m))))return l.flags|=65536,p&=-p,l.lanes|=p,p=Jm(p),t_(p,i,l,u),ch(l,p),!1}l=l.return}while(l!==null);return!1}var e_=Error(n(461)),ve=!1;function Me(i,a,l,u){a.child=i===null?Vm(a,null,l,u):ma(a,i.child,l,u)}function n_(i,a,l,u,p){l=l.render;var m=a.ref;if("ref"in u){var v={};for(var E in u)E!=="ref"&&(v[E]=u[E])}else v=u;return ys(a),u=ph(i,a,l,v,m,p),E=gh(),i!==null&&!ve?(mh(i,a,p),hi(i,a,p)):(Pt&&E&&Qu(a),a.flags|=1,Me(i,a,u,p),a.child)}function i_(i,a,l,u,p){if(i===null){var m=l.type;return typeof m=="function"&&!$u(m)&&m.defaultProps===void 0&&l.compare===null?(a.tag=15,a.type=m,s_(i,a,m,u,p)):(i=pl(l.type,null,u,a,a.mode,p),i.ref=a.ref,i.return=a,a.child=i)}if(m=i.child,!Hh(i,p)){var v=m.memoizedProps;if(l=l.compare,l=l!==null?l:br,l(v,u)&&i.ref===a.ref)return hi(i,a,p)}return a.flags|=1,i=si(m,u),i.ref=a.ref,i.return=a,a.child=i}function s_(i,a,l,u,p){if(i!==null){var m=i.memoizedProps;if(br(m,u)&&i.ref===a.ref)if(ve=!1,a.pendingProps=u=m,Hh(i,p))(i.flags&131072)!==0&&(ve=!0);else return a.lanes=i.lanes,hi(i,a,p)}return Oh(i,a,l,u,p)}function a_(i,a,l){var u=a.pendingProps,p=u.children,m=i!==null?i.memoizedState:null;if(u.mode==="hidden"){if((a.flags&128)!==0){if(u=m!==null?m.baseLanes|l:l,i!==null){for(p=a.child=i.child,m=0;p!==null;)m=m|p.lanes|p.childLanes,p=p.sibling;a.childLanes=m&~u}else a.childLanes=0,a.child=null;return r_(i,a,u,l)}if((l&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},i!==null&&bl(a,m!==null?m.cachePool:null),m!==null?sm(a,m):hh(),Ym(a);else return a.lanes=a.childLanes=536870912,r_(i,a,m!==null?m.baseLanes|l:l,l)}else m!==null?(bl(a,m.cachePool),sm(a,m),ki(),a.memoizedState=null):(i!==null&&bl(a,null),hh(),ki());return Me(i,a,p,l),a.child}function r_(i,a,l,u){var p=ah();return p=p===null?null:{parent:_e._currentValue,pool:p},a.memoizedState={baseLanes:l,cachePool:p},i!==null&&bl(a,null),hh(),Ym(a),i!==null&&wr(i,a,u,!0),null}function Pl(i,a){var l=a.ref;if(l===null)i!==null&&i.ref!==null&&(a.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(i===null||i.ref!==l)&&(a.flags|=4194816)}}function Oh(i,a,l,u,p){return ys(a),l=ph(i,a,l,u,void 0,p),u=gh(),i!==null&&!ve?(mh(i,a,p),hi(i,a,p)):(Pt&&u&&Qu(a),a.flags|=1,Me(i,a,l,p),a.child)}function o_(i,a,l,u,p,m){return ys(a),a.updateQueue=null,l=rm(a,u,l,p),am(i),u=gh(),i!==null&&!ve?(mh(i,a,m),hi(i,a,m)):(Pt&&u&&Qu(a),a.flags|=1,Me(i,a,l,m),a.child)}function l_(i,a,l,u,p){if(ys(a),a.stateNode===null){var m=ra,v=l.contextType;typeof v=="object"&&v!==null&&(m=Fe(v)),m=new l(u,m),a.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Mh,a.stateNode=m,m._reactInternals=a,m=a.stateNode,m.props=u,m.state=a.memoizedState,m.refs={},oh(a),v=l.contextType,m.context=typeof v=="object"&&v!==null?Fe(v):ra,m.state=a.memoizedState,v=l.getDerivedStateFromProps,typeof v=="function"&&(Dh(a,l,v,u),m.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&Mh.enqueueReplaceState(m,m.state,null),Nr(a,u,m,p),Mr(),m.state=a.memoizedState),typeof m.componentDidMount=="function"&&(a.flags|=4194308),u=!0}else if(i===null){m=a.stateNode;var E=a.memoizedProps,T=As(l,E);m.props=T;var F=m.context,V=l.contextType;v=ra,typeof V=="object"&&V!==null&&(v=Fe(V));var W=l.getDerivedStateFromProps;V=typeof W=="function"||typeof m.getSnapshotBeforeUpdate=="function",E=a.pendingProps!==E,V||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(E||F!==v)&&$m(a,m,u,v),Ri=!1;var H=a.memoizedState;m.state=H,Nr(a,u,m,p),Mr(),F=a.memoizedState,E||H!==F||Ri?(typeof W=="function"&&(Dh(a,l,W,u),F=a.memoizedState),(T=Ri||Xm(a,l,T,u,H,F,v))?(V||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(a.flags|=4194308)):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=u,a.memoizedState=F),m.props=u,m.state=F,m.context=v,u=T):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),u=!1)}else{m=a.stateNode,lh(i,a),v=a.memoizedProps,V=As(l,v),m.props=V,W=a.pendingProps,H=m.context,F=l.contextType,T=ra,typeof F=="object"&&F!==null&&(T=Fe(F)),E=l.getDerivedStateFromProps,(F=typeof E=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==W||H!==T)&&$m(a,m,u,T),Ri=!1,H=a.memoizedState,m.state=H,Nr(a,u,m,p),Mr();var z=a.memoizedState;v!==W||H!==z||Ri||i!==null&&i.dependencies!==null&&_l(i.dependencies)?(typeof E=="function"&&(Dh(a,l,E,u),z=a.memoizedState),(V=Ri||Xm(a,l,V,u,H,z,T)||i!==null&&i.dependencies!==null&&_l(i.dependencies))?(F||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(u,z,T),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(u,z,T)),typeof m.componentDidUpdate=="function"&&(a.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===i.memoizedProps&&H===i.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===i.memoizedProps&&H===i.memoizedState||(a.flags|=1024),a.memoizedProps=u,a.memoizedState=z),m.props=u,m.state=z,m.context=T,u=V):(typeof m.componentDidUpdate!="function"||v===i.memoizedProps&&H===i.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===i.memoizedProps&&H===i.memoizedState||(a.flags|=1024),u=!1)}return m=u,Pl(i,a),u=(a.flags&128)!==0,m||u?(m=a.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:m.render(),a.flags|=1,i!==null&&u?(a.child=ma(a,i.child,null,p),a.child=ma(a,null,l,p)):Me(i,a,l,p),a.memoizedState=m.state,i=a.child):i=hi(i,a,p),i}function c_(i,a,l,u){return Sr(),a.flags|=256,Me(i,a,l,u),a.child}var kh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Lh(i){return{baseLanes:i,cachePool:Kg()}}function Ih(i,a,l){return i=i!==null?i.childLanes&~l:0,a&&(i|=Sn),i}function u_(i,a,l){var u=a.pendingProps,p=!1,m=(a.flags&128)!==0,v;if((v=m)||(v=i!==null&&i.memoizedState===null?!1:(ye.current&2)!==0),v&&(p=!0,a.flags&=-129),v=(a.flags&32)!==0,a.flags&=-33,i===null){if(Pt){if(p?Oi(a):ki(),Pt){var E=se,T;if(T=E){t:{for(T=E,E=Fn;T.nodeType!==8;){if(!E){E=null;break t}if(T=Nn(T.nextSibling),T===null){E=null;break t}}E=T}E!==null?(a.memoizedState={dehydrated:E,treeContext:fs!==null?{id:ai,overflow:ri}:null,retryLane:536870912,hydrationErrors:null},T=on(18,null,null,0),T.stateNode=E,T.return=a,a.child=T,ze=a,se=null,T=!0):T=!1}T||ms(a)}if(E=a.memoizedState,E!==null&&(E=E.dehydrated,E!==null))return yd(E)?a.lanes=32:a.lanes=536870912,null;ui(a)}return E=u.children,u=u.fallback,p?(ki(),p=a.mode,E=Bl({mode:"hidden",children:E},p),u=ds(u,p,l,null),E.return=a,u.return=a,E.sibling=u,a.child=E,p=a.child,p.memoizedState=Lh(l),p.childLanes=Ih(i,v,l),a.memoizedState=kh,u):(Oi(a),Ph(a,E))}if(T=i.memoizedState,T!==null&&(E=T.dehydrated,E!==null)){if(m)a.flags&256?(Oi(a),a.flags&=-257,a=Bh(i,a,l)):a.memoizedState!==null?(ki(),a.child=i.child,a.flags|=128,a=null):(ki(),p=u.fallback,E=a.mode,u=Bl({mode:"visible",children:u.children},E),p=ds(p,E,l,null),p.flags|=2,u.return=a,p.return=a,u.sibling=p,a.child=u,ma(a,i.child,null,l),u=a.child,u.memoizedState=Lh(l),u.childLanes=Ih(i,v,l),a.memoizedState=kh,a=p);else if(Oi(a),yd(E)){if(v=E.nextSibling&&E.nextSibling.dataset,v)var F=v.dgst;v=F,u=Error(n(419)),u.stack="",u.digest=v,Er({value:u,source:null,stack:null}),a=Bh(i,a,l)}else if(ve||wr(i,a,l,!1),v=(l&i.childLanes)!==0,ve||v){if(v=$t,v!==null&&(u=l&-l,u=(u&42)!==0?1:bu(u),u=(u&(v.suspendedLanes|l))!==0?0:u,u!==0&&u!==T.retryLane))throw T.retryLane=u,aa(i,u),dn(v,i,u),e_;E.data==="$?"||ed(),a=Bh(i,a,l)}else E.data==="$?"?(a.flags|=192,a.child=i.child,a=null):(i=T.treeContext,se=Nn(E.nextSibling),ze=a,Pt=!0,gs=null,Fn=!1,i!==null&&(bn[vn++]=ai,bn[vn++]=ri,bn[vn++]=fs,ai=i.id,ri=i.overflow,fs=a),a=Ph(a,u.children),a.flags|=4096);return a}return p?(ki(),p=u.fallback,E=a.mode,T=i.child,F=T.sibling,u=si(T,{mode:"hidden",children:u.children}),u.subtreeFlags=T.subtreeFlags&65011712,F!==null?p=si(F,p):(p=ds(p,E,l,null),p.flags|=2),p.return=a,u.return=a,u.sibling=p,a.child=u,u=p,p=a.child,E=i.child.memoizedState,E===null?E=Lh(l):(T=E.cachePool,T!==null?(F=_e._currentValue,T=T.parent!==F?{parent:F,pool:F}:T):T=Kg(),E={baseLanes:E.baseLanes|l,cachePool:T}),p.memoizedState=E,p.childLanes=Ih(i,v,l),a.memoizedState=kh,u):(Oi(a),l=i.child,i=l.sibling,l=si(l,{mode:"visible",children:u.children}),l.return=a,l.sibling=null,i!==null&&(v=a.deletions,v===null?(a.deletions=[i],a.flags|=16):v.push(i)),a.child=l,a.memoizedState=null,l)}function Ph(i,a){return a=Bl({mode:"visible",children:a},i.mode),a.return=i,i.child=a}function Bl(i,a){return i=on(22,i,null,a),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function Bh(i,a,l){return ma(a,i.child,null,l),i=Ph(a,a.pendingProps.children),i.flags|=2,a.memoizedState=null,i}function h_(i,a,l){i.lanes|=a;var u=i.alternate;u!==null&&(u.lanes|=a),eh(i.return,a,l)}function Fh(i,a,l,u,p){var m=i.memoizedState;m===null?i.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:p}:(m.isBackwards=a,m.rendering=null,m.renderingStartTime=0,m.last=u,m.tail=l,m.tailMode=p)}function d_(i,a,l){var u=a.pendingProps,p=u.revealOrder,m=u.tail;if(Me(i,a,u.children,l),u=ye.current,(u&2)!==0)u=u&1|2,a.flags|=128;else{if(i!==null&&(i.flags&128)!==0)t:for(i=a.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&h_(i,l,a);else if(i.tag===19)h_(i,l,a);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break t;for(;i.sibling===null;){if(i.return===null||i.return===a)break t;i=i.return}i.sibling.return=i.return,i=i.sibling}u&=1}switch(N(ye,u),p){case"forwards":for(l=a.child,p=null;l!==null;)i=l.alternate,i!==null&&kl(i)===null&&(p=l),l=l.sibling;l=p,l===null?(p=a.child,a.child=null):(p=l.sibling,l.sibling=null),Fh(a,!1,p,l,m);break;case"backwards":for(l=null,p=a.child,a.child=null;p!==null;){if(i=p.alternate,i!==null&&kl(i)===null){a.child=p;break}i=p.sibling,p.sibling=l,l=p,p=i}Fh(a,!0,l,null,m);break;case"together":Fh(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function hi(i,a,l){if(i!==null&&(a.dependencies=i.dependencies),Fi|=a.lanes,(l&a.childLanes)===0)if(i!==null){if(wr(i,a,l,!1),(l&a.childLanes)===0)return null}else return null;if(i!==null&&a.child!==i.child)throw Error(n(153));if(a.child!==null){for(i=a.child,l=si(i,i.pendingProps),a.child=l,l.return=a;i.sibling!==null;)i=i.sibling,l=l.sibling=si(i,i.pendingProps),l.return=a;l.sibling=null}return a.child}function Hh(i,a){return(i.lanes&a)!==0?!0:(i=i.dependencies,!!(i!==null&&_l(i)))}function zS(i,a,l){switch(a.tag){case 3:rt(a,a.stateNode.containerInfo),xi(a,_e,i.memoizedState.cache),Sr();break;case 27:case 5:Ye(a);break;case 4:rt(a,a.stateNode.containerInfo);break;case 10:xi(a,a.type,a.memoizedProps.value);break;case 13:var u=a.memoizedState;if(u!==null)return u.dehydrated!==null?(Oi(a),a.flags|=128,null):(l&a.child.childLanes)!==0?u_(i,a,l):(Oi(a),i=hi(i,a,l),i!==null?i.sibling:null);Oi(a);break;case 19:var p=(i.flags&128)!==0;if(u=(l&a.childLanes)!==0,u||(wr(i,a,l,!1),u=(l&a.childLanes)!==0),p){if(u)return d_(i,a,l);a.flags|=128}if(p=a.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),N(ye,ye.current),u)break;return null;case 22:case 23:return a.lanes=0,a_(i,a,l);case 24:xi(a,_e,i.memoizedState.cache)}return hi(i,a,l)}function f_(i,a,l){if(i!==null)if(i.memoizedProps!==a.pendingProps)ve=!0;else{if(!Hh(i,l)&&(a.flags&128)===0)return ve=!1,zS(i,a,l);ve=(i.flags&131072)!==0}else ve=!1,Pt&&(a.flags&1048576)!==0&&Gg(a,ml,a.index);switch(a.lanes=0,a.tag){case 16:t:{i=a.pendingProps;var u=a.elementType,p=u._init;if(u=p(u._payload),a.type=u,typeof u=="function")$u(u)?(i=As(u,i),a.tag=1,a=l_(null,a,u,i,l)):(a.tag=0,a=Oh(null,a,u,i,l));else{if(u!=null){if(p=u.$$typeof,p===I){a.tag=11,a=n_(null,a,u,i,l);break t}else if(p===G){a.tag=14,a=i_(null,a,u,i,l);break t}}throw a=Et(u)||u,Error(n(306,a,""))}}return a;case 0:return Oh(i,a,a.type,a.pendingProps,l);case 1:return u=a.type,p=As(u,a.pendingProps),l_(i,a,u,p,l);case 3:t:{if(rt(a,a.stateNode.containerInfo),i===null)throw Error(n(387));u=a.pendingProps;var m=a.memoizedState;p=m.element,lh(i,a),Nr(a,u,null,l);var v=a.memoizedState;if(u=v.cache,xi(a,_e,u),u!==m.cache&&nh(a,[_e],l,!0),Mr(),u=v.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:v.cache},a.updateQueue.baseState=m,a.memoizedState=m,a.flags&256){a=c_(i,a,u,l);break t}else if(u!==p){p=_n(Error(n(424)),a),Er(p),a=c_(i,a,u,l);break t}else{switch(i=a.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(se=Nn(i.firstChild),ze=a,Pt=!0,gs=null,Fn=!0,l=Vm(a,null,u,l),a.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Sr(),u===p){a=hi(i,a,l);break t}Me(i,a,u,l)}a=a.child}return a;case 26:return Pl(i,a),i===null?(l=_y(a.type,null,a.pendingProps,null))?a.memoizedState=l:Pt||(l=a.type,i=a.pendingProps,u=Ql(Q.current).createElement(l),u[Be]=a,u[Xe]=i,Oe(u,l,i),be(u),a.stateNode=u):a.memoizedState=_y(a.type,i.memoizedProps,a.pendingProps,i.memoizedState),null;case 27:return Ye(a),i===null&&Pt&&(u=a.stateNode=py(a.type,a.pendingProps,Q.current),ze=a,Fn=!0,p=se,ji(a.type)?(bd=p,se=Nn(u.firstChild)):se=p),Me(i,a,a.pendingProps.children,l),Pl(i,a),i===null&&(a.flags|=4194304),a.child;case 5:return i===null&&Pt&&((p=u=se)&&(u=pE(u,a.type,a.pendingProps,Fn),u!==null?(a.stateNode=u,ze=a,se=Nn(u.firstChild),Fn=!1,p=!0):p=!1),p||ms(a)),Ye(a),p=a.type,m=a.pendingProps,v=i!==null?i.memoizedProps:null,u=m.children,gd(p,m)?u=null:v!==null&&gd(p,v)&&(a.flags|=32),a.memoizedState!==null&&(p=ph(i,a,OS,null,null,l),Jr._currentValue=p),Pl(i,a),Me(i,a,u,l),a.child;case 6:return i===null&&Pt&&((i=l=se)&&(l=gE(l,a.pendingProps,Fn),l!==null?(a.stateNode=l,ze=a,se=null,i=!0):i=!1),i||ms(a)),null;case 13:return u_(i,a,l);case 4:return rt(a,a.stateNode.containerInfo),u=a.pendingProps,i===null?a.child=ma(a,null,u,l):Me(i,a,u,l),a.child;case 11:return n_(i,a,a.type,a.pendingProps,l);case 7:return Me(i,a,a.pendingProps,l),a.child;case 8:return Me(i,a,a.pendingProps.children,l),a.child;case 12:return Me(i,a,a.pendingProps.children,l),a.child;case 10:return u=a.pendingProps,xi(a,a.type,u.value),Me(i,a,u.children,l),a.child;case 9:return p=a.type._context,u=a.pendingProps.children,ys(a),p=Fe(p),u=u(p),a.flags|=1,Me(i,a,u,l),a.child;case 14:return i_(i,a,a.type,a.pendingProps,l);case 15:return s_(i,a,a.type,a.pendingProps,l);case 19:return d_(i,a,l);case 31:return u=a.pendingProps,l=a.mode,u={mode:u.mode,children:u.children},i===null?(l=Bl(u,l),l.ref=a.ref,a.child=l,l.return=a,a=l):(l=si(i.child,u),l.ref=a.ref,a.child=l,l.return=a,a=l),a;case 22:return a_(i,a,l);case 24:return ys(a),u=Fe(_e),i===null?(p=ah(),p===null&&(p=$t,m=ih(),p.pooledCache=m,m.refCount++,m!==null&&(p.pooledCacheLanes|=l),p=m),a.memoizedState={parent:u,cache:p},oh(a),xi(a,_e,p)):((i.lanes&l)!==0&&(lh(i,a),Nr(a,null,null,l),Mr()),p=i.memoizedState,m=a.memoizedState,p.parent!==u?(p={parent:u,cache:u},a.memoizedState=p,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=p),xi(a,_e,u)):(u=m.cache,xi(a,_e,u),u!==p.cache&&nh(a,[_e],l,!0))),Me(i,a,a.pendingProps.children,l),a.child;case 29:throw a.pendingProps}throw Error(n(156,a.tag))}function di(i){i.flags|=4}function p_(i,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Sy(a)){if(a=An.current,a!==null&&((Lt&4194048)===Lt?Hn!==null:(Lt&62914560)!==Lt&&(Lt&536870912)===0||a!==Hn))throw Rr=rh,Qg;i.flags|=8192}}function Fl(i,a){a!==null&&(i.flags|=4),i.flags&16384&&(a=i.tag!==22?Yp():536870912,i.lanes|=a,va|=a)}function Fr(i,a){if(!Pt)switch(i.tailMode){case"hidden":a=i.tail;for(var l=null;a!==null;)a.alternate!==null&&(l=a),a=a.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?a||i.tail===null?i.tail=null:i.tail.sibling=null:u.sibling=null}}function te(i){var a=i.alternate!==null&&i.alternate.child===i.child,l=0,u=0;if(a)for(var p=i.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags&65011712,u|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)l|=p.lanes|p.childLanes,u|=p.subtreeFlags,u|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=u,i.childLanes=l,a}function US(i,a,l){var u=a.pendingProps;switch(Zu(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return te(a),null;case 1:return te(a),null;case 3:return l=a.stateNode,u=null,i!==null&&(u=i.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),li(_e),Ut(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Ar(a)?di(a):i===null||i.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Yg())),te(a),null;case 26:return l=a.memoizedState,i===null?(di(a),l!==null?(te(a),p_(a,l)):(te(a),a.flags&=-16777217)):l?l!==i.memoizedState?(di(a),te(a),p_(a,l)):(te(a),a.flags&=-16777217):(i.memoizedProps!==u&&di(a),te(a),a.flags&=-16777217),null;case 27:De(a),l=Q.current;var p=a.type;if(i!==null&&a.stateNode!=null)i.memoizedProps!==u&&di(a);else{if(!u){if(a.stateNode===null)throw Error(n(166));return te(a),null}i=q.current,Ar(a)?qg(a):(i=py(p,u,l),a.stateNode=i,di(a))}return te(a),null;case 5:if(De(a),l=a.type,i!==null&&a.stateNode!=null)i.memoizedProps!==u&&di(a);else{if(!u){if(a.stateNode===null)throw Error(n(166));return te(a),null}if(i=q.current,Ar(a))qg(a);else{switch(p=Ql(Q.current),i){case 1:i=p.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:i=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":i=p.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":i=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":i=p.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof u.is=="string"?p.createElement("select",{is:u.is}):p.createElement("select"),u.multiple?i.multiple=!0:u.size&&(i.size=u.size);break;default:i=typeof u.is=="string"?p.createElement(l,{is:u.is}):p.createElement(l)}}i[Be]=a,i[Xe]=u;t:for(p=a.child;p!==null;){if(p.tag===5||p.tag===6)i.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===a)break t;for(;p.sibling===null;){if(p.return===null||p.return===a)break t;p=p.return}p.sibling.return=p.return,p=p.sibling}a.stateNode=i;t:switch(Oe(i,l,u),l){case"button":case"input":case"select":case"textarea":i=!!u.autoFocus;break t;case"img":i=!0;break t;default:i=!1}i&&di(a)}}return te(a),a.flags&=-16777217,null;case 6:if(i&&a.stateNode!=null)i.memoizedProps!==u&&di(a);else{if(typeof u!="string"&&a.stateNode===null)throw Error(n(166));if(i=Q.current,Ar(a)){if(i=a.stateNode,l=a.memoizedProps,u=null,p=ze,p!==null)switch(p.tag){case 27:case 5:u=p.memoizedProps}i[Be]=a,i=!!(i.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||oy(i.nodeValue,l)),i||ms(a)}else i=Ql(i).createTextNode(u),i[Be]=a,a.stateNode=i}return te(a),null;case 13:if(u=a.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=Ar(a),u!==null&&u.dehydrated!==null){if(i===null){if(!p)throw Error(n(318));if(p=a.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));p[Be]=a}else Sr(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;te(a),p=!1}else p=Yg(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return a.flags&256?(ui(a),a):(ui(a),null)}if(ui(a),(a.flags&128)!==0)return a.lanes=l,a;if(l=u!==null,i=i!==null&&i.memoizedState!==null,l){u=a.child,p=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(p=u.alternate.memoizedState.cachePool.pool);var m=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==p&&(u.flags|=2048)}return l!==i&&l&&(a.child.flags|=8192),Fl(a,a.updateQueue),te(a),null;case 4:return Ut(),i===null&&ud(a.stateNode.containerInfo),te(a),null;case 10:return li(a.type),te(a),null;case 19:if(J(ye),p=a.memoizedState,p===null)return te(a),null;if(u=(a.flags&128)!==0,m=p.rendering,m===null)if(u)Fr(p,!1);else{if(ae!==0||i!==null&&(i.flags&128)!==0)for(i=a.child;i!==null;){if(m=kl(i),m!==null){for(a.flags|=128,Fr(p,!1),i=m.updateQueue,a.updateQueue=i,Fl(a,i),a.subtreeFlags=0,i=l,l=a.child;l!==null;)jg(l,i),l=l.sibling;return N(ye,ye.current&1|2),a.child}i=i.sibling}p.tail!==null&&Bn()>Ul&&(a.flags|=128,u=!0,Fr(p,!1),a.lanes=4194304)}else{if(!u)if(i=kl(m),i!==null){if(a.flags|=128,u=!0,i=i.updateQueue,a.updateQueue=i,Fl(a,i),Fr(p,!0),p.tail===null&&p.tailMode==="hidden"&&!m.alternate&&!Pt)return te(a),null}else 2*Bn()-p.renderingStartTime>Ul&&l!==536870912&&(a.flags|=128,u=!0,Fr(p,!1),a.lanes=4194304);p.isBackwards?(m.sibling=a.child,a.child=m):(i=p.last,i!==null?i.sibling=m:a.child=m,p.last=m)}return p.tail!==null?(a=p.tail,p.rendering=a,p.tail=a.sibling,p.renderingStartTime=Bn(),a.sibling=null,i=ye.current,N(ye,u?i&1|2:i&1),a):(te(a),null);case 22:case 23:return ui(a),dh(),u=a.memoizedState!==null,i!==null?i.memoizedState!==null!==u&&(a.flags|=8192):u&&(a.flags|=8192),u?(l&536870912)!==0&&(a.flags&128)===0&&(te(a),a.subtreeFlags&6&&(a.flags|=8192)):te(a),l=a.updateQueue,l!==null&&Fl(a,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),u=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(u=a.memoizedState.cachePool.pool),u!==l&&(a.flags|=2048),i!==null&&J(bs),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),li(_e),te(a),null;case 25:return null;case 30:return null}throw Error(n(156,a.tag))}function jS(i,a){switch(Zu(a),a.tag){case 1:return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 3:return li(_e),Ut(),i=a.flags,(i&65536)!==0&&(i&128)===0?(a.flags=i&-65537|128,a):null;case 26:case 27:case 5:return De(a),null;case 13:if(ui(a),i=a.memoizedState,i!==null&&i.dehydrated!==null){if(a.alternate===null)throw Error(n(340));Sr()}return i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 19:return J(ye),null;case 4:return Ut(),null;case 10:return li(a.type),null;case 22:case 23:return ui(a),dh(),i!==null&&J(bs),i=a.flags,i&65536?(a.flags=i&-65537|128,a):null;case 24:return li(_e),null;case 25:return null;default:return null}}function g_(i,a){switch(Zu(a),a.tag){case 3:li(_e),Ut();break;case 26:case 27:case 5:De(a);break;case 4:Ut();break;case 13:ui(a);break;case 19:J(ye);break;case 10:li(a.type);break;case 22:case 23:ui(a),dh(),i!==null&&J(bs);break;case 24:li(_e)}}function Hr(i,a){try{var l=a.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var p=u.next;l=p;do{if((l.tag&i)===i){u=void 0;var m=l.create,v=l.inst;u=m(),v.destroy=u}l=l.next}while(l!==p)}}catch(E){Yt(a,a.return,E)}}function Li(i,a,l){try{var u=a.updateQueue,p=u!==null?u.lastEffect:null;if(p!==null){var m=p.next;u=m;do{if((u.tag&i)===i){var v=u.inst,E=v.destroy;if(E!==void 0){v.destroy=void 0,p=a;var T=l,F=E;try{F()}catch(V){Yt(p,T,V)}}}u=u.next}while(u!==m)}}catch(V){Yt(a,a.return,V)}}function m_(i){var a=i.updateQueue;if(a!==null){var l=i.stateNode;try{im(a,l)}catch(u){Yt(i,i.return,u)}}}function __(i,a,l){l.props=As(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(u){Yt(i,a,u)}}function zr(i,a){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var u=i.stateNode;break;case 30:u=i.stateNode;break;default:u=i.stateNode}typeof l=="function"?i.refCleanup=l(u):l.current=u}}catch(p){Yt(i,a,p)}}function zn(i,a){var l=i.ref,u=i.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(p){Yt(i,a,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){Yt(i,a,p)}else l.current=null}function y_(i){var a=i.type,l=i.memoizedProps,u=i.stateNode;try{t:switch(a){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break t;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(p){Yt(i,i.return,p)}}function zh(i,a,l){try{var u=i.stateNode;cE(u,i.type,l,a),u[Xe]=a}catch(p){Yt(i,i.return,p)}}function b_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&ji(i.type)||i.tag===4}function Uh(i){t:for(;;){for(;i.sibling===null;){if(i.return===null||b_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&ji(i.type)||i.flags&2||i.child===null||i.tag===4)continue t;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function jh(i,a,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,a?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,a):(a=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,a.appendChild(i),l=l._reactRootContainer,l!=null||a.onclick!==null||(a.onclick=Kl));else if(u!==4&&(u===27&&ji(i.type)&&(l=i.stateNode,a=null),i=i.child,i!==null))for(jh(i,a,l),i=i.sibling;i!==null;)jh(i,a,l),i=i.sibling}function Hl(i,a,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,a?l.insertBefore(i,a):l.appendChild(i);else if(u!==4&&(u===27&&ji(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(Hl(i,a,l),i=i.sibling;i!==null;)Hl(i,a,l),i=i.sibling}function v_(i){var a=i.stateNode,l=i.memoizedProps;try{for(var u=i.type,p=a.attributes;p.length;)a.removeAttributeNode(p[0]);Oe(a,u,l),a[Be]=i,a[Xe]=l}catch(m){Yt(i,i.return,m)}}var fi=!1,oe=!1,Gh=!1,A_=typeof WeakSet=="function"?WeakSet:Set,Ae=null;function GS(i,a){if(i=i.containerInfo,fd=ic,i=Og(i),Uu(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else t:{l=(l=i.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var p=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{l.nodeType,m.nodeType}catch{l=null;break t}var v=0,E=-1,T=-1,F=0,V=0,W=i,H=null;e:for(;;){for(var z;W!==l||p!==0&&W.nodeType!==3||(E=v+p),W!==m||u!==0&&W.nodeType!==3||(T=v+u),W.nodeType===3&&(v+=W.nodeValue.length),(z=W.firstChild)!==null;)H=W,W=z;for(;;){if(W===i)break e;if(H===l&&++F===p&&(E=v),H===m&&++V===u&&(T=v),(z=W.nextSibling)!==null)break;W=H,H=W.parentNode}W=z}l=E===-1||T===-1?null:{start:E,end:T}}else l=null}l=l||{start:0,end:0}}else l=null;for(pd={focusedElem:i,selectionRange:l},ic=!1,Ae=a;Ae!==null;)if(a=Ae,i=a.child,(a.subtreeFlags&1024)!==0&&i!==null)i.return=a,Ae=i;else for(;Ae!==null;){switch(a=Ae,m=a.alternate,i=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&m!==null){i=void 0,l=a,p=m.memoizedProps,m=m.memoizedState,u=l.stateNode;try{var _t=As(l.type,p,l.elementType===l.type);i=u.getSnapshotBeforeUpdate(_t,m),u.__reactInternalSnapshotBeforeUpdate=i}catch(ft){Yt(l,l.return,ft)}}break;case 3:if((i&1024)!==0){if(i=a.stateNode.containerInfo,l=i.nodeType,l===9)_d(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":_d(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=a.sibling,i!==null){i.return=a.return,Ae=i;break}Ae=a.return}}function S_(i,a,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ii(i,l),u&4&&Hr(5,l);break;case 1:if(Ii(i,l),u&4)if(i=l.stateNode,a===null)try{i.componentDidMount()}catch(v){Yt(l,l.return,v)}else{var p=As(l.type,a.memoizedProps);a=a.memoizedState;try{i.componentDidUpdate(p,a,i.__reactInternalSnapshotBeforeUpdate)}catch(v){Yt(l,l.return,v)}}u&64&&m_(l),u&512&&zr(l,l.return);break;case 3:if(Ii(i,l),u&64&&(i=l.updateQueue,i!==null)){if(a=null,l.child!==null)switch(l.child.tag){case 27:case 5:a=l.child.stateNode;break;case 1:a=l.child.stateNode}try{im(i,a)}catch(v){Yt(l,l.return,v)}}break;case 27:a===null&&u&4&&v_(l);case 26:case 5:Ii(i,l),a===null&&u&4&&y_(l),u&512&&zr(l,l.return);break;case 12:Ii(i,l);break;case 13:Ii(i,l),u&4&&C_(i,l),u&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=ZS.bind(null,l),mE(i,l))));break;case 22:if(u=l.memoizedState!==null||fi,!u){a=a!==null&&a.memoizedState!==null||oe,p=fi;var m=oe;fi=u,(oe=a)&&!m?Pi(i,l,(l.subtreeFlags&8772)!==0):Ii(i,l),fi=p,oe=m}break;case 30:break;default:Ii(i,l)}}function E_(i){var a=i.alternate;a!==null&&(i.alternate=null,E_(a)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(a=i.stateNode,a!==null&&Su(a)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Qt=null,Ke=!1;function pi(i,a,l){for(l=l.child;l!==null;)w_(i,a,l),l=l.sibling}function w_(i,a,l){if(sn&&typeof sn.onCommitFiberUnmount=="function")try{sn.onCommitFiberUnmount(or,l)}catch{}switch(l.tag){case 26:oe||zn(l,a),pi(i,a,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:oe||zn(l,a);var u=Qt,p=Ke;ji(l.type)&&(Qt=l.stateNode,Ke=!1),pi(i,a,l),Wr(l.stateNode),Qt=u,Ke=p;break;case 5:oe||zn(l,a);case 6:if(u=Qt,p=Ke,Qt=null,pi(i,a,l),Qt=u,Ke=p,Qt!==null)if(Ke)try{(Qt.nodeType===9?Qt.body:Qt.nodeName==="HTML"?Qt.ownerDocument.body:Qt).removeChild(l.stateNode)}catch(m){Yt(l,a,m)}else try{Qt.removeChild(l.stateNode)}catch(m){Yt(l,a,m)}break;case 18:Qt!==null&&(Ke?(i=Qt,dy(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),io(i)):dy(Qt,l.stateNode));break;case 4:u=Qt,p=Ke,Qt=l.stateNode.containerInfo,Ke=!0,pi(i,a,l),Qt=u,Ke=p;break;case 0:case 11:case 14:case 15:oe||Li(2,l,a),oe||Li(4,l,a),pi(i,a,l);break;case 1:oe||(zn(l,a),u=l.stateNode,typeof u.componentWillUnmount=="function"&&__(l,a,u)),pi(i,a,l);break;case 21:pi(i,a,l);break;case 22:oe=(u=oe)||l.memoizedState!==null,pi(i,a,l),oe=u;break;default:pi(i,a,l)}}function C_(i,a){if(a.memoizedState===null&&(i=a.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{io(i)}catch(l){Yt(a,a.return,l)}}function qS(i){switch(i.tag){case 13:case 19:var a=i.stateNode;return a===null&&(a=i.stateNode=new A_),a;case 22:return i=i.stateNode,a=i._retryCache,a===null&&(a=i._retryCache=new A_),a;default:throw Error(n(435,i.tag))}}function qh(i,a){var l=qS(i);a.forEach(function(u){var p=JS.bind(null,i,u);l.has(u)||(l.add(u),u.then(p,p))})}function ln(i,a){var l=a.deletions;if(l!==null)for(var u=0;u<l.length;u++){var p=l[u],m=i,v=a,E=v;t:for(;E!==null;){switch(E.tag){case 27:if(ji(E.type)){Qt=E.stateNode,Ke=!1;break t}break;case 5:Qt=E.stateNode,Ke=!1;break t;case 3:case 4:Qt=E.stateNode.containerInfo,Ke=!0;break t}E=E.return}if(Qt===null)throw Error(n(160));w_(m,v,p),Qt=null,Ke=!1,m=p.alternate,m!==null&&(m.return=null),p.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)T_(a,i),a=a.sibling}var Mn=null;function T_(i,a){var l=i.alternate,u=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:ln(a,i),cn(i),u&4&&(Li(3,i,i.return),Hr(3,i),Li(5,i,i.return));break;case 1:ln(a,i),cn(i),u&512&&(oe||l===null||zn(l,l.return)),u&64&&fi&&(i=i.updateQueue,i!==null&&(u=i.callbacks,u!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var p=Mn;if(ln(a,i),cn(i),u&512&&(oe||l===null||zn(l,l.return)),u&4){var m=l!==null?l.memoizedState:null;if(u=i.memoizedState,l===null)if(u===null)if(i.stateNode===null){t:{u=i.type,l=i.memoizedProps,p=p.ownerDocument||p;e:switch(u){case"title":m=p.getElementsByTagName("title")[0],(!m||m[ur]||m[Be]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=p.createElement(u),p.head.insertBefore(m,p.querySelector("head > title"))),Oe(m,u,l),m[Be]=i,be(m),u=m;break t;case"link":var v=vy("link","href",p).get(u+(l.href||""));if(v){for(var E=0;E<v.length;E++)if(m=v[E],m.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&m.getAttribute("rel")===(l.rel==null?null:l.rel)&&m.getAttribute("title")===(l.title==null?null:l.title)&&m.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){v.splice(E,1);break e}}m=p.createElement(u),Oe(m,u,l),p.head.appendChild(m);break;case"meta":if(v=vy("meta","content",p).get(u+(l.content||""))){for(E=0;E<v.length;E++)if(m=v[E],m.getAttribute("content")===(l.content==null?null:""+l.content)&&m.getAttribute("name")===(l.name==null?null:l.name)&&m.getAttribute("property")===(l.property==null?null:l.property)&&m.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&m.getAttribute("charset")===(l.charSet==null?null:l.charSet)){v.splice(E,1);break e}}m=p.createElement(u),Oe(m,u,l),p.head.appendChild(m);break;default:throw Error(n(468,u))}m[Be]=i,be(m),u=m}i.stateNode=u}else Ay(p,i.type,i.stateNode);else i.stateNode=by(p,u,i.memoizedProps);else m!==u?(m===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):m.count--,u===null?Ay(p,i.type,i.stateNode):by(p,u,i.memoizedProps)):u===null&&i.stateNode!==null&&zh(i,i.memoizedProps,l.memoizedProps)}break;case 27:ln(a,i),cn(i),u&512&&(oe||l===null||zn(l,l.return)),l!==null&&u&4&&zh(i,i.memoizedProps,l.memoizedProps);break;case 5:if(ln(a,i),cn(i),u&512&&(oe||l===null||zn(l,l.return)),i.flags&32){p=i.stateNode;try{Zs(p,"")}catch(z){Yt(i,i.return,z)}}u&4&&i.stateNode!=null&&(p=i.memoizedProps,zh(i,p,l!==null?l.memoizedProps:p)),u&1024&&(Gh=!0);break;case 6:if(ln(a,i),cn(i),u&4){if(i.stateNode===null)throw Error(n(162));u=i.memoizedProps,l=i.stateNode;try{l.nodeValue=u}catch(z){Yt(i,i.return,z)}}break;case 3:if(tc=null,p=Mn,Mn=Zl(a.containerInfo),ln(a,i),Mn=p,cn(i),u&4&&l!==null&&l.memoizedState.isDehydrated)try{io(a.containerInfo)}catch(z){Yt(i,i.return,z)}Gh&&(Gh=!1,x_(i));break;case 4:u=Mn,Mn=Zl(i.stateNode.containerInfo),ln(a,i),cn(i),Mn=u;break;case 12:ln(a,i),cn(i);break;case 13:ln(a,i),cn(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Kh=Bn()),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,qh(i,u)));break;case 22:p=i.memoizedState!==null;var T=l!==null&&l.memoizedState!==null,F=fi,V=oe;if(fi=F||p,oe=V||T,ln(a,i),oe=V,fi=F,cn(i),u&8192)t:for(a=i.stateNode,a._visibility=p?a._visibility&-2:a._visibility|1,p&&(l===null||T||fi||oe||Ss(i)),l=null,a=i;;){if(a.tag===5||a.tag===26){if(l===null){T=l=a;try{if(m=T.stateNode,p)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{E=T.stateNode;var W=T.memoizedProps.style,H=W!=null&&W.hasOwnProperty("display")?W.display:null;E.style.display=H==null||typeof H=="boolean"?"":(""+H).trim()}}catch(z){Yt(T,T.return,z)}}}else if(a.tag===6){if(l===null){T=a;try{T.stateNode.nodeValue=p?"":T.memoizedProps}catch(z){Yt(T,T.return,z)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===i)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break t;for(;a.sibling===null;){if(a.return===null||a.return===i)break t;l===a&&(l=null),a=a.return}l===a&&(l=null),a.sibling.return=a.return,a=a.sibling}u&4&&(u=i.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,qh(i,l))));break;case 19:ln(a,i),cn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,qh(i,u)));break;case 30:break;case 21:break;default:ln(a,i),cn(i)}}function cn(i){var a=i.flags;if(a&2){try{for(var l,u=i.return;u!==null;){if(b_(u)){l=u;break}u=u.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var p=l.stateNode,m=Uh(i);Hl(i,m,p);break;case 5:var v=l.stateNode;l.flags&32&&(Zs(v,""),l.flags&=-33);var E=Uh(i);Hl(i,E,v);break;case 3:case 4:var T=l.stateNode.containerInfo,F=Uh(i);jh(i,F,T);break;default:throw Error(n(161))}}catch(V){Yt(i,i.return,V)}i.flags&=-3}a&4096&&(i.flags&=-4097)}function x_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var a=i;x_(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),i=i.sibling}}function Ii(i,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)S_(i,a.alternate,a),a=a.sibling}function Ss(i){for(i=i.child;i!==null;){var a=i;switch(a.tag){case 0:case 11:case 14:case 15:Li(4,a,a.return),Ss(a);break;case 1:zn(a,a.return);var l=a.stateNode;typeof l.componentWillUnmount=="function"&&__(a,a.return,l),Ss(a);break;case 27:Wr(a.stateNode);case 26:case 5:zn(a,a.return),Ss(a);break;case 22:a.memoizedState===null&&Ss(a);break;case 30:Ss(a);break;default:Ss(a)}i=i.sibling}}function Pi(i,a,l){for(l=l&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var u=a.alternate,p=i,m=a,v=m.flags;switch(m.tag){case 0:case 11:case 15:Pi(p,m,l),Hr(4,m);break;case 1:if(Pi(p,m,l),u=m,p=u.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(F){Yt(u,u.return,F)}if(u=m,p=u.updateQueue,p!==null){var E=u.stateNode;try{var T=p.shared.hiddenCallbacks;if(T!==null)for(p.shared.hiddenCallbacks=null,p=0;p<T.length;p++)nm(T[p],E)}catch(F){Yt(u,u.return,F)}}l&&v&64&&m_(m),zr(m,m.return);break;case 27:v_(m);case 26:case 5:Pi(p,m,l),l&&u===null&&v&4&&y_(m),zr(m,m.return);break;case 12:Pi(p,m,l);break;case 13:Pi(p,m,l),l&&v&4&&C_(p,m);break;case 22:m.memoizedState===null&&Pi(p,m,l),zr(m,m.return);break;case 30:break;default:Pi(p,m,l)}a=a.sibling}}function Vh(i,a){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(i=a.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&Cr(l))}function Yh(i,a){i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&Cr(i))}function Un(i,a,l,u){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)R_(i,a,l,u),a=a.sibling}function R_(i,a,l,u){var p=a.flags;switch(a.tag){case 0:case 11:case 15:Un(i,a,l,u),p&2048&&Hr(9,a);break;case 1:Un(i,a,l,u);break;case 3:Un(i,a,l,u),p&2048&&(i=null,a.alternate!==null&&(i=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==i&&(a.refCount++,i!=null&&Cr(i)));break;case 12:if(p&2048){Un(i,a,l,u),i=a.stateNode;try{var m=a.memoizedProps,v=m.id,E=m.onPostCommit;typeof E=="function"&&E(v,a.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(T){Yt(a,a.return,T)}}else Un(i,a,l,u);break;case 13:Un(i,a,l,u);break;case 23:break;case 22:m=a.stateNode,v=a.alternate,a.memoizedState!==null?m._visibility&2?Un(i,a,l,u):Ur(i,a):m._visibility&2?Un(i,a,l,u):(m._visibility|=2,_a(i,a,l,u,(a.subtreeFlags&10256)!==0)),p&2048&&Vh(v,a);break;case 24:Un(i,a,l,u),p&2048&&Yh(a.alternate,a);break;default:Un(i,a,l,u)}}function _a(i,a,l,u,p){for(p=p&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var m=i,v=a,E=l,T=u,F=v.flags;switch(v.tag){case 0:case 11:case 15:_a(m,v,E,T,p),Hr(8,v);break;case 23:break;case 22:var V=v.stateNode;v.memoizedState!==null?V._visibility&2?_a(m,v,E,T,p):Ur(m,v):(V._visibility|=2,_a(m,v,E,T,p)),p&&F&2048&&Vh(v.alternate,v);break;case 24:_a(m,v,E,T,p),p&&F&2048&&Yh(v.alternate,v);break;default:_a(m,v,E,T,p)}a=a.sibling}}function Ur(i,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var l=i,u=a,p=u.flags;switch(u.tag){case 22:Ur(l,u),p&2048&&Vh(u.alternate,u);break;case 24:Ur(l,u),p&2048&&Yh(u.alternate,u);break;default:Ur(l,u)}a=a.sibling}}var jr=8192;function ya(i){if(i.subtreeFlags&jr)for(i=i.child;i!==null;)D_(i),i=i.sibling}function D_(i){switch(i.tag){case 26:ya(i),i.flags&jr&&i.memoizedState!==null&&DE(Mn,i.memoizedState,i.memoizedProps);break;case 5:ya(i);break;case 3:case 4:var a=Mn;Mn=Zl(i.stateNode.containerInfo),ya(i),Mn=a;break;case 22:i.memoizedState===null&&(a=i.alternate,a!==null&&a.memoizedState!==null?(a=jr,jr=16777216,ya(i),jr=a):ya(i));break;default:ya(i)}}function M_(i){var a=i.alternate;if(a!==null&&(i=a.child,i!==null)){a.child=null;do a=i.sibling,i.sibling=null,i=a;while(i!==null)}}function Gr(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Ae=u,O_(u,i)}M_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)N_(i),i=i.sibling}function N_(i){switch(i.tag){case 0:case 11:case 15:Gr(i),i.flags&2048&&Li(9,i,i.return);break;case 3:Gr(i);break;case 12:Gr(i);break;case 22:var a=i.stateNode;i.memoizedState!==null&&a._visibility&2&&(i.return===null||i.return.tag!==13)?(a._visibility&=-3,zl(i)):Gr(i);break;default:Gr(i)}}function zl(i){var a=i.deletions;if((i.flags&16)!==0){if(a!==null)for(var l=0;l<a.length;l++){var u=a[l];Ae=u,O_(u,i)}M_(i)}for(i=i.child;i!==null;){switch(a=i,a.tag){case 0:case 11:case 15:Li(8,a,a.return),zl(a);break;case 22:l=a.stateNode,l._visibility&2&&(l._visibility&=-3,zl(a));break;default:zl(a)}i=i.sibling}}function O_(i,a){for(;Ae!==null;){var l=Ae;switch(l.tag){case 0:case 11:case 15:Li(8,l,a);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Cr(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,Ae=u;else t:for(l=i;Ae!==null;){u=Ae;var p=u.sibling,m=u.return;if(E_(u),u===l){Ae=null;break t}if(p!==null){p.return=m,Ae=p;break t}Ae=m}}}var VS={getCacheForType:function(i){var a=Fe(_e),l=a.data.get(i);return l===void 0&&(l=i(),a.data.set(i,l)),l}},YS=typeof WeakMap=="function"?WeakMap:Map,Ft=0,$t=null,Nt=null,Lt=0,Ht=0,un=null,Bi=!1,ba=!1,Xh=!1,gi=0,ae=0,Fi=0,Es=0,$h=0,Sn=0,va=0,qr=null,Qe=null,Wh=!1,Kh=0,Ul=1/0,jl=null,Hi=null,Ne=0,zi=null,Aa=null,Sa=0,Qh=0,Zh=null,k_=null,Vr=0,Jh=null;function hn(){if((Ft&2)!==0&&Lt!==0)return Lt&-Lt;if(k.T!==null){var i=ca;return i!==0?i:rd()}return Wp()}function L_(){Sn===0&&(Sn=(Lt&536870912)===0||Pt?Vp():536870912);var i=An.current;return i!==null&&(i.flags|=32),Sn}function dn(i,a,l){(i===$t&&(Ht===2||Ht===9)||i.cancelPendingCommit!==null)&&(Ea(i,0),Ui(i,Lt,Sn,!1)),cr(i,l),((Ft&2)===0||i!==$t)&&(i===$t&&((Ft&2)===0&&(Es|=l),ae===4&&Ui(i,Lt,Sn,!1)),jn(i))}function I_(i,a,l){if((Ft&6)!==0)throw Error(n(327));var u=!l&&(a&124)===0&&(a&i.expiredLanes)===0||lr(i,a),p=u?WS(i,a):nd(i,a,!0),m=u;do{if(p===0){ba&&!u&&Ui(i,a,0,!1);break}else{if(l=i.current.alternate,m&&!XS(l)){p=nd(i,a,!1),m=!1;continue}if(p===2){if(m=a,i.errorRecoveryDisabledLanes&m)var v=0;else v=i.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){a=v;t:{var E=i;p=qr;var T=E.current.memoizedState.isDehydrated;if(T&&(Ea(E,v).flags|=256),v=nd(E,v,!1),v!==2){if(Xh&&!T){E.errorRecoveryDisabledLanes|=m,Es|=m,p=4;break t}m=Qe,Qe=p,m!==null&&(Qe===null?Qe=m:Qe.push.apply(Qe,m))}p=v}if(m=!1,p!==2)continue}}if(p===1){Ea(i,0),Ui(i,a,0,!0);break}t:{switch(u=i,m=p,m){case 0:case 1:throw Error(n(345));case 4:if((a&4194048)!==a)break;case 6:Ui(u,a,Sn,!Bi);break t;case 2:Qe=null;break;case 3:case 5:break;default:throw Error(n(329))}if((a&62914560)===a&&(p=Kh+300-Bn(),10<p)){if(Ui(u,a,Sn,!Bi),Jo(u,0,!0)!==0)break t;u.timeoutHandle=uy(P_.bind(null,u,l,Qe,jl,Wh,a,Sn,Es,va,Bi,m,2,-0,0),p);break t}P_(u,l,Qe,jl,Wh,a,Sn,Es,va,Bi,m,0,-0,0)}}break}while(!0);jn(i)}function P_(i,a,l,u,p,m,v,E,T,F,V,W,H,z){if(i.timeoutHandle=-1,W=a.subtreeFlags,(W&8192||(W&16785408)===16785408)&&(Zr={stylesheets:null,count:0,unsuspend:RE},D_(a),W=ME(),W!==null)){i.cancelPendingCommit=W(G_.bind(null,i,a,m,l,u,p,v,E,T,V,1,H,z)),Ui(i,m,v,!F);return}G_(i,a,m,l,u,p,v,E,T)}function XS(i){for(var a=i;;){var l=a.tag;if((l===0||l===11||l===15)&&a.flags&16384&&(l=a.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var p=l[u],m=p.getSnapshot;p=p.value;try{if(!rn(m(),p))return!1}catch{return!1}}if(l=a.child,a.subtreeFlags&16384&&l!==null)l.return=a,a=l;else{if(a===i)break;for(;a.sibling===null;){if(a.return===null||a.return===i)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ui(i,a,l,u){a&=~$h,a&=~Es,i.suspendedLanes|=a,i.pingedLanes&=~a,u&&(i.warmLanes|=a),u=i.expirationTimes;for(var p=a;0<p;){var m=31-an(p),v=1<<m;u[m]=-1,p&=~v}l!==0&&Xp(i,l,a)}function Gl(){return(Ft&6)===0?(Yr(0),!1):!0}function td(){if(Nt!==null){if(Ht===0)var i=Nt.return;else i=Nt,oi=_s=null,_h(i),ga=null,Pr=0,i=Nt;for(;i!==null;)g_(i.alternate,i),i=i.return;Nt=null}}function Ea(i,a){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,hE(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),td(),$t=i,Nt=l=si(i.current,null),Lt=a,Ht=0,un=null,Bi=!1,ba=lr(i,a),Xh=!1,va=Sn=$h=Es=Fi=ae=0,Qe=qr=null,Wh=!1,(a&8)!==0&&(a|=a&32);var u=i.entangledLanes;if(u!==0)for(i=i.entanglements,u&=a;0<u;){var p=31-an(u),m=1<<p;a|=i[p],u&=~m}return gi=a,hl(),l}function B_(i,a){Ct=null,k.H=Ml,a===xr||a===vl?(a=tm(),Ht=3):a===Qg?(a=tm(),Ht=4):Ht=a===e_?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,un=a,Nt===null&&(ae=1,Il(i,_n(a,i.current)))}function F_(){var i=k.H;return k.H=Ml,i===null?Ml:i}function H_(){var i=k.A;return k.A=VS,i}function ed(){ae=4,Bi||(Lt&4194048)!==Lt&&An.current!==null||(ba=!0),(Fi&134217727)===0&&(Es&134217727)===0||$t===null||Ui($t,Lt,Sn,!1)}function nd(i,a,l){var u=Ft;Ft|=2;var p=F_(),m=H_();($t!==i||Lt!==a)&&(jl=null,Ea(i,a)),a=!1;var v=ae;t:do try{if(Ht!==0&&Nt!==null){var E=Nt,T=un;switch(Ht){case 8:td(),v=6;break t;case 3:case 2:case 9:case 6:An.current===null&&(a=!0);var F=Ht;if(Ht=0,un=null,wa(i,E,T,F),l&&ba){v=0;break t}break;default:F=Ht,Ht=0,un=null,wa(i,E,T,F)}}$S(),v=ae;break}catch(V){B_(i,V)}while(!0);return a&&i.shellSuspendCounter++,oi=_s=null,Ft=u,k.H=p,k.A=m,Nt===null&&($t=null,Lt=0,hl()),v}function $S(){for(;Nt!==null;)z_(Nt)}function WS(i,a){var l=Ft;Ft|=2;var u=F_(),p=H_();$t!==i||Lt!==a?(jl=null,Ul=Bn()+500,Ea(i,a)):ba=lr(i,a);t:do try{if(Ht!==0&&Nt!==null){a=Nt;var m=un;e:switch(Ht){case 1:Ht=0,un=null,wa(i,a,m,1);break;case 2:case 9:if(Zg(m)){Ht=0,un=null,U_(a);break}a=function(){Ht!==2&&Ht!==9||$t!==i||(Ht=7),jn(i)},m.then(a,a);break t;case 3:Ht=7;break t;case 4:Ht=5;break t;case 7:Zg(m)?(Ht=0,un=null,U_(a)):(Ht=0,un=null,wa(i,a,m,7));break;case 5:var v=null;switch(Nt.tag){case 26:v=Nt.memoizedState;case 5:case 27:var E=Nt;if(!v||Sy(v)){Ht=0,un=null;var T=E.sibling;if(T!==null)Nt=T;else{var F=E.return;F!==null?(Nt=F,ql(F)):Nt=null}break e}}Ht=0,un=null,wa(i,a,m,5);break;case 6:Ht=0,un=null,wa(i,a,m,6);break;case 8:td(),ae=6;break t;default:throw Error(n(462))}}KS();break}catch(V){B_(i,V)}while(!0);return oi=_s=null,k.H=u,k.A=p,Ft=l,Nt!==null?0:($t=null,Lt=0,hl(),ae)}function KS(){for(;Nt!==null&&!yA();)z_(Nt)}function z_(i){var a=f_(i.alternate,i,gi);i.memoizedProps=i.pendingProps,a===null?ql(i):Nt=a}function U_(i){var a=i,l=a.alternate;switch(a.tag){case 15:case 0:a=o_(l,a,a.pendingProps,a.type,void 0,Lt);break;case 11:a=o_(l,a,a.pendingProps,a.type.render,a.ref,Lt);break;case 5:_h(a);default:g_(l,a),a=Nt=jg(a,gi),a=f_(l,a,gi)}i.memoizedProps=i.pendingProps,a===null?ql(i):Nt=a}function wa(i,a,l,u){oi=_s=null,_h(a),ga=null,Pr=0;var p=a.return;try{if(HS(i,p,a,l,Lt)){ae=1,Il(i,_n(l,i.current)),Nt=null;return}}catch(m){if(p!==null)throw Nt=p,m;ae=1,Il(i,_n(l,i.current)),Nt=null;return}a.flags&32768?(Pt||u===1?i=!0:ba||(Lt&536870912)!==0?i=!1:(Bi=i=!0,(u===2||u===9||u===3||u===6)&&(u=An.current,u!==null&&u.tag===13&&(u.flags|=16384))),j_(a,i)):ql(a)}function ql(i){var a=i;do{if((a.flags&32768)!==0){j_(a,Bi);return}i=a.return;var l=US(a.alternate,a,gi);if(l!==null){Nt=l;return}if(a=a.sibling,a!==null){Nt=a;return}Nt=a=i}while(a!==null);ae===0&&(ae=5)}function j_(i,a){do{var l=jS(i.alternate,i);if(l!==null){l.flags&=32767,Nt=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!a&&(i=i.sibling,i!==null)){Nt=i;return}Nt=i=l}while(i!==null);ae=6,Nt=null}function G_(i,a,l,u,p,m,v,E,T){i.cancelPendingCommit=null;do Vl();while(Ne!==0);if((Ft&6)!==0)throw Error(n(327));if(a!==null){if(a===i.current)throw Error(n(177));if(m=a.lanes|a.childLanes,m|=Yu,RA(i,l,m,v,E,T),i===$t&&(Nt=$t=null,Lt=0),Aa=a,zi=i,Sa=l,Qh=m,Zh=p,k_=u,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,tE(Ko,function(){return $_(),null})):(i.callbackNode=null,i.callbackPriority=0),u=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||u){u=k.T,k.T=null,p=U.p,U.p=2,v=Ft,Ft|=4;try{GS(i,a,l)}finally{Ft=v,U.p=p,k.T=u}}Ne=1,q_(),V_(),Y_()}}function q_(){if(Ne===1){Ne=0;var i=zi,a=Aa,l=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||l){l=k.T,k.T=null;var u=U.p;U.p=2;var p=Ft;Ft|=4;try{T_(a,i);var m=pd,v=Og(i.containerInfo),E=m.focusedElem,T=m.selectionRange;if(v!==E&&E&&E.ownerDocument&&Ng(E.ownerDocument.documentElement,E)){if(T!==null&&Uu(E)){var F=T.start,V=T.end;if(V===void 0&&(V=F),"selectionStart"in E)E.selectionStart=F,E.selectionEnd=Math.min(V,E.value.length);else{var W=E.ownerDocument||document,H=W&&W.defaultView||window;if(H.getSelection){var z=H.getSelection(),_t=E.textContent.length,ft=Math.min(T.start,_t),qt=T.end===void 0?ft:Math.min(T.end,_t);!z.extend&&ft>qt&&(v=qt,qt=ft,ft=v);var L=Mg(E,ft),M=Mg(E,qt);if(L&&M&&(z.rangeCount!==1||z.anchorNode!==L.node||z.anchorOffset!==L.offset||z.focusNode!==M.node||z.focusOffset!==M.offset)){var B=W.createRange();B.setStart(L.node,L.offset),z.removeAllRanges(),ft>qt?(z.addRange(B),z.extend(M.node,M.offset)):(B.setEnd(M.node,M.offset),z.addRange(B))}}}}for(W=[],z=E;z=z.parentNode;)z.nodeType===1&&W.push({element:z,left:z.scrollLeft,top:z.scrollTop});for(typeof E.focus=="function"&&E.focus(),E=0;E<W.length;E++){var X=W[E];X.element.scrollLeft=X.left,X.element.scrollTop=X.top}}ic=!!fd,pd=fd=null}finally{Ft=p,U.p=u,k.T=l}}i.current=a,Ne=2}}function V_(){if(Ne===2){Ne=0;var i=zi,a=Aa,l=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||l){l=k.T,k.T=null;var u=U.p;U.p=2;var p=Ft;Ft|=4;try{S_(i,a.alternate,a)}finally{Ft=p,U.p=u,k.T=l}}Ne=3}}function Y_(){if(Ne===4||Ne===3){Ne=0,bA();var i=zi,a=Aa,l=Sa,u=k_;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Ne=5:(Ne=0,Aa=zi=null,X_(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(Hi=null),vu(l),a=a.stateNode,sn&&typeof sn.onCommitFiberRoot=="function")try{sn.onCommitFiberRoot(or,a,void 0,(a.current.flags&128)===128)}catch{}if(u!==null){a=k.T,p=U.p,U.p=2,k.T=null;try{for(var m=i.onRecoverableError,v=0;v<u.length;v++){var E=u[v];m(E.value,{componentStack:E.stack})}}finally{k.T=a,U.p=p}}(Sa&3)!==0&&Vl(),jn(i),p=i.pendingLanes,(l&4194090)!==0&&(p&42)!==0?i===Jh?Vr++:(Vr=0,Jh=i):Vr=0,Yr(0)}}function X_(i,a){(i.pooledCacheLanes&=a)===0&&(a=i.pooledCache,a!=null&&(i.pooledCache=null,Cr(a)))}function Vl(i){return q_(),V_(),Y_(),$_()}function $_(){if(Ne!==5)return!1;var i=zi,a=Qh;Qh=0;var l=vu(Sa),u=k.T,p=U.p;try{U.p=32>l?32:l,k.T=null,l=Zh,Zh=null;var m=zi,v=Sa;if(Ne=0,Aa=zi=null,Sa=0,(Ft&6)!==0)throw Error(n(331));var E=Ft;if(Ft|=4,N_(m.current),R_(m,m.current,v,l),Ft=E,Yr(0,!1),sn&&typeof sn.onPostCommitFiberRoot=="function")try{sn.onPostCommitFiberRoot(or,m)}catch{}return!0}finally{U.p=p,k.T=u,X_(i,a)}}function W_(i,a,l){a=_n(l,a),a=Nh(i.stateNode,a,2),i=Mi(i,a,2),i!==null&&(cr(i,2),jn(i))}function Yt(i,a,l){if(i.tag===3)W_(i,i,l);else for(;a!==null;){if(a.tag===3){W_(a,i,l);break}else if(a.tag===1){var u=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Hi===null||!Hi.has(u))){i=_n(l,i),l=Jm(2),u=Mi(a,l,2),u!==null&&(t_(l,u,a,i),cr(u,2),jn(u));break}}a=a.return}}function id(i,a,l){var u=i.pingCache;if(u===null){u=i.pingCache=new YS;var p=new Set;u.set(a,p)}else p=u.get(a),p===void 0&&(p=new Set,u.set(a,p));p.has(l)||(Xh=!0,p.add(l),i=QS.bind(null,i,a,l),a.then(i,i))}function QS(i,a,l){var u=i.pingCache;u!==null&&u.delete(a),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,$t===i&&(Lt&l)===l&&(ae===4||ae===3&&(Lt&62914560)===Lt&&300>Bn()-Kh?(Ft&2)===0&&Ea(i,0):$h|=l,va===Lt&&(va=0)),jn(i)}function K_(i,a){a===0&&(a=Yp()),i=aa(i,a),i!==null&&(cr(i,a),jn(i))}function ZS(i){var a=i.memoizedState,l=0;a!==null&&(l=a.retryLane),K_(i,l)}function JS(i,a){var l=0;switch(i.tag){case 13:var u=i.stateNode,p=i.memoizedState;p!==null&&(l=p.retryLane);break;case 19:u=i.stateNode;break;case 22:u=i.stateNode._retryCache;break;default:throw Error(n(314))}u!==null&&u.delete(a),K_(i,l)}function tE(i,a){return qs(i,a)}var Yl=null,Ca=null,sd=!1,Xl=!1,ad=!1,ws=0;function jn(i){i!==Ca&&i.next===null&&(Ca===null?Yl=Ca=i:Ca=Ca.next=i),Xl=!0,sd||(sd=!0,nE())}function Yr(i,a){if(!ad&&Xl){ad=!0;do for(var l=!1,u=Yl;u!==null;){if(i!==0){var p=u.pendingLanes;if(p===0)var m=0;else{var v=u.suspendedLanes,E=u.pingedLanes;m=(1<<31-an(42|i)+1)-1,m&=p&~(v&~E),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(l=!0,ty(u,m))}else m=Lt,m=Jo(u,u===$t?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(m&3)===0||lr(u,m)||(l=!0,ty(u,m));u=u.next}while(l);ad=!1}}function eE(){Q_()}function Q_(){Xl=sd=!1;var i=0;ws!==0&&(uE()&&(i=ws),ws=0);for(var a=Bn(),l=null,u=Yl;u!==null;){var p=u.next,m=Z_(u,a);m===0?(u.next=null,l===null?Yl=p:l.next=p,p===null&&(Ca=l)):(l=u,(i!==0||(m&3)!==0)&&(Xl=!0)),u=p}Yr(i)}function Z_(i,a){for(var l=i.suspendedLanes,u=i.pingedLanes,p=i.expirationTimes,m=i.pendingLanes&-62914561;0<m;){var v=31-an(m),E=1<<v,T=p[v];T===-1?((E&l)===0||(E&u)!==0)&&(p[v]=xA(E,a)):T<=a&&(i.expiredLanes|=E),m&=~E}if(a=$t,l=Lt,l=Jo(i,i===a?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u=i.callbackNode,l===0||i===a&&(Ht===2||Ht===9)||i.cancelPendingCommit!==null)return u!==null&&u!==null&&rr(u),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||lr(i,l)){if(a=l&-l,a===i.callbackPriority)return a;switch(u!==null&&rr(u),vu(l)){case 2:case 8:l=Gp;break;case 32:l=Ko;break;case 268435456:l=qp;break;default:l=Ko}return u=J_.bind(null,i),l=qs(l,u),i.callbackPriority=a,i.callbackNode=l,a}return u!==null&&u!==null&&rr(u),i.callbackPriority=2,i.callbackNode=null,2}function J_(i,a){if(Ne!==0&&Ne!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(Vl()&&i.callbackNode!==l)return null;var u=Lt;return u=Jo(i,i===$t?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u===0?null:(I_(i,u,a),Z_(i,Bn()),i.callbackNode!=null&&i.callbackNode===l?J_.bind(null,i):null)}function ty(i,a){if(Vl())return null;I_(i,a,!0)}function nE(){dE(function(){(Ft&6)!==0?qs(jp,eE):Q_()})}function rd(){return ws===0&&(ws=Vp()),ws}function ey(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:sl(""+i)}function ny(i,a){var l=a.ownerDocument.createElement("input");return l.name=a.name,l.value=a.value,i.id&&l.setAttribute("form",i.id),a.parentNode.insertBefore(l,a),i=new FormData(i),l.parentNode.removeChild(l),i}function iE(i,a,l,u,p){if(a==="submit"&&l&&l.stateNode===p){var m=ey((p[Xe]||null).action),v=u.submitter;v&&(a=(a=v[Xe]||null)?ey(a.formAction):v.getAttribute("formAction"),a!==null&&(m=a,v=null));var E=new ll("action","action",null,u,p);i.push({event:E,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(ws!==0){var T=v?ny(p,v):new FormData(p);Th(l,{pending:!0,data:T,method:p.method,action:m},null,T)}}else typeof m=="function"&&(E.preventDefault(),T=v?ny(p,v):new FormData(p),Th(l,{pending:!0,data:T,method:p.method,action:m},m,T))},currentTarget:p}]})}}for(var od=0;od<Vu.length;od++){var ld=Vu[od],sE=ld.toLowerCase(),aE=ld[0].toUpperCase()+ld.slice(1);Dn(sE,"on"+aE)}Dn(Ig,"onAnimationEnd"),Dn(Pg,"onAnimationIteration"),Dn(Bg,"onAnimationStart"),Dn("dblclick","onDoubleClick"),Dn("focusin","onFocus"),Dn("focusout","onBlur"),Dn(SS,"onTransitionRun"),Dn(ES,"onTransitionStart"),Dn(wS,"onTransitionCancel"),Dn(Fg,"onTransitionEnd"),Ws("onMouseEnter",["mouseout","mouseover"]),Ws("onMouseLeave",["mouseout","mouseover"]),Ws("onPointerEnter",["pointerout","pointerover"]),Ws("onPointerLeave",["pointerout","pointerover"]),ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ls("onBeforeInput",["compositionend","keypress","textInput","paste"]),ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xr));function iy(i,a){a=(a&4)!==0;for(var l=0;l<i.length;l++){var u=i[l],p=u.event;u=u.listeners;t:{var m=void 0;if(a)for(var v=u.length-1;0<=v;v--){var E=u[v],T=E.instance,F=E.currentTarget;if(E=E.listener,T!==m&&p.isPropagationStopped())break t;m=E,p.currentTarget=F;try{m(p)}catch(V){Ll(V)}p.currentTarget=null,m=T}else for(v=0;v<u.length;v++){if(E=u[v],T=E.instance,F=E.currentTarget,E=E.listener,T!==m&&p.isPropagationStopped())break t;m=E,p.currentTarget=F;try{m(p)}catch(V){Ll(V)}p.currentTarget=null,m=T}}}}function Ot(i,a){var l=a[Au];l===void 0&&(l=a[Au]=new Set);var u=i+"__bubble";l.has(u)||(sy(a,i,2,!1),l.add(u))}function cd(i,a,l){var u=0;a&&(u|=4),sy(l,i,u,a)}var $l="_reactListening"+Math.random().toString(36).slice(2);function ud(i){if(!i[$l]){i[$l]=!0,Qp.forEach(function(l){l!=="selectionchange"&&(rE.has(l)||cd(l,!1,i),cd(l,!0,i))});var a=i.nodeType===9?i:i.ownerDocument;a===null||a[$l]||(a[$l]=!0,cd("selectionchange",!1,a))}}function sy(i,a,l,u){switch(Ry(a)){case 2:var p=kE;break;case 8:p=LE;break;default:p=wd}l=p.bind(null,a,l,i),p=void 0,!Ou||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(p=!0),u?p!==void 0?i.addEventListener(a,l,{capture:!0,passive:p}):i.addEventListener(a,l,!0):p!==void 0?i.addEventListener(a,l,{passive:p}):i.addEventListener(a,l,!1)}function hd(i,a,l,u,p){var m=u;if((a&1)===0&&(a&2)===0&&u!==null)t:for(;;){if(u===null)return;var v=u.tag;if(v===3||v===4){var E=u.stateNode.containerInfo;if(E===p)break;if(v===4)for(v=u.return;v!==null;){var T=v.tag;if((T===3||T===4)&&v.stateNode.containerInfo===p)return;v=v.return}for(;E!==null;){if(v=Ys(E),v===null)return;if(T=v.tag,T===5||T===6||T===26||T===27){u=m=v;continue t}E=E.parentNode}}u=u.return}hg(function(){var F=m,V=Mu(l),W=[];t:{var H=Hg.get(i);if(H!==void 0){var z=ll,_t=i;switch(i){case"keypress":if(rl(l)===0)break t;case"keydown":case"keyup":z=tS;break;case"focusin":_t="focus",z=Pu;break;case"focusout":_t="blur",z=Pu;break;case"beforeblur":case"afterblur":z=Pu;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":z=pg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":z=jA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":z=iS;break;case Ig:case Pg:case Bg:z=VA;break;case Fg:z=aS;break;case"scroll":case"scrollend":z=zA;break;case"wheel":z=oS;break;case"copy":case"cut":case"paste":z=XA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":z=mg;break;case"toggle":case"beforetoggle":z=cS}var ft=(a&4)!==0,qt=!ft&&(i==="scroll"||i==="scrollend"),L=ft?H!==null?H+"Capture":null:H;ft=[];for(var M=F,B;M!==null;){var X=M;if(B=X.stateNode,X=X.tag,X!==5&&X!==26&&X!==27||B===null||L===null||(X=dr(M,L),X!=null&&ft.push($r(M,X,B))),qt)break;M=M.return}0<ft.length&&(H=new z(H,_t,null,l,V),W.push({event:H,listeners:ft}))}}if((a&7)===0){t:{if(H=i==="mouseover"||i==="pointerover",z=i==="mouseout"||i==="pointerout",H&&l!==Du&&(_t=l.relatedTarget||l.fromElement)&&(Ys(_t)||_t[Vs]))break t;if((z||H)&&(H=V.window===V?V:(H=V.ownerDocument)?H.defaultView||H.parentWindow:window,z?(_t=l.relatedTarget||l.toElement,z=F,_t=_t?Ys(_t):null,_t!==null&&(qt=o(_t),ft=_t.tag,_t!==qt||ft!==5&&ft!==27&&ft!==6)&&(_t=null)):(z=null,_t=F),z!==_t)){if(ft=pg,X="onMouseLeave",L="onMouseEnter",M="mouse",(i==="pointerout"||i==="pointerover")&&(ft=mg,X="onPointerLeave",L="onPointerEnter",M="pointer"),qt=z==null?H:hr(z),B=_t==null?H:hr(_t),H=new ft(X,M+"leave",z,l,V),H.target=qt,H.relatedTarget=B,X=null,Ys(V)===F&&(ft=new ft(L,M+"enter",_t,l,V),ft.target=B,ft.relatedTarget=qt,X=ft),qt=X,z&&_t)e:{for(ft=z,L=_t,M=0,B=ft;B;B=Ta(B))M++;for(B=0,X=L;X;X=Ta(X))B++;for(;0<M-B;)ft=Ta(ft),M--;for(;0<B-M;)L=Ta(L),B--;for(;M--;){if(ft===L||L!==null&&ft===L.alternate)break e;ft=Ta(ft),L=Ta(L)}ft=null}else ft=null;z!==null&&ay(W,H,z,ft,!1),_t!==null&&qt!==null&&ay(W,qt,_t,ft,!0)}}t:{if(H=F?hr(F):window,z=H.nodeName&&H.nodeName.toLowerCase(),z==="select"||z==="input"&&H.type==="file")var lt=wg;else if(Sg(H))if(Cg)lt=bS;else{lt=_S;var xt=mS}else z=H.nodeName,!z||z.toLowerCase()!=="input"||H.type!=="checkbox"&&H.type!=="radio"?F&&Ru(F.elementType)&&(lt=wg):lt=yS;if(lt&&(lt=lt(i,F))){Eg(W,lt,l,V);break t}xt&&xt(i,H,F),i==="focusout"&&F&&H.type==="number"&&F.memoizedProps.value!=null&&xu(H,"number",H.value)}switch(xt=F?hr(F):window,i){case"focusin":(Sg(xt)||xt.contentEditable==="true")&&(na=xt,ju=F,vr=null);break;case"focusout":vr=ju=na=null;break;case"mousedown":Gu=!0;break;case"contextmenu":case"mouseup":case"dragend":Gu=!1,kg(W,l,V);break;case"selectionchange":if(AS)break;case"keydown":case"keyup":kg(W,l,V)}var ut;if(Fu)t:{switch(i){case"compositionstart":var gt="onCompositionStart";break t;case"compositionend":gt="onCompositionEnd";break t;case"compositionupdate":gt="onCompositionUpdate";break t}gt=void 0}else ea?vg(i,l)&&(gt="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(gt="onCompositionStart");gt&&(_g&&l.locale!=="ko"&&(ea||gt!=="onCompositionStart"?gt==="onCompositionEnd"&&ea&&(ut=dg()):(Ti=V,ku="value"in Ti?Ti.value:Ti.textContent,ea=!0)),xt=Wl(F,gt),0<xt.length&&(gt=new gg(gt,i,null,l,V),W.push({event:gt,listeners:xt}),ut?gt.data=ut:(ut=Ag(l),ut!==null&&(gt.data=ut)))),(ut=hS?dS(i,l):fS(i,l))&&(gt=Wl(F,"onBeforeInput"),0<gt.length&&(xt=new gg("onBeforeInput","beforeinput",null,l,V),W.push({event:xt,listeners:gt}),xt.data=ut)),iE(W,i,F,l,V)}iy(W,a)})}function $r(i,a,l){return{instance:i,listener:a,currentTarget:l}}function Wl(i,a){for(var l=a+"Capture",u=[];i!==null;){var p=i,m=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||m===null||(p=dr(i,l),p!=null&&u.unshift($r(i,p,m)),p=dr(i,a),p!=null&&u.push($r(i,p,m))),i.tag===3)return u;i=i.return}return[]}function Ta(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function ay(i,a,l,u,p){for(var m=a._reactName,v=[];l!==null&&l!==u;){var E=l,T=E.alternate,F=E.stateNode;if(E=E.tag,T!==null&&T===u)break;E!==5&&E!==26&&E!==27||F===null||(T=F,p?(F=dr(l,m),F!=null&&v.unshift($r(l,F,T))):p||(F=dr(l,m),F!=null&&v.push($r(l,F,T)))),l=l.return}v.length!==0&&i.push({event:a,listeners:v})}var oE=/\r\n?/g,lE=/\u0000|\uFFFD/g;function ry(i){return(typeof i=="string"?i:""+i).replace(oE,`
`).replace(lE,"")}function oy(i,a){return a=ry(a),ry(i)===a}function Kl(){}function Gt(i,a,l,u,p,m){switch(l){case"children":typeof u=="string"?a==="body"||a==="textarea"&&u===""||Zs(i,u):(typeof u=="number"||typeof u=="bigint")&&a!=="body"&&Zs(i,""+u);break;case"className":el(i,"class",u);break;case"tabIndex":el(i,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":el(i,l,u);break;case"style":cg(i,u,m);break;case"data":if(a!=="object"){el(i,"data",u);break}case"src":case"href":if(u===""&&(a!=="a"||l!=="href")){i.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=sl(""+u),i.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(l==="formAction"?(a!=="input"&&Gt(i,a,"name",p.name,p,null),Gt(i,a,"formEncType",p.formEncType,p,null),Gt(i,a,"formMethod",p.formMethod,p,null),Gt(i,a,"formTarget",p.formTarget,p,null)):(Gt(i,a,"encType",p.encType,p,null),Gt(i,a,"method",p.method,p,null),Gt(i,a,"target",p.target,p,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=sl(""+u),i.setAttribute(l,u);break;case"onClick":u!=null&&(i.onclick=Kl);break;case"onScroll":u!=null&&Ot("scroll",i);break;case"onScrollEnd":u!=null&&Ot("scrollend",i);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=l}}break;case"multiple":i.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":i.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){i.removeAttribute("xlink:href");break}l=sl(""+u),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""+u):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":u===!0?i.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,u):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?i.setAttribute(l,u):i.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?i.removeAttribute(l):i.setAttribute(l,u);break;case"popover":Ot("beforetoggle",i),Ot("toggle",i),tl(i,"popover",u);break;case"xlinkActuate":ni(i,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":ni(i,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":ni(i,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":ni(i,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":ni(i,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":ni(i,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":ni(i,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":ni(i,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":ni(i,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":tl(i,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=FA.get(l)||l,tl(i,l,u))}}function dd(i,a,l,u,p,m){switch(l){case"style":cg(i,u,m);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(n(61));if(l=u.__html,l!=null){if(p.children!=null)throw Error(n(60));i.innerHTML=l}}break;case"children":typeof u=="string"?Zs(i,u):(typeof u=="number"||typeof u=="bigint")&&Zs(i,""+u);break;case"onScroll":u!=null&&Ot("scroll",i);break;case"onScrollEnd":u!=null&&Ot("scrollend",i);break;case"onClick":u!=null&&(i.onclick=Kl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Zp.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),a=l.slice(2,p?l.length-7:void 0),m=i[Xe]||null,m=m!=null?m[l]:null,typeof m=="function"&&i.removeEventListener(a,m,p),typeof u=="function")){typeof m!="function"&&m!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(a,u,p);break t}l in i?i[l]=u:u===!0?i.setAttribute(l,""):tl(i,l,u)}}}function Oe(i,a,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",i),Ot("load",i);var u=!1,p=!1,m;for(m in l)if(l.hasOwnProperty(m)){var v=l[m];if(v!=null)switch(m){case"src":u=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:Gt(i,a,m,v,l,null)}}p&&Gt(i,a,"srcSet",l.srcSet,l,null),u&&Gt(i,a,"src",l.src,l,null);return;case"input":Ot("invalid",i);var E=m=v=p=null,T=null,F=null;for(u in l)if(l.hasOwnProperty(u)){var V=l[u];if(V!=null)switch(u){case"name":p=V;break;case"type":v=V;break;case"checked":T=V;break;case"defaultChecked":F=V;break;case"value":m=V;break;case"defaultValue":E=V;break;case"children":case"dangerouslySetInnerHTML":if(V!=null)throw Error(n(137,a));break;default:Gt(i,a,u,V,l,null)}}ag(i,m,E,T,F,v,p,!1),nl(i);return;case"select":Ot("invalid",i),u=v=m=null;for(p in l)if(l.hasOwnProperty(p)&&(E=l[p],E!=null))switch(p){case"value":m=E;break;case"defaultValue":v=E;break;case"multiple":u=E;default:Gt(i,a,p,E,l,null)}a=m,l=v,i.multiple=!!u,a!=null?Qs(i,!!u,a,!1):l!=null&&Qs(i,!!u,l,!0);return;case"textarea":Ot("invalid",i),m=p=u=null;for(v in l)if(l.hasOwnProperty(v)&&(E=l[v],E!=null))switch(v){case"value":u=E;break;case"defaultValue":p=E;break;case"children":m=E;break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(n(91));break;default:Gt(i,a,v,E,l,null)}og(i,u,p,m),nl(i);return;case"option":for(T in l)if(l.hasOwnProperty(T)&&(u=l[T],u!=null))switch(T){case"selected":i.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Gt(i,a,T,u,l,null)}return;case"dialog":Ot("beforetoggle",i),Ot("toggle",i),Ot("cancel",i),Ot("close",i);break;case"iframe":case"object":Ot("load",i);break;case"video":case"audio":for(u=0;u<Xr.length;u++)Ot(Xr[u],i);break;case"image":Ot("error",i),Ot("load",i);break;case"details":Ot("toggle",i);break;case"embed":case"source":case"link":Ot("error",i),Ot("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(F in l)if(l.hasOwnProperty(F)&&(u=l[F],u!=null))switch(F){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,a));default:Gt(i,a,F,u,l,null)}return;default:if(Ru(a)){for(V in l)l.hasOwnProperty(V)&&(u=l[V],u!==void 0&&dd(i,a,V,u,l,void 0));return}}for(E in l)l.hasOwnProperty(E)&&(u=l[E],u!=null&&Gt(i,a,E,u,l,null))}function cE(i,a,l,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,m=null,v=null,E=null,T=null,F=null,V=null;for(z in l){var W=l[z];if(l.hasOwnProperty(z)&&W!=null)switch(z){case"checked":break;case"value":break;case"defaultValue":T=W;default:u.hasOwnProperty(z)||Gt(i,a,z,null,u,W)}}for(var H in u){var z=u[H];if(W=l[H],u.hasOwnProperty(H)&&(z!=null||W!=null))switch(H){case"type":m=z;break;case"name":p=z;break;case"checked":F=z;break;case"defaultChecked":V=z;break;case"value":v=z;break;case"defaultValue":E=z;break;case"children":case"dangerouslySetInnerHTML":if(z!=null)throw Error(n(137,a));break;default:z!==W&&Gt(i,a,H,z,u,W)}}Tu(i,v,E,T,F,V,m,p);return;case"select":z=v=E=H=null;for(m in l)if(T=l[m],l.hasOwnProperty(m)&&T!=null)switch(m){case"value":break;case"multiple":z=T;default:u.hasOwnProperty(m)||Gt(i,a,m,null,u,T)}for(p in u)if(m=u[p],T=l[p],u.hasOwnProperty(p)&&(m!=null||T!=null))switch(p){case"value":H=m;break;case"defaultValue":E=m;break;case"multiple":v=m;default:m!==T&&Gt(i,a,p,m,u,T)}a=E,l=v,u=z,H!=null?Qs(i,!!l,H,!1):!!u!=!!l&&(a!=null?Qs(i,!!l,a,!0):Qs(i,!!l,l?[]:"",!1));return;case"textarea":z=H=null;for(E in l)if(p=l[E],l.hasOwnProperty(E)&&p!=null&&!u.hasOwnProperty(E))switch(E){case"value":break;case"children":break;default:Gt(i,a,E,null,u,p)}for(v in u)if(p=u[v],m=l[v],u.hasOwnProperty(v)&&(p!=null||m!=null))switch(v){case"value":H=p;break;case"defaultValue":z=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(n(91));break;default:p!==m&&Gt(i,a,v,p,u,m)}rg(i,H,z);return;case"option":for(var _t in l)if(H=l[_t],l.hasOwnProperty(_t)&&H!=null&&!u.hasOwnProperty(_t))switch(_t){case"selected":i.selected=!1;break;default:Gt(i,a,_t,null,u,H)}for(T in u)if(H=u[T],z=l[T],u.hasOwnProperty(T)&&H!==z&&(H!=null||z!=null))switch(T){case"selected":i.selected=H&&typeof H!="function"&&typeof H!="symbol";break;default:Gt(i,a,T,H,u,z)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ft in l)H=l[ft],l.hasOwnProperty(ft)&&H!=null&&!u.hasOwnProperty(ft)&&Gt(i,a,ft,null,u,H);for(F in u)if(H=u[F],z=l[F],u.hasOwnProperty(F)&&H!==z&&(H!=null||z!=null))switch(F){case"children":case"dangerouslySetInnerHTML":if(H!=null)throw Error(n(137,a));break;default:Gt(i,a,F,H,u,z)}return;default:if(Ru(a)){for(var qt in l)H=l[qt],l.hasOwnProperty(qt)&&H!==void 0&&!u.hasOwnProperty(qt)&&dd(i,a,qt,void 0,u,H);for(V in u)H=u[V],z=l[V],!u.hasOwnProperty(V)||H===z||H===void 0&&z===void 0||dd(i,a,V,H,u,z);return}}for(var L in l)H=l[L],l.hasOwnProperty(L)&&H!=null&&!u.hasOwnProperty(L)&&Gt(i,a,L,null,u,H);for(W in u)H=u[W],z=l[W],!u.hasOwnProperty(W)||H===z||H==null&&z==null||Gt(i,a,W,H,u,z)}var fd=null,pd=null;function Ql(i){return i.nodeType===9?i:i.ownerDocument}function ly(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cy(i,a){if(i===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&a==="foreignObject"?0:i}function gd(i,a){return i==="textarea"||i==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var md=null;function uE(){var i=window.event;return i&&i.type==="popstate"?i===md?!1:(md=i,!0):(md=null,!1)}var uy=typeof setTimeout=="function"?setTimeout:void 0,hE=typeof clearTimeout=="function"?clearTimeout:void 0,hy=typeof Promise=="function"?Promise:void 0,dE=typeof queueMicrotask=="function"?queueMicrotask:typeof hy<"u"?function(i){return hy.resolve(null).then(i).catch(fE)}:uy;function fE(i){setTimeout(function(){throw i})}function ji(i){return i==="head"}function dy(i,a){var l=a,u=0,p=0;do{var m=l.nextSibling;if(i.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(0<u&&8>u){l=u;var v=i.ownerDocument;if(l&1&&Wr(v.documentElement),l&2&&Wr(v.body),l&4)for(l=v.head,Wr(l),v=l.firstChild;v;){var E=v.nextSibling,T=v.nodeName;v[ur]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&v.rel.toLowerCase()==="stylesheet"||l.removeChild(v),v=E}}if(p===0){i.removeChild(m),io(a);return}p--}else l==="$"||l==="$?"||l==="$!"?p++:u=l.charCodeAt(0)-48;else u=0;l=m}while(l);io(a)}function _d(i){var a=i.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var l=a;switch(a=a.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":_d(l),Su(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function pE(i,a,l,u){for(;i.nodeType===1;){var p=l;if(i.nodeName.toLowerCase()!==a.toLowerCase()){if(!u&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(u){if(!i[ur])switch(a){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(m=i.getAttribute("rel"),m==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(m!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(m=i.getAttribute("src"),(m!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&m&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(a==="input"&&i.type==="hidden"){var m=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===m)return i}else return i;if(i=Nn(i.nextSibling),i===null)break}return null}function gE(i,a,l){if(a==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=Nn(i.nextSibling),i===null))return null;return i}function yd(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function mE(i,a){var l=i.ownerDocument;if(i.data!=="$?"||l.readyState==="complete")a();else{var u=function(){a(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),i._reactRetry=u}}function Nn(i){for(;i!=null;i=i.nextSibling){var a=i.nodeType;if(a===1||a===3)break;if(a===8){if(a=i.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return i}var bd=null;function fy(i){i=i.previousSibling;for(var a=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(a===0)return i;a--}else l==="/$"&&a++}i=i.previousSibling}return null}function py(i,a,l){switch(a=Ql(l),i){case"html":if(i=a.documentElement,!i)throw Error(n(452));return i;case"head":if(i=a.head,!i)throw Error(n(453));return i;case"body":if(i=a.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function Wr(i){for(var a=i.attributes;a.length;)i.removeAttributeNode(a[0]);Su(i)}var En=new Map,gy=new Set;function Zl(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var mi=U.d;U.d={f:_E,r:yE,D:bE,C:vE,L:AE,m:SE,X:wE,S:EE,M:CE};function _E(){var i=mi.f(),a=Gl();return i||a}function yE(i){var a=Xs(i);a!==null&&a.tag===5&&a.type==="form"?Im(a):mi.r(i)}var xa=typeof document>"u"?null:document;function my(i,a,l){var u=xa;if(u&&typeof a=="string"&&a){var p=mn(a);p='link[rel="'+i+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),gy.has(p)||(gy.add(p),i={rel:i,crossOrigin:l,href:a},u.querySelector(p)===null&&(a=u.createElement("link"),Oe(a,"link",i),be(a),u.head.appendChild(a)))}}function bE(i){mi.D(i),my("dns-prefetch",i,null)}function vE(i,a){mi.C(i,a),my("preconnect",i,a)}function AE(i,a,l){mi.L(i,a,l);var u=xa;if(u&&i&&a){var p='link[rel="preload"][as="'+mn(a)+'"]';a==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+mn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+mn(l.imageSizes)+'"]')):p+='[href="'+mn(i)+'"]';var m=p;switch(a){case"style":m=Ra(i);break;case"script":m=Da(i)}En.has(m)||(i=g({rel:"preload",href:a==="image"&&l&&l.imageSrcSet?void 0:i,as:a},l),En.set(m,i),u.querySelector(p)!==null||a==="style"&&u.querySelector(Kr(m))||a==="script"&&u.querySelector(Qr(m))||(a=u.createElement("link"),Oe(a,"link",i),be(a),u.head.appendChild(a)))}}function SE(i,a){mi.m(i,a);var l=xa;if(l&&i){var u=a&&typeof a.as=="string"?a.as:"script",p='link[rel="modulepreload"][as="'+mn(u)+'"][href="'+mn(i)+'"]',m=p;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Da(i)}if(!En.has(m)&&(i=g({rel:"modulepreload",href:i},a),En.set(m,i),l.querySelector(p)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Qr(m)))return}u=l.createElement("link"),Oe(u,"link",i),be(u),l.head.appendChild(u)}}}function EE(i,a,l){mi.S(i,a,l);var u=xa;if(u&&i){var p=$s(u).hoistableStyles,m=Ra(i);a=a||"default";var v=p.get(m);if(!v){var E={loading:0,preload:null};if(v=u.querySelector(Kr(m)))E.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":a},l),(l=En.get(m))&&vd(i,l);var T=v=u.createElement("link");be(T),Oe(T,"link",i),T._p=new Promise(function(F,V){T.onload=F,T.onerror=V}),T.addEventListener("load",function(){E.loading|=1}),T.addEventListener("error",function(){E.loading|=2}),E.loading|=4,Jl(v,a,u)}v={type:"stylesheet",instance:v,count:1,state:E},p.set(m,v)}}}function wE(i,a){mi.X(i,a);var l=xa;if(l&&i){var u=$s(l).hoistableScripts,p=Da(i),m=u.get(p);m||(m=l.querySelector(Qr(p)),m||(i=g({src:i,async:!0},a),(a=En.get(p))&&Ad(i,a),m=l.createElement("script"),be(m),Oe(m,"link",i),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(p,m))}}function CE(i,a){mi.M(i,a);var l=xa;if(l&&i){var u=$s(l).hoistableScripts,p=Da(i),m=u.get(p);m||(m=l.querySelector(Qr(p)),m||(i=g({src:i,async:!0,type:"module"},a),(a=En.get(p))&&Ad(i,a),m=l.createElement("script"),be(m),Oe(m,"link",i),l.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(p,m))}}function _y(i,a,l,u){var p=(p=Q.current)?Zl(p):null;if(!p)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(a=Ra(l.href),l=$s(p).hoistableStyles,u=l.get(a),u||(u={type:"style",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=Ra(l.href);var m=$s(p).hoistableStyles,v=m.get(i);if(v||(p=p.ownerDocument||p,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(i,v),(m=p.querySelector(Kr(i)))&&!m._p&&(v.instance=m,v.state.loading=5),En.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},En.set(i,l),m||TE(p,i,l,v.state))),a&&u===null)throw Error(n(528,""));return v}if(a&&u!==null)throw Error(n(529,""));return null;case"script":return a=l.async,l=l.src,typeof l=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Da(l),l=$s(p).hoistableScripts,u=l.get(a),u||(u={type:"script",instance:null,count:0,state:null},l.set(a,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Ra(i){return'href="'+mn(i)+'"'}function Kr(i){return'link[rel="stylesheet"]['+i+"]"}function yy(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function TE(i,a,l,u){i.querySelector('link[rel="preload"][as="style"]['+a+"]")?u.loading=1:(a=i.createElement("link"),u.preload=a,a.addEventListener("load",function(){return u.loading|=1}),a.addEventListener("error",function(){return u.loading|=2}),Oe(a,"link",l),be(a),i.head.appendChild(a))}function Da(i){return'[src="'+mn(i)+'"]'}function Qr(i){return"script[async]"+i}function by(i,a,l){if(a.count++,a.instance===null)switch(a.type){case"style":var u=i.querySelector('style[data-href~="'+mn(l.href)+'"]');if(u)return a.instance=u,be(u),u;var p=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(i.ownerDocument||i).createElement("style"),be(u),Oe(u,"style",p),Jl(u,l.precedence,i),a.instance=u;case"stylesheet":p=Ra(l.href);var m=i.querySelector(Kr(p));if(m)return a.state.loading|=4,a.instance=m,be(m),m;u=yy(l),(p=En.get(p))&&vd(u,p),m=(i.ownerDocument||i).createElement("link"),be(m);var v=m;return v._p=new Promise(function(E,T){v.onload=E,v.onerror=T}),Oe(m,"link",u),a.state.loading|=4,Jl(m,l.precedence,i),a.instance=m;case"script":return m=Da(l.src),(p=i.querySelector(Qr(m)))?(a.instance=p,be(p),p):(u=l,(p=En.get(m))&&(u=g({},l),Ad(u,p)),i=i.ownerDocument||i,p=i.createElement("script"),be(p),Oe(p,"link",u),i.head.appendChild(p),a.instance=p);case"void":return null;default:throw Error(n(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(u=a.instance,a.state.loading|=4,Jl(u,l.precedence,i));return a.instance}function Jl(i,a,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=u.length?u[u.length-1]:null,m=p,v=0;v<u.length;v++){var E=u[v];if(E.dataset.precedence===a)m=E;else if(m!==p)break}m?m.parentNode.insertBefore(i,m.nextSibling):(a=l.nodeType===9?l.head:l,a.insertBefore(i,a.firstChild))}function vd(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.title==null&&(i.title=a.title)}function Ad(i,a){i.crossOrigin==null&&(i.crossOrigin=a.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=a.referrerPolicy),i.integrity==null&&(i.integrity=a.integrity)}var tc=null;function vy(i,a,l){if(tc===null){var u=new Map,p=tc=new Map;p.set(l,u)}else p=tc,u=p.get(l),u||(u=new Map,p.set(l,u));if(u.has(i))return u;for(u.set(i,null),l=l.getElementsByTagName(i),p=0;p<l.length;p++){var m=l[p];if(!(m[ur]||m[Be]||i==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(a)||"";v=i+v;var E=u.get(v);E?E.push(m):u.set(v,[m])}}return u}function Ay(i,a,l){i=i.ownerDocument||i,i.head.insertBefore(l,a==="title"?i.querySelector("head > title"):null)}function xE(i,a,l){if(l===1||a.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return i=a.disabled,typeof a.precedence=="string"&&i==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Sy(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Zr=null;function RE(){}function DE(i,a,l){if(Zr===null)throw Error(n(475));var u=Zr;if(a.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var p=Ra(l.href),m=i.querySelector(Kr(p));if(m){i=m._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(u.count++,u=ec.bind(u),i.then(u,u)),a.state.loading|=4,a.instance=m,be(m);return}m=i.ownerDocument||i,l=yy(l),(p=En.get(p))&&vd(l,p),m=m.createElement("link"),be(m);var v=m;v._p=new Promise(function(E,T){v.onload=E,v.onerror=T}),Oe(m,"link",l),a.instance=m}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(a,i),(i=a.state.preload)&&(a.state.loading&3)===0&&(u.count++,a=ec.bind(u),i.addEventListener("load",a),i.addEventListener("error",a))}}function ME(){if(Zr===null)throw Error(n(475));var i=Zr;return i.stylesheets&&i.count===0&&Sd(i,i.stylesheets),0<i.count?function(a){var l=setTimeout(function(){if(i.stylesheets&&Sd(i,i.stylesheets),i.unsuspend){var u=i.unsuspend;i.unsuspend=null,u()}},6e4);return i.unsuspend=a,function(){i.unsuspend=null,clearTimeout(l)}}:null}function ec(){if(this.count--,this.count===0){if(this.stylesheets)Sd(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var nc=null;function Sd(i,a){i.stylesheets=null,i.unsuspend!==null&&(i.count++,nc=new Map,a.forEach(NE,i),nc=null,ec.call(i))}function NE(i,a){if(!(a.state.loading&4)){var l=nc.get(i);if(l)var u=l.get(null);else{l=new Map,nc.set(i,l);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<p.length;m++){var v=p[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(l.set(v.dataset.precedence,v),u=v)}u&&l.set(null,u)}p=a.instance,v=p.getAttribute("data-precedence"),m=l.get(v)||u,m===u&&l.set(null,p),l.set(v,p),this.count++,u=ec.bind(this),p.addEventListener("load",u),p.addEventListener("error",u),m?m.parentNode.insertBefore(p,m.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),a.state.loading|=4}}var Jr={$$typeof:x,Provider:null,Consumer:null,_currentValue:it,_currentValue2:it,_threadCount:0};function OE(i,a,l,u,p,m,v,E){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=yu(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yu(0),this.hiddenUpdates=yu(null),this.identifierPrefix=u,this.onUncaughtError=p,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=E,this.incompleteTransitions=new Map}function Ey(i,a,l,u,p,m,v,E,T,F,V,W){return i=new OE(i,a,l,v,E,T,F,W),a=1,m===!0&&(a|=24),m=on(3,null,null,a),i.current=m,m.stateNode=i,a=ih(),a.refCount++,i.pooledCache=a,a.refCount++,m.memoizedState={element:u,isDehydrated:l,cache:a},oh(m),i}function wy(i){return i?(i=ra,i):ra}function Cy(i,a,l,u,p,m){p=wy(p),u.context===null?u.context=p:u.pendingContext=p,u=Di(a),u.payload={element:l},m=m===void 0?null:m,m!==null&&(u.callback=m),l=Mi(i,u,a),l!==null&&(dn(l,i,a),Dr(l,i,a))}function Ty(i,a){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<a?l:a}}function Ed(i,a){Ty(i,a),(i=i.alternate)&&Ty(i,a)}function xy(i){if(i.tag===13){var a=aa(i,67108864);a!==null&&dn(a,i,67108864),Ed(i,67108864)}}var ic=!0;function kE(i,a,l,u){var p=k.T;k.T=null;var m=U.p;try{U.p=2,wd(i,a,l,u)}finally{U.p=m,k.T=p}}function LE(i,a,l,u){var p=k.T;k.T=null;var m=U.p;try{U.p=8,wd(i,a,l,u)}finally{U.p=m,k.T=p}}function wd(i,a,l,u){if(ic){var p=Cd(u);if(p===null)hd(i,a,u,sc,l),Dy(i,u);else if(PE(p,i,a,l,u))u.stopPropagation();else if(Dy(i,u),a&4&&-1<IE.indexOf(i)){for(;p!==null;){var m=Xs(p);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=os(m.pendingLanes);if(v!==0){var E=m;for(E.pendingLanes|=2,E.entangledLanes|=2;v;){var T=1<<31-an(v);E.entanglements[1]|=T,v&=~T}jn(m),(Ft&6)===0&&(Ul=Bn()+500,Yr(0))}}break;case 13:E=aa(m,2),E!==null&&dn(E,m,2),Gl(),Ed(m,2)}if(m=Cd(u),m===null&&hd(i,a,u,sc,l),m===p)break;p=m}p!==null&&u.stopPropagation()}else hd(i,a,u,null,l)}}function Cd(i){return i=Mu(i),Td(i)}var sc=null;function Td(i){if(sc=null,i=Ys(i),i!==null){var a=o(i);if(a===null)i=null;else{var l=a.tag;if(l===13){if(i=c(a),i!==null)return i;i=null}else if(l===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;i=null}else a!==i&&(i=null)}}return sc=i,null}function Ry(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(vA()){case jp:return 2;case Gp:return 8;case Ko:case AA:return 32;case qp:return 268435456;default:return 32}default:return 32}}var xd=!1,Gi=null,qi=null,Vi=null,to=new Map,eo=new Map,Yi=[],IE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dy(i,a){switch(i){case"focusin":case"focusout":Gi=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":Vi=null;break;case"pointerover":case"pointerout":to.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":eo.delete(a.pointerId)}}function no(i,a,l,u,p,m){return i===null||i.nativeEvent!==m?(i={blockedOn:a,domEventName:l,eventSystemFlags:u,nativeEvent:m,targetContainers:[p]},a!==null&&(a=Xs(a),a!==null&&xy(a)),i):(i.eventSystemFlags|=u,a=i.targetContainers,p!==null&&a.indexOf(p)===-1&&a.push(p),i)}function PE(i,a,l,u,p){switch(a){case"focusin":return Gi=no(Gi,i,a,l,u,p),!0;case"dragenter":return qi=no(qi,i,a,l,u,p),!0;case"mouseover":return Vi=no(Vi,i,a,l,u,p),!0;case"pointerover":var m=p.pointerId;return to.set(m,no(to.get(m)||null,i,a,l,u,p)),!0;case"gotpointercapture":return m=p.pointerId,eo.set(m,no(eo.get(m)||null,i,a,l,u,p)),!0}return!1}function My(i){var a=Ys(i.target);if(a!==null){var l=o(a);if(l!==null){if(a=l.tag,a===13){if(a=c(l),a!==null){i.blockedOn=a,DA(i.priority,function(){if(l.tag===13){var u=hn();u=bu(u);var p=aa(l,u);p!==null&&dn(p,l,u),Ed(l,u)}});return}}else if(a===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ac(i){if(i.blockedOn!==null)return!1;for(var a=i.targetContainers;0<a.length;){var l=Cd(i.nativeEvent);if(l===null){l=i.nativeEvent;var u=new l.constructor(l.type,l);Du=u,l.target.dispatchEvent(u),Du=null}else return a=Xs(l),a!==null&&xy(a),i.blockedOn=l,!1;a.shift()}return!0}function Ny(i,a,l){ac(i)&&l.delete(a)}function BE(){xd=!1,Gi!==null&&ac(Gi)&&(Gi=null),qi!==null&&ac(qi)&&(qi=null),Vi!==null&&ac(Vi)&&(Vi=null),to.forEach(Ny),eo.forEach(Ny)}function rc(i,a){i.blockedOn===a&&(i.blockedOn=null,xd||(xd=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,BE)))}var oc=null;function Oy(i){oc!==i&&(oc=i,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){oc===i&&(oc=null);for(var a=0;a<i.length;a+=3){var l=i[a],u=i[a+1],p=i[a+2];if(typeof u!="function"){if(Td(u||l)===null)continue;break}var m=Xs(l);m!==null&&(i.splice(a,3),a-=3,Th(m,{pending:!0,data:p,method:l.method,action:u},u,p))}}))}function io(i){function a(T){return rc(T,i)}Gi!==null&&rc(Gi,i),qi!==null&&rc(qi,i),Vi!==null&&rc(Vi,i),to.forEach(a),eo.forEach(a);for(var l=0;l<Yi.length;l++){var u=Yi[l];u.blockedOn===i&&(u.blockedOn=null)}for(;0<Yi.length&&(l=Yi[0],l.blockedOn===null);)My(l),l.blockedOn===null&&Yi.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var p=l[u],m=l[u+1],v=p[Xe]||null;if(typeof m=="function")v||Oy(l);else if(v){var E=null;if(m&&m.hasAttribute("formAction")){if(p=m,v=m[Xe]||null)E=v.formAction;else if(Td(p)!==null)continue}else E=v.action;typeof E=="function"?l[u+1]=E:(l.splice(u,3),u-=3),Oy(l)}}}function Rd(i){this._internalRoot=i}lc.prototype.render=Rd.prototype.render=function(i){var a=this._internalRoot;if(a===null)throw Error(n(409));var l=a.current,u=hn();Cy(l,u,i,a,null,null)},lc.prototype.unmount=Rd.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var a=i.containerInfo;Cy(i.current,2,null,i,null,null),Gl(),a[Vs]=null}};function lc(i){this._internalRoot=i}lc.prototype.unstable_scheduleHydration=function(i){if(i){var a=Wp();i={blockedOn:null,target:i,priority:a};for(var l=0;l<Yi.length&&a!==0&&a<Yi[l].priority;l++);Yi.splice(l,0,i),l===0&&My(i)}};var ky=t.version;if(ky!=="19.1.1")throw Error(n(527,ky,"19.1.1"));U.findDOMNode=function(i){var a=i._reactInternals;if(a===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=d(a),i=i!==null?f(i):null,i=i===null?null:i.stateNode,i};var FE={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:k,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cc.isDisabled&&cc.supportsFiber)try{or=cc.inject(FE),sn=cc}catch{}}return ao.createRoot=function(i,a){if(!s(i))throw Error(n(299));var l=!1,u="",p=Wm,m=Km,v=Qm,E=null;return a!=null&&(a.unstable_strictMode===!0&&(l=!0),a.identifierPrefix!==void 0&&(u=a.identifierPrefix),a.onUncaughtError!==void 0&&(p=a.onUncaughtError),a.onCaughtError!==void 0&&(m=a.onCaughtError),a.onRecoverableError!==void 0&&(v=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(E=a.unstable_transitionCallbacks)),a=Ey(i,1,!1,null,null,l,u,p,m,v,E,null),i[Vs]=a.current,ud(i),new Rd(a)},ao.hydrateRoot=function(i,a,l){if(!s(i))throw Error(n(299));var u=!1,p="",m=Wm,v=Km,E=Qm,T=null,F=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(m=l.onUncaughtError),l.onCaughtError!==void 0&&(v=l.onCaughtError),l.onRecoverableError!==void 0&&(E=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(T=l.unstable_transitionCallbacks),l.formState!==void 0&&(F=l.formState)),a=Ey(i,1,!0,a,l??null,u,p,m,v,E,T,F),a.context=wy(null),l=a.current,u=hn(),u=bu(u),p=Di(u),p.callback=null,Mi(l,p,u),l=u,a.current.lanes=l,cr(a,l),jn(a),i[Vs]=a.current,ud(i),new lc(a)},ao.version="19.1.1",ao}var Vy;function $E(){if(Vy)return Od.exports;Vy=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),Od.exports=XE(),Od.exports}var WE=$E();const je=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),sf=[.001,0,0,.001,0,0],Pd=1.35,fn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},$i={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},fv="pdfjs_internal_editor_",vt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},kt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},KE={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},ke={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Sc={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},pe={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ka={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Kc={ERRORS:0,WARNINGS:1,INFOS:5},Co={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},uc={moveTo:0,lineTo:1,curveTo:2,closePath:3},QE={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Qc=Kc.WARNINGS;function ZE(r){Number.isInteger(r)&&(Qc=r)}function JE(){return Qc}function Zc(r){Qc>=Kc.INFOS&&console.log(`Info: ${r}`)}function At(r){Qc>=Kc.WARNINGS&&console.log(`Warning: ${r}`)}function Vt(r){throw new Error(r)}function me(r,t){r||Vt(t)}function t1(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function pv(r,t=null,e=null){if(!r)return null;if(e&&typeof r=="string"&&(e.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),e.tryConvertEncoding))try{r=a1(r)}catch{}const n=t?URL.parse(r,t):URL.parse(r);return t1(n)?n:null}function gv(r,t,e=!1){const n=URL.parse(r);return n?(n.hash=t,n.href):e&&pv(r,"http://example.com")?r.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Rt(r,t,e,n=!1){return Object.defineProperty(r,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const Hs=(function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class Yy extends Hs{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Bd extends Hs{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class af extends Hs{constructor(t){super(t,"InvalidPDFException")}}class xc extends Hs{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class e1 extends Hs{constructor(t){super(t,"FormatError")}}class ts extends Hs{constructor(t){super(t,"AbortException")}}function mv(r){(typeof r!="object"||r?.length===void 0)&&Vt("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const n=[];for(let s=0;s<t;s+=e){const o=Math.min(s+e,t),c=r.subarray(s,o);n.push(String.fromCharCode.apply(null,c))}return n.join("")}function Ho(r){typeof r!="string"&&Vt("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=r.charCodeAt(n)&255;return e}function n1(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function i1(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function s1(){try{return new Function(""),!0}catch{return!1}}class Pe{static get isLittleEndian(){return Rt(this,"isLittleEndian",i1())}static get isEvalSupported(){return Rt(this,"isEvalSupported",s1())}static get isOffscreenCanvasSupported(){return Rt(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Rt(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Rt(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return Rt(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Fd=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class ct{static makeHexColor(t,e,n){return`#${Fd[t]}${Fd[e]}${Fd[n]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,n=0){const s=t[n],o=t[n+1];t[n]=s*e[0]+o*e[2]+e[4],t[n+1]=s*e[1]+o*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const s=e[0],o=e[1],c=e[2],h=e[3],d=e[4],f=e[5];for(let g=0;g<6;g+=2){const _=t[n+g],y=t[n+g+1];t[n+g]=_*s+y*c+d,t[n+g+1]=_*o+y*h+f}}static applyInverseTransform(t,e){const n=t[0],s=t[1],o=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-s*e[2]+e[2]*e[5]-e[4]*e[3])/o,t[1]=(-n*e[1]+s*e[0]+e[4]*e[1]-e[5]*e[0])/o}static axialAlignedBoundingBox(t,e,n){const s=e[0],o=e[1],c=e[2],h=e[3],d=e[4],f=e[5],g=t[0],_=t[1],y=t[2],b=t[3];let A=s*g+d,S=A,w=s*y+d,C=w,D=h*_+f,x=D,I=h*b+f,O=I;if(o!==0||c!==0){const P=o*g,G=o*y,Y=c*_,j=c*b;A+=Y,C+=Y,w+=j,S+=j,D+=P,O+=P,I+=G,x+=G}n[0]=Math.min(n[0],A,w,S,C),n[1]=Math.min(n[1],D,I,x,O),n[2]=Math.max(n[2],A,w,S,C),n[3]=Math.max(n[3],D,I,x,O)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],s=t[1],o=t[2],c=t[3],h=n**2+s**2,d=n*o+s*c,f=o**2+c**2,g=(h+f)/2,_=Math.sqrt(g**2-(h*f-d**2));e[0]=Math.sqrt(g+_||1),e[1]=Math.sqrt(g-_||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>s)return null;const o=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return o>c?null:[n,o,s,c]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,s,o){o[0]=Math.min(o[0],t,n),o[1]=Math.min(o[1],e,s),o[2]=Math.max(o[2],t,n),o[3]=Math.max(o[3],e,s)}static#t(t,e,n,s,o,c,h,d,f,g){if(f<=0||f>=1)return;const _=1-f,y=f*f,b=y*f,A=_*(_*(_*t+3*f*e)+3*y*n)+b*s,S=_*(_*(_*o+3*f*c)+3*y*h)+b*d;g[0]=Math.min(g[0],A),g[1]=Math.min(g[1],S),g[2]=Math.max(g[2],A),g[3]=Math.max(g[3],S)}static#e(t,e,n,s,o,c,h,d,f,g,_,y){if(Math.abs(f)<1e-12){Math.abs(g)>=1e-12&&this.#t(t,e,n,s,o,c,h,d,-_/g,y);return}const b=g**2-4*_*f;if(b<0)return;const A=Math.sqrt(b),S=2*f;this.#t(t,e,n,s,o,c,h,d,(-g+A)/S,y),this.#t(t,e,n,s,o,c,h,d,(-g-A)/S,y)}static bezierBoundingBox(t,e,n,s,o,c,h,d,f){f[0]=Math.min(f[0],t,h),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,h),f[3]=Math.max(f[3],e,d),this.#e(t,n,o,h,e,s,c,d,3*(-t+3*(n-o)+h),6*(t-2*n+o),3*(n-t),f),this.#e(t,n,o,h,e,s,c,d,3*(-e+3*(s-c)+d),6*(e-2*s+c),3*(s-e),f)}}function a1(r){return decodeURIComponent(escape(r))}let Hd=null,Xy=null;function r1(r){return Hd||(Hd=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Xy=new Map([["ﬅ","ſt"]])),r.replaceAll(Hd,(t,e,n)=>e?e.normalize("NFKC"):Xy.get(n))}function _v(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),mv(r)}const jf="pdfjs_internal_id_";function o1(r,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,s,...o]=e;if(!r(n)&&!Number.isInteger(n)||!t(s))return!1;const c=o.length;let h=!0;switch(s.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;h=!1;break;default:return!1}for(const d of o)if(!(typeof d=="number"||h&&d===null))return!1;return!0}function Ge(r,t,e){return Math.min(Math.max(r,t),e)}function yv(r){return Uint8Array.prototype.toBase64?r.toBase64():btoa(mv(r))}function l1(r){return Uint8Array.fromBase64?Uint8Array.fromBase64(r):Ho(atob(r))}typeof Promise.try!="function"&&(Promise.try=function(r,...t){return new Promise(e=>{e(r(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((t,e)=>t+e,0)});const _i="http://www.w3.org/2000/svg";class Xa{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function zo(r,t="text"){if(go(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const s=new XMLHttpRequest;s.open("GET",r,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class Uo{constructor({viewBox:t,userUnit:e,scale:n,rotation:s,offsetX:o=0,offsetY:c=0,dontFlip:h=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=s,this.offsetX=o,this.offsetY=c,n*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let g,_,y,b;switch(s%=360,s<0&&(s+=360),s){case 180:g=-1,_=0,y=0,b=1;break;case 90:g=0,_=1,y=1,b=0;break;case 270:g=0,_=-1,y=-1,b=0;break;case 0:g=1,_=0,y=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}h&&(y=-y,b=-b);let A,S,w,C;g===0?(A=Math.abs(f-t[1])*n+o,S=Math.abs(d-t[0])*n+c,w=(t[3]-t[1])*n,C=(t[2]-t[0])*n):(A=Math.abs(d-t[0])*n+o,S=Math.abs(f-t[1])*n+c,w=(t[2]-t[0])*n,C=(t[3]-t[1])*n),this.transform=[g*n,_*n,y*n,b*n,A-g*n*d-y*n*f,S-_*n*d-b*n*f],this.width=w,this.height=C}get rawDims(){const t=this.viewBox;return Rt(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new Uo({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(t,e){const n=[t,e];return ct.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];ct.applyTransform(e,this.transform);const n=[t[2],t[3]];return ct.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return ct.applyInverseTransform(n,this.transform),n}}class Gf extends Hs{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Jc(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function qf(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function c1(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function u1(r,t="document.pdf"){if(typeof r!="string")return t;if(Jc(r))return At('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(h=>{try{return new URL(h)}catch{try{return new URL(decodeURIComponent(h))}catch{try{return new URL(h,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(h),"https://foo.bar")}catch{return null}}}}})(r);if(!n)return t;const s=h=>{try{let d=decodeURIComponent(h);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:h):d}catch{return h}},o=/\.pdf$/i,c=n.pathname.split("/").at(-1);if(o.test(c))return s(c);if(n.searchParams.size>0){const h=Array.from(n.searchParams.values()).reverse();for(const f of h)if(o.test(f))return s(f);const d=Array.from(n.searchParams.keys()).reverse();for(const f of d)if(o.test(f))return s(f)}if(n.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(d)return s(d[0])}return t}class $y{started=Object.create(null);times=[];time(t){t in this.started&&At(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||At(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:s,end:o}of this.times)t.push(`${n.padEnd(e)} ${o-s}ms
`);return t.join("")}}function go(r,t){const e=t?URL.parse(r,t):URL.parse(r);return e?.protocol==="http:"||e?.protocol==="https:"}function Rn(r){r.preventDefault()}function ge(r){r.preventDefault(),r.stopPropagation()}function h1(r){console.log("Deprecated API usage: "+r)}class rf{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const n=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(e[3],10);o=o>=1&&o<=31?o:1;let c=parseInt(e[4],10);c=c>=0&&c<=23?c:0;let h=parseInt(e[5],10);h=h>=0&&h<=59?h:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let g=parseInt(e[8],10);g=g>=0&&g<=23?g:0;let _=parseInt(e[9],10)||0;return _=_>=0&&_<=59?_:0,f==="-"?(c+=g,h+=_):f==="+"&&(c-=g,h-=_),new Date(Date.UTC(n,s,o,c,h,d))}}function d1(r,{scale:t=1,rotation:e=0}){const{width:n,height:s}=r.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new Uo({viewBox:o,userUnit:1,scale:t,rotation:e})}function tu(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(At(`Not a valid color format: "${r}"`),[0,0,0])}function f1(r){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of r.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;r.set(e,tu(n))}t.remove()}function ee(r){const{a:t,b:e,c:n,d:s,e:o,f:c}=r.getTransform();return[t,e,n,s,o,c]}function Vn(r){const{a:t,b:e,c:n,d:s,e:o,f:c}=r.getTransform().invertSelf();return[t,e,n,s,o,c]}function ks(r,t,e=!1,n=!0){if(t instanceof Uo){const{pageWidth:s,pageHeight:o}=t.rawDims,{style:c}=r,h=Pe.isCSSRoundSupported,d=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${o}px`,g=h?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,_=h?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(c.width=g,c.height=_):(c.width=_,c.height=g)}n&&r.setAttribute("data-main-rotation",t.rotation)}class ti{constructor(){const{pixelRatio:t}=ti;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,s,o=-1){let c=1/0,h=1/0,d=1/0;n=ti.capPixels(n,o),n>0&&(c=Math.sqrt(n/(t*e))),s!==-1&&(h=s/t,d=s/e);const f=Math.min(c,h,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const of=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class yo{#t=null;#e=null;#n;#i=null;#a=null;#s=null;#r=null;static#o=null;constructor(t){this.#n=t,yo.#o||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Rn,{signal:e}),t.addEventListener("pointerdown",yo.#l,{signal:e}));const n=this.#i=document.createElement("div");n.className="buttons",t.append(n);const s=this.#n.toolbarPosition;if(s){const{style:o}=t,c=this.#n._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*c}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#c(t){this.#n._focusEventsAllowed=!1,ge(t)}#d(t){this.#n._focusEventsAllowed=!0,ge(t)}#u(t){const e=this.#n._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Rn,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#n,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",yo.#o[t]),this.#u(n)&&n.addEventListener("click",s=>{e.delete()},{signal:e._signal}),this.#i.append(n)}get#f(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#u(e),this.#i.append(e,this.#f),this.#a=t}addComment(t){if(this.#s)return;const e=t.render();e&&(this.#u(e),this.#i.append(e,this.#f),this.#s=t,t.toolbar=this)}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#u(e),this.#i.append(e,this.#f)}async addEditSignatureButton(t){const e=this.#r=await t.renderEditButton(this.#n);this.#u(e),this.#i.append(e,this.#f)}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}updateEditSignatureButton(t){this.#r&&(this.#r.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class p1{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#n._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Rn,{signal:e});const n=this.#t=document.createElement("div");return n.className="buttons",t.append(n),this.#n.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#a(t,e){let n=0,s=0;for(const o of t){const c=o.y+o.height;if(c<n)continue;const h=o.x+(e?o.width:0);if(c>n){s=h,n=c;continue}e?h>s&&(s=h):h<s&&(s=h)}return[e?1-s:s,n]}show(t,e,n){const[s,o]=this.#a(e,n),{style:c}=this.#e||=this.#i();t.append(this.#e),c.insetInlineEnd=`${100*s}%`,c.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#s(t,e,n,s){const o=document.createElement("button");o.classList.add("basic",t),o.tabIndex=0,o.setAttribute("data-l10n-id",e);const c=document.createElement("span");o.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",n);const h=this.#n._signal;h instanceof AbortSignal&&!h.aborted&&(o.addEventListener("contextmenu",Rn,{signal:h}),o.addEventListener("click",s,{signal:h})),this.#t.append(o)}}function bv(r,t,e){for(const n of e)t.addEventListener(n,r[n].bind(r))}class g1{#t=0;get id(){return`${fv}${this.#t++}`}}class Vf{#t=_v();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Rt(this,"_isSVGFittingCanvas",o)}async#i(t,e){this.#n||=new Map;let n=this.#n.get(t);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof e=="string"?(n.url=e,s=await zo(e,"blob")):e instanceof File?s=n.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const o=Vf._isSVGFittingCanvas,c=new FileReader,h=new Image,d=new Promise((f,g)=>{h.onload=()=>{n.bitmap=h,n.isSvg=!0,f()},c.onload=async()=>{const _=n.svgUrl=c.result;h.src=await o?`${_}#svgView(preserveAspectRatio(none))`:_},h.onerror=c.onerror=g});c.readAsDataURL(s),await d}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){At(s),n=null}return this.#n.set(t,n),n&&this.#n.set(n.id,n),n}async getFromFile(t){const{lastModified:e,name:n,size:s,type:o}=t;return this.#i(`${e}_${n}_${s}_${o}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const n=await e;return this.#i(t,n)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let n=this.#n.get(t);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,n),this.#n.set(n.id,n),n}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=s.convertToBlob()}n.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class m1{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:c=!1,keepUndo:h=!1}){if(s&&t(),this.#e)return;const d={cmd:t,undo:e,post:n,type:o};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(d);return}if(c&&this.#t[this.#i].type===o){h&&(d.undo=this.#t[this.#i].undo),this.#t[this.#i]=d;return}const f=this.#i+1;f===this.#n?this.#t.splice(0,1):(this.#i=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class jo{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Pe.platform;for(const[n,s,o={}]of t)for(const c of n){const h=c.startsWith("mac+");e&&h?(this.callbacks.set(c.slice(4),{callback:s,options:o}),this.allKeys.add(c.split("+").at(-1))):!e&&!h&&(this.callbacks.set(c,{callback:s,options:o}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(this.#t(e));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:c=[],checker:h=null}}=n;h&&!h(t,e)||(s.bind(t,...c,e)(),o||ge(e))}}class Yf{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return f1(t),Rt(this,"_colors",t)}convert(t){const e=tu(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,s]of this._colors)if(s.every((o,c)=>o===e[c]))return Yf._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?ct.makeHexColor(...e):t}}class es{#t=new AbortController;#e=null;#n=null;#i=new Map;#a=new Map;#s=null;#r=null;#o=null;#l=new m1;#c=null;#d=null;#u=null;#f=0;#g=new Set;#p=null;#h=null;#m=new Set;_editorUndoBar=null;#b=!1;#_=!1;#A=!1;#S=null;#y=null;#E=null;#R=null;#T=!1;#w=null;#O=new g1;#x=!1;#D=!1;#I=!1;#k=null;#L=null;#P=null;#N=null;#H=null;#C=vt.NONE;#v=new Set;#z=null;#U=null;#G=null;#$=null;#Y=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#B=[0,0];#q=null;#V=null;#Z=null;#J=null;#F=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=es.prototype,e=c=>c.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),n=(c,{target:h})=>{if(h instanceof HTMLInputElement){const{type:d}=h;return d!=="text"&&d!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Rt(this,"_keyboardManager",new jo([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:h})=>!(h instanceof HTMLButtonElement)&&c.#V.contains(h)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:h})=>!(h instanceof HTMLButtonElement)&&c.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-o,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[o,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-o],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,o],checker:e}]]))}constructor(t,e,n,s,o,c,h,d,f,g,_,y,b,A,S,w){const C=this._signal=this.#t.signal;this.#V=t,this.#Z=e,this.#J=n,this.#s=s,this.#c=o,this.#U=c,this.#Y=d,this._eventBus=h,h._on("editingaction",this.onEditingAction.bind(this),{signal:C}),h._on("pagechanging",this.onPageChanging.bind(this),{signal:C}),h._on("scalechanging",this.onScaleChanging.bind(this),{signal:C}),h._on("rotationchanging",this.onRotationChanging.bind(this),{signal:C}),h._on("setpreference",this.onSetPreference.bind(this),{signal:C}),h._on("switchannotationeditorparams",D=>this.updateParams(D.type,D.value),{signal:C}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:C}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:C}),this.#lt(),this.#dt(),this.#et(),this.#r=d.annotationStorage,this.#S=d.filterFactory,this.#G=f,this.#R=g||null,this.#b=_,this.#_=y,this.#A=b,this.#H=A||null,this.viewParameters={realScale:Xa.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=w!==!1}destroy(){this.#F?.resolve(),this.#F=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#i.clear(),this.#m.clear(),this.#N?.clear(),this.#e=null,this.#v.clear(),this.#l.destroy(),this.#s?.destroy(),this.#c?.destroy(),this.#U?.destroy(),this.#w?.hide(),this.#w=null,this.#P?.destroy(),this.#P=null,this.#n=null,this.#y&&(clearTimeout(this.#y),this.#y=null),this.#q&&(clearTimeout(this.#q),this.#q=null),this._editorUndoBar?.destroy(),this.#Y=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#H}get useNewAltTextFlow(){return this.#_}get useNewAltTextWhenAddingImage(){return this.#A}get hcmFilter(){return Rt(this,"hcmFilter",this.#G?this.#S.addHCMFilter(this.#G.foreground,this.#G.background):"none")}get direction(){return Rt(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return Rt(this,"_highlightColors",this.#R?new Map(this.#R.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Rt(this,"highlightColors",null);const e=new Map,n=!!this.#G;for(const[s,o]of t){const c=s.endsWith("_HCM");if(n&&c){e.set(s.replace("_HCM",""),o);continue}!n&&!c&&e.set(s,o)}return Rt(this,"highlightColors",e)}get highlightColorNames(){return Rt(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#P=t}editAltText(t,e=!1){this.#s?.editAltText(this,t,e)}hasCommentManager(){return!!this.#c}editComment(t,e){this.#c?.open(this,t,e)}getSignature(t){this.#U?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#U}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#A=e;break}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,e){for(const n of this.#a.values()){const{x:s,y:o,width:c,height:h}=n.div.getBoundingClientRect();if(t>=s&&t<=s+c&&e>=o&&e<=o+h)return n}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#m.add(t)}removeShouldRescale(t){this.#m.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Xa.PDF_TO_CSS_UNITS;for(const e of this.#m)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#Q({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of this.#a.values())if(n.hasTextLayer(t))return n;return null}highlightSelection(t="",e=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:o,focusNode:c,focusOffset:h}=n,d=n.toString(),g=this.#Q(n).closest(".textLayer"),_=this.getSelectionBoxes(g);if(!_)return;n.empty();const y=this.#tt(g),b=this.#C===vt.NONE,A=()=>{const S=y?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:_,anchorNode:s,anchorOffset:o,focusNode:c,focusOffset:h,text:d});b&&this.showAllEditors("highlight",!0,!0),e&&S?.editComment()};if(b){this.switchToMode(vt.HIGHLIGHT,A);return}A()}commentSelection(t=""){this.highlightSelection(t,!0)}#rt(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=this.#Q(t).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#w||=new p1(this),this.#w.show(n,s,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}a11yAlert(t,e=null){const n=this.#J;n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#z&&(this.#w?.hide(),this.#z=null,this.#M({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#z)return;const s=this.#Q(t).closest(".textLayer");if(!s){this.#z&&(this.#w?.hide(),this.#z=null,this.#M({hasSelectedText:!1}));return}if(this.#w?.hide(),this.#z=e,this.#M({hasSelectedText:!0}),!(this.#C!==vt.HIGHLIGHT&&this.#C!==vt.NONE)&&(this.#C===vt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#T=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#C===vt.HIGHLIGHT?this.#tt(s):null;if(o?.toggleDrawing(),this.#D){const c=new AbortController,h=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#W("main_toolbar"))};window.addEventListener("pointerup",d,{signal:h}),window.addEventListener("blur",d,{signal:h})}else o?.toggleDrawing(!0),this.#W("main_toolbar")}}#W(t=""){this.#C===vt.HIGHLIGHT?this.highlightSelection(t):this.#b&&this.#rt()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#E)return;this.#E=new AbortController;const t=this.combinedSignal(this.#E);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#E?.abort(),this.#E=null}blur(){if(this.isShiftKeyDown=!1,this.#T&&(this.#T=!1,this.#W("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#v)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#k?.abort(),this.#k=null}#nt(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#it(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#nt()}removeEditListeners(){this.#ht(),this.#it()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of this.#h)if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of this.#h)if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const n of this.#v){const s=n.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const o of e.items)for(const c of this.#h)if(c.isHandlingMimeForPasting(o.type)){c.paste(o,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){At(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const d of n){const f=await s.deserialize(d);if(!f)return;o.push(f)}const c=()=>{for(const d of o)this.#st(d);this.#at(o)},h=()=>{for(const d of o)d.remove()};this.addCommands({cmd:c,undo:h,mustExec:!0})}catch(o){At(`paste: "${o.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==vt.NONE&&!this.isEditorHandlingKeyboard&&es._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#T&&(this.#T=!1,this.#W("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#M(t){Object.entries(t).some(([n,s])=>this.#X[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#C===vt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#j([[kt.HIGHLIGHT_FREE,!0]]))}#j(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#nt(),this.#M({isEditing:this.#C!==vt.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:this.#l.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#it(),this.#M({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#j(e.defaultPropertiesToUpdate)}}getId(){return this.#O.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#x?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,n=!1,s=!1,o=!1){if(this.#C!==t&&!(this.#F&&(await this.#F.promise,!this.#F))){if(this.#F=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#C===vt.POPUP&&this.#c?.hideSidebar(),this.#C=t,t===vt.NONE){this.setEditingState(!1),this.#pt(),this._editorUndoBar?.hide(),this.#F.resolve();return}t===vt.SIGNATURE&&await this.#U?.loadSignatures(),t===vt.POPUP&&(this.#n||=await this.#Y.getAnnotationsByType(new Set(this.#h.map(c=>c._editorType))),this.#c?.showSidebar(this.#n)),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const c of this.#a.values())c.updateMode(t);if(!e){n&&this.addNewEditorFromKeyboard(),this.#F.resolve();return}for(const c of this.#i.values())c.annotationElementId===e||c.id===e?(this.setSelected(c),o?c.editComment():s&&c.enterInEditMode()):c.unselect();this.#F.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case kt.CREATE:this.currentLayer.addNewEditor(e);return;case kt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#$||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of this.#v)n.updateParams(t,e);else for(const n of this.#h)n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){for(const o of this.#i.values())o.editorType===t&&o.show(e);(this.#$?.get(kt.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#j([[kt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#I!==t){this.#I=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#x){this.#x=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#pt(){if(this.unselectAll(),this.#x){this.#x=!1;for(const t of this.#a.values())t.disable();for(const t of this.#i.values())t.disable()}}getEditors(t){const e=[];for(const n of this.#i.values())n.pageIndex===t&&e.push(n);return e}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.focusMainContainer(),this.#y=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#N?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#st(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#j(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#v);return t}updateUI(t){this.#gt===t&&this.#j(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#j(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#v.has(t)){this.#v.delete(t),t.unselect(),this.#M({hasSelectedEditor:this.hasSelection});return}this.#v.add(t),t.select(),this.#j(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#u?.commitOrRemove();for(const e of this.#v)e!==t&&e.unselect();this.#v.clear(),this.#v.add(t),t.select(),this.#j(t.propertiesToUpdate),this.#M({hasSelectedEditor:!0})}isSelected(t){return this.#v.has(t)}get firstSelectedEditor(){return this.#v.values().next().value}unselect(t){t.unselect(),this.#v.delete(t),this.#M({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#v.size!==0}get isEnterHandled(){return this.#v.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#l.undo(),this.#M({hasSomethingToUndo:this.#l.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#l.redo(),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:this.#l.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(t){this.#l.add(t),this.#M({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(t){this.#l.cleanType(t)}#K(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#v],n=()=>{this._editorUndoBar?.show(s,e.length===1?e[0].editorType:e.length);for(const o of e)o.remove()},s=()=>{for(const o of e)this.#st(o)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#at(t){for(const e of this.#v)e.unselect();this.#v.clear();for(const e of t)e.isEmpty()||(this.#v.add(e),e.select());this.#M({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#v)t.commit();this.#at(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==vt.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#v)t.unselect();this.#v.clear(),this.#M({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#B[0]+=t,this.#B[1]+=e;const[s,o]=this.#B,c=[...this.#v],h=1e3;this.#q&&clearTimeout(this.#q),this.#q=setTimeout(()=>{this.#q=null,this.#B[0]=this.#B[1]=0,this.addCommands({cmd:()=>{for(const d of c)this.#i.has(d.id)&&(d.translateInPage(s,o),d.translationDone())},undo:()=>{for(const d of c)this.#i.has(d.id)&&(d.translateInPage(-s,-o),d.translationDone())},mustExec:!1})},h);for(const d of c)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#v)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:s,y:o,pageIndex:c},h]of t)h.newX=s,h.newY=o,h.newPageIndex=c,e||=s!==h.savedX||o!==h.savedY||c!==h.savedPageIndex;if(!e)return!1;const n=(s,o,c,h)=>{if(this.#i.has(s.id)){const d=this.#a.get(h);d?s._setParentAndPosition(d,o,c):(s.pageIndex=h,s.x=o,s.y=c)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:c,newPageIndex:h}]of t)n(s,o,c,h)},undo:()=>{for(const[s,{savedX:o,savedY:c,savedPageIndex:h}]of t)n(s,o,c,h)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const n of this.#p.keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#v.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}get imageManager(){return Rt(this,"imageManager",new Vf)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,g=e.rangeCount;f<g;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:c}=t.getBoundingClientRect();let h;switch(t.getAttribute("data-main-rotation")){case"90":h=(f,g,_,y)=>({x:(g-s)/c,y:1-(f+_-n)/o,width:y/c,height:_/o});break;case"180":h=(f,g,_,y)=>({x:1-(f+_-n)/o,y:1-(g+y-s)/c,width:_/o,height:y/c});break;case"270":h=(f,g,_,y)=>({x:1-(g+y-s)/c,y:(f-n)/o,width:y/c,height:_/o});break;default:h=(f,g,_,y)=>({x:(f-n)/o,y:(g-s)/c,width:_/o,height:y/c});break}const d=[];for(let f=0,g=e.rangeCount;f<g;f++){const _=e.getRangeAt(f);if(!_.collapsed)for(const{x:y,y:b,width:A,height:S}of _.getClientRects())A===0||S===0||d.push(h(y,b,A,S))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const n=this.#r.getRawValue(e);n&&(this.#C===vt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){const s=this.#N?.get(t);s&&(s.setCanvas(e,n),this.#N.delete(t))}addMissingCanvas(t,e){(this.#N||=new Map).set(t,e)}}class Zn{#t=null;#e=!1;#n=null;#i=null;#a=null;#s=null;#r=!1;#o=null;#l=null;#c=null;#d=null;#u=!1;static#f=null;static _l10n=null;constructor(t){this.#l=t,this.#u=t._uiManager.useNewAltTextFlow,Zn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Zn._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",Zn.#f.missing),e.setAttribute("data-l10n-id",Zn.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#l._uiManager._signal;t.addEventListener("contextmenu",Rn,{signal:n}),t.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),this.#l._uiManager.editAltText(this.#l),this.#u&&this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",s,{capture:!0,signal:n}),t.addEventListener("keydown",o=>{o.target===t&&o.key==="Enter"&&(this.#r=!0,s(o))},{signal:n}),await this.#p(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#c:this.isEmpty()}get guessedText(){return this.#c}async setGuessedText(t){this.#t===null&&(this.#c=t,this.#d=await Zn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#l.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#c===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#c,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:s,cancel:o=!1}){n&&(this.#c=n,this.#d=s),!(this.#t===t&&this.#e===e)&&(o||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#n&&(!t&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#n.disabled=!t)}shown(){this.#l._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#a=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#n;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Zn.#f[this.#g]),this.#i?.setAttribute("data-l10n-id",Zn.#f[`${this.#g}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#l.id}`;const s=100,o=this.#l._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#a.classList.add("show"),this.#l._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:o}),t.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#a?.classList.remove("show")},{signal:o})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#l.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class hc{#t=null;#e=!1;#n=null;#i=null;#a=null;#s=null;#r=!1;constructor(t){this.#n=t,this.toolbar=null}render(){if(!this.#n._uiManager.hasCommentManager())return null;const t=this.#t=document.createElement("button");t.className="comment",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const e=this.#n._uiManager._signal;if(!(e instanceof AbortSignal)||e.aborted)return t;t.addEventListener("contextmenu",Rn,{signal:e}),t.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:e});const n=s=>{s.preventDefault(),this.edit()};return t.addEventListener("click",n,{capture:!0,signal:e}),t.addEventListener("keydown",s=>{s.target===t&&s.key==="Enter"&&(this.#e=!0,n(s))},{signal:e}),t}edit(){const{bottom:t,left:e,right:n}=this.#n.getClientDimensions(),s={top:t};this.#n._uiManager.direction==="ltr"?s.right=n:s.left=e,this.#n._uiManager.editComment(this.#n,s)}finish(){this.#t&&(this.#t.focus({focusVisible:this.#e}),this.#e=!1)}isDeleted(){return this.#r||this.#a===""}hasBeenEdited(){return this.isDeleted()||this.#a!==this.#i}serialize(){return this.data}get data(){return{text:this.#a,date:this.#s,deleted:this.#r}}set data(t){if(t===null){this.#a="",this.#r=!0;return}this.#a=t,this.#s=new Date,this.#r=!1}setInitialText(t){this.#i=t,this.data=t}toggle(t=!1){this.#t&&(this.#t.disabled=!t)}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#a="",this.#s=null,this.#n=null,this.#e=!1,this.#r=!1}}class eu{#t;#e=!1;#n=null;#i;#a;#s;#r;#o=null;#l;#c=null;#d;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:o=null,onPinchEnd:c=null,signal:h}){this.#t=t,this.#n=n,this.#i=e,this.#a=s,this.#s=o,this.#r=c,this.#d=new AbortController,this.#l=AbortSignal.any([h,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#l})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/ti.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,o=AbortSignal.any([this.#l,s.signal]),c=this.#t,h={capture:!0,signal:o,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(ge(f),d(f))},h),c.addEventListener("pointerup",d,h),c.addEventListener("pointercancel",d,h);return}if(!this.#u){this.#u=new AbortController;const s=AbortSignal.any([this.#l,this.#u.signal]),o=this.#t,c={signal:s,capture:!1,passive:!1};o.addEventListener("touchmove",this.#g.bind(this),c);const h=this.#p.bind(this);o.addEventListener("touchend",h,c),o.addEventListener("touchcancel",h,c),c.capture=!0,o.addEventListener("pointerdown",ge,c),o.addEventListener("pointermove",ge,c),o.addEventListener("pointercancel",ge,c),o.addEventListener("pointerup",ge,c),this.#a?.()}if(ge(t),t.touches.length!==2||this.#n?.()){this.#c=null;return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),this.#c={touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(t){if(!this.#c||t.touches.length!==2)return;ge(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:s,screenY:o}=e,{screenX:c,screenY:h}=n,d=this.#c,{touch0X:f,touch0Y:g,touch1X:_,touch1Y:y}=d,b=_-f,A=y-g,S=c-s,w=h-o,C=Math.hypot(S,w)||1,D=Math.hypot(b,A)||1;if(!this.#e&&Math.abs(D-C)<=eu.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=s,d.touch0Y=o,d.touch1X=c,d.touch1Y=h,!this.#e){this.#e=!0;return}const x=[(s+c)/2,(o+h)/2];this.#s?.(x,D,C)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#r?.()),this.#c&&(ge(t),this.#c=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class dt{#t=null;#e=null;#n=null;#i=null;#a=!1;#s=null;#r="";#o=!1;#l=null;#c=null;#d=null;#u=null;#f="";#g=!1;#p=null;#h=!1;#m=!1;#b=!1;#_=null;#A=0;#S=0;#y=null;#E=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#R=!1;#T=dt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Yf;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=dt.prototype._resizeWithKeyboard,e=es.TRANSLATE_SMALL,n=es.TRANSLATE_BIG;return Rt(this,"_resizerKeyboardManager",new jo([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],dt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:c}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,c];const[h,d]=this.parentDimensions;this.x=t.x/h,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Rt(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new _1({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(dt._l10n??=t,dt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),dt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);dt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Vt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#R}set _isDraggable(t){this.#R=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#B(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,s){const[o,c]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(t+n)/o,this.y=(e+s)/c,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,s]=this.parentDimensions;this.setAt(t*n,e*s,this.width*n,this.height*s),this._onTranslated()}#w([t,e],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#w(this.parentDimensions,t,e)}translateInPage(t,e){this.#p||=[this.x,this.y,this.width,this.height],this.#w(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#p||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,o]}=this;if(this.x+=t/s,this.y+=e/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:_,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,_,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:h}=this;const[d,f]=this.getBaseTranslation();c+=d,h+=f;const{style:g}=n;g.left=`${(100*c).toFixed(2)}%`,g.top=`${(100*h).toFixed(2)}%`,this._onTranslating(c,h),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#p&&(this.#p[0]!==this.x||this.#p[1]!==this.y)}get _hasBeenResized(){return!!this.#p&&(this.#p[2]!==this.width||this.#p[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=dt,s=n/t,o=n/e;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,s]}=this;let{x:o,y:c,width:h,height:d}=this;if(h*=n,d*=s,o*=n,c*=s,this._mustFixPosition)switch(t){case 0:o=Ge(o,0,n-h),c=Ge(c,0,s-d);break;case 90:o=Ge(o,0,n-d),c=Ge(c,h,s);break;case 180:o=Ge(o,h,n),c=Ge(c,d,s);break;case 270:o=Ge(o,d,n),c=Ge(c,0,s-h);break}this.x=o/=n,this.y=c/=s;const[f,g]=this.getBaseTranslation();o+=f,c+=g,e.left=`${(100*o).toFixed(2)}%`,e.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#O(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return dt.#O(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return dt.#O(t,e,360-this.parentRotation)}#x(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(t,e){const[n,s]=this.parentDimensions,{style:o}=this.div;o.width=`${(100*t/n).toFixed(2)}%`,this.#o||(o.height=`${(100*e/s).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:n}=t,s=n.endsWith("%"),o=!this.#o&&e.endsWith("%");if(s&&o)return;const[c,h]=this.parentDimensions;s||(t.width=`${(100*parseFloat(n)/c).toFixed(2)}%`),!this.#o&&!o&&(t.height=`${(100*parseFloat(e)/h).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#D(){if(this.#l)return;this.#l=document.createElement("div"),this.#l.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const s=document.createElement("div");this.#l.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#I.bind(this,n),{signal:e}),s.addEventListener("contextmenu",Rn,{signal:e}),s.tabIndex=-1}this.div.prepend(this.#l)}#I(t,e){e.preventDefault();const{isMac:n}=Pe.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#n?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#c=[e.screenX,e.screenY];const o=new AbortController,c=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#P.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",ge,{passive:!1,signal:c}),window.addEventListener("contextmenu",Rn,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const h=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=h,this.div.style.cursor=d,this.#L()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#k(t,e,n,s){this.width=n,this.height=s,this.x=t,this.y=e;const[o,c]=this.parentDimensions;this.setDims(o*n,c*s),this.fixAndSetPosition(),this._onResized()}_onResized(){}#L(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:s}=this.#d;this.#d=null;const o=this.x,c=this.y,h=this.width,d=this.height;o===t&&c===e&&h===n&&d===s||this.addCommands({cmd:this.#k.bind(this,o,c,h,d),undo:this.#k.bind(this,t,e,n,s),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#P(t,e){const[n,s]=this.parentDimensions,o=this.x,c=this.y,h=this.width,d=this.height,f=dt.MIN_SIZE/n,g=dt.MIN_SIZE/s,_=this.#x(this.rotation),y=(k,U)=>[_[0]*k+_[2]*U,_[1]*k+_[3]*U],b=this.#x(360-this.rotation),A=(k,U)=>[b[0]*k+b[2]*U,b[1]*k+b[3]*U];let S,w,C=!1,D=!1;switch(t){case"topLeft":C=!0,S=(k,U)=>[0,0],w=(k,U)=>[k,U];break;case"topMiddle":S=(k,U)=>[k/2,0],w=(k,U)=>[k/2,U];break;case"topRight":C=!0,S=(k,U)=>[k,0],w=(k,U)=>[0,U];break;case"middleRight":D=!0,S=(k,U)=>[k,U/2],w=(k,U)=>[0,U/2];break;case"bottomRight":C=!0,S=(k,U)=>[k,U],w=(k,U)=>[0,0];break;case"bottomMiddle":S=(k,U)=>[k/2,U],w=(k,U)=>[k/2,0];break;case"bottomLeft":C=!0,S=(k,U)=>[0,U],w=(k,U)=>[k,0];break;case"middleLeft":D=!0,S=(k,U)=>[0,U/2],w=(k,U)=>[k,U/2];break}const x=S(h,d),I=w(h,d);let O=y(...I);const P=dt._round(o+O[0]),G=dt._round(c+O[1]);let Y=1,j=1,at,nt;if(e.fromKeyboard)({deltaX:at,deltaY:nt}=e);else{const{screenX:k,screenY:U}=e,[it,bt]=this.#c;[at,nt]=this.screenToPageTranslation(k-it,U-bt),this.#c[0]=k,this.#c[1]=U}if([at,nt]=A(at/n,nt/s),C){const k=Math.hypot(h,d);Y=j=Math.max(Math.min(Math.hypot(I[0]-x[0]-at,I[1]-x[1]-nt)/k,1/h,1/d),f/h,g/d)}else D?Y=Ge(Math.abs(I[0]-x[0]-at),f,1)/h:j=Ge(Math.abs(I[1]-x[1]-nt),g,1)/d;const pt=dt._round(h*Y),et=dt._round(d*j);O=y(...w(pt,et));const Et=P-O[0],St=G-O[1];this.#p||=[this.x,this.y,this.width,this.height],this.width=pt,this.height=et,this.x=Et,this.y=St,this.setDims(n*pt,s*et),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#m)return this._editToolbar;this._editToolbar=new yo(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#n?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(Zn.initialize(dt._l10n),this.#n=new Zn(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}addCommentButton(){return this.#i?this.#i:this.#i=new hc(this)}get commentColor(){return null}get comment(){const t=this.#i;return{text:t.data.text,date:t.data.date,deleted:t.isDeleted(),color:this.commentColor}}set comment(t){this.#i||(this.#i=new hc(this)),this.#i.data=t}setCommentData(t){this.#i||(this.#i=new hc(this)),this.#i.setInitialText(t)}get hasEditedComment(){return this.#i?.hasBeenEdited()}async editComment(){this.#i||(this.#i=new hc(this)),this.#i.edit()}addComment(t){if(this.hasEditedComment){const[,,,s]=t.rect,[o]=this.pageDimensions,[c]=this.pageTranslation,h=c+o+1,d=s-100,f=h+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[h,d,f,s]}}}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#U();const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),bv(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#E||=new eu({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#N.bind(this),onPinching:this.#H.bind(this),onPinchEnd:this.#C.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#N(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#H(t,e,n){let o=.7*(n/e)+1-.7;if(o===1)return;const c=this.#x(this.rotation),h=(P,G)=>[c[0]*P+c[2]*G,c[1]*P+c[3]*G],[d,f]=this.parentDimensions,g=this.x,_=this.y,y=this.width,b=this.height,A=dt.MIN_SIZE/d,S=dt.MIN_SIZE/f;o=Math.max(Math.min(o,1/y,1/b),A/y,S/b);const w=dt._round(y*o),C=dt._round(b*o);if(w===y&&C===b)return;this.#p||=[g,_,y,b];const D=h(y/2,b/2),x=dt._round(g+D[0]),I=dt._round(_+D[1]),O=h(w/2,C/2);this.x=x-O[0],this.y=I-O[1],this.width=w,this.height=C,this.setDims(d*w,f*C),this.fixAndSetPosition(),this._onResizing()}#C(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#L()}pointerdown(t){const{isMac:e}=Pe.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#z(t);return}this.#v(t)}#v(t){const{isMac:e}=Pe.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#z(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s),c={capture:!0,passive:!1,signal:o},h=f=>{s.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#v(f),n&&this._onStopDragging()};e&&(this.#A=t.clientX,this.#S=t.clientY,this.#s=t.pointerId,this.#r=t.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._onStartDragging());const{clientX:g,clientY:_,pointerId:y}=f;if(y!==this.#s){ge(f);return}const[b,A]=this.screenToPageTranslation(g-this.#A,_-this.#S);this.#A=g,this.#S=_,this._uiManager.dragSelectedEditors(b,A)},c),window.addEventListener("touchmove",ge,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#r&&(this.#E||f.isPrimary)&&h(f),ge(f)},c));const d=f=>{if(!this.#s||this.#s===f.pointerId){h(f);return}ge(f)};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#_&&clearTimeout(this.#_),this.#_=setTimeout(()=>{this.#_=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const s=this.parentScale,[o,c]=this.pageDimensions,[h,d]=this.pageTranslation,f=t/s,g=e/s,_=this.x*o,y=this.y*c,b=this.width*o,A=this.height*c;switch(n){case 0:return[_+f+h,c-y-g-A+d,_+f+b+h,c-y-g+d];case 90:return[_+g+h,c-y+f+d,_+g+A+h,c-y+f+b+d];case 180:return[_-f-b+h,c-y+g+d,_-f+h,c-y+g+A+d];case 270:return[_-g-A+h,c-y-f-b+d,_-g+h,c-y-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,s,o,c]=t,h=o-n,d=c-s;switch(this.rotation){case 0:return[n,e-c,h,d];case 90:return[n,e-s,d,h];case 180:return[o,e-s,h,d];case 270:return[o,e-c,d,h];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:o,innerWidth:c}=window;return e<c&&s>0&&t<o&&n>0}#U(){if(this.#u||!this.div)return;this.#u=new AbortController;const t=this._uiManager.combinedSignal(this.#u);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#U()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){Vt("An editor must be serializable")}static async deserialize(t,e,n){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId});s.rotation=t.rotation,s.#t=t.accessibilityData,s._isCopy=t.isCopy||!1;const[o,c]=s.pageDimensions,[h,d,f,g]=s.getRectInCurrentCoords(t.rect,c);return s.x=h/o,s.y=d/c,s.width=f/o,s.height=g/c,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#u?.abort(),this.#u=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#_&&(clearTimeout(this.#_),this.#_=null),this.#B(),this.removeEditToolbar(),this.#y){for(const t of this.#y.values())clearTimeout(t);this.#y=null}this.parent=null,this.#E?.destroy(),this.#E=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#D(),this.#l.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#l.children;if(!this.#e){this.#e=Array.from(e);const c=this.#G.bind(this),h=this.#$.bind(this),d=this._uiManager._signal;for(const f of this.#e){const g=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:d}),f.addEventListener("blur",h,{signal:d}),f.addEventListener("focus",this.#Y.bind(this,g),{signal:d}),f.setAttribute("data-l10n-id",dt._l10nResizer[g])}}const n=this.#e[0];let s=0;for(const c of e){if(c===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(o!==s){if(o<s)for(let h=0;h<s-o;h++)this.#l.append(this.#l.firstChild);else if(o>s)for(let h=0;h<o-s;h++)this.#l.firstChild.before(this.#l.lastChild);let c=0;for(const h of e){const f=this.#e[c++].getAttribute("data-resizer-name");h.setAttribute("data-l10n-id",dt._l10nResizer[f])}}this.#X(0),this.#b=!0,this.#l.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#G(t){dt._resizerKeyboardManager.exec(this,t)}#$(t){this.#b&&t.relatedTarget?.parentNode!==this.#l&&this.#B()}#Y(t){this.#f=this.#b?t:""}#X(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#b&&this.#P(this.#f,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#b=!1,this.#X(-1),this.#L()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#l?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#h}set isEditing(t){this.#h=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#o=!0;const n=t/e,{style:s}=this.div;s.aspectRatio=n,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#y||=new Map;const{action:n}=t;let s=this.#y.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),this.#y.delete(n),this.#y.size===0&&(this.#y=null)},dt._telemetryTimeout),this.#y.set(n,s);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class _1 extends dt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Wy=3285377520,wn=4294901760,Yn=65535;class vv{constructor(t){this.h1=t?t&4294967295:Wy,this.h2=t?t&4294967295:Wy}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let S=0,w=t.length;S<w;S++){const C=t.charCodeAt(S);C<=255?e[n++]=C:(e[n++]=C>>>8,e[n++]=C&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,c=new Uint32Array(e.buffer,0,s);let h=0,d=0,f=this.h1,g=this.h2;const _=3432918353,y=461845907,b=_&Yn,A=y&Yn;for(let S=0;S<s;S++)S&1?(h=c[S],h=h*_&wn|h*b&Yn,h=h<<15|h>>>17,h=h*y&wn|h*A&Yn,f^=h,f=f<<13|f>>>19,f=f*5+3864292196):(d=c[S],d=d*_&wn|d*b&Yn,d=d<<15|d>>>17,d=d*y&wn|d*A&Yn,g^=d,g=g<<13|g>>>19,g=g*5+3864292196);switch(h=0,o){case 3:h^=e[s*4+2]<<16;case 2:h^=e[s*4+1]<<8;case 1:h^=e[s*4],h=h*_&wn|h*b&Yn,h=h<<15|h>>>17,h=h*y&wn|h*A&Yn,s&1?f^=h:g^=h}this.h1=f,this.h2=g}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&wn|t*36045&Yn,e=e*4283543511&wn|((e<<16|t>>>16)*2950163797&wn)>>>16,t^=e>>>1,t=t*444984403&wn|t*60499&Yn,e=e*3301882366&wn|((e<<16|t>>>16)*3120437893&wn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const lf=Object.freeze({map:null,hash:"",transfer:void 0});class Xf{#t=!1;#e=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=this.#n.get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return this.#n.get(t)}remove(t){if(this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#n.values())if(e instanceof dt)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=this.#n.get(t);let s=!1;if(n!==void 0)for(const[o,c]of Object.entries(e))n[o]!==c&&(s=!0,n[o]=c);else s=!0,this.#n.set(t,e);s&&this.#i(),e instanceof dt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#n.has(t)}get size(){return this.#n.size}#i(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Av(this)}get serializable(){if(this.#n.size===0)return lf;const t=new Map,e=new vv,n=[],s=Object.create(null);let o=!1;for(const[c,h]of this.#n){const d=h instanceof dt?h.serialize(!1,s):h;d&&(t.set(c,d),e.update(`${c}:${JSON.stringify(d)}`),o||=!!d.bitmap)}if(o)for(const c of t.values())c.bitmap&&n.push(c.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:lf}get editorStats(){let t=null;const e=new Map;for(const n of this.#n.values()){if(!(n instanceof dt))continue;const s=n.telemetryFinalData;if(!s)continue;const{type:o}=s;e.has(o)||e.set(o,Object.getPrototypeOf(n).constructor),t||=Object.create(null);const c=t[o]||=new Map;for(const[h,d]of Object.entries(s)){if(h==="type")continue;let f=c.get(h);f||(f=new Map,c.set(h,f));const g=f.get(d)??0;f.set(d,g+1)}}for(const[n,s]of e)t[n]=s.computeTelemetryFinalData(t[n]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#n.values())!(e instanceof dt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class Av extends Xf{#t;constructor(t){super();const{map:e,hash:n,transfer:s}=t.serializable,o=structuredClone(e,s?{transfer:s}:null);this.#t={map:o,hash:n,transfer:s}}get print(){Vt("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return Rt(this,"modifiedIds",{ids:new Set,hash:""})}}class y1{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||this.#t.has(t.loadedName))){if(me(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:o,style:c}=t,h=new FontFace(s,o,c);this.addNativeFontFace(h);try{await h.load(),this.#t.add(s),n?.(t)}catch{At(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(h)}return}Vt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw At(`Failed to load font '${n.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return Rt(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Rt(this,"isSyncFontLoadingSupported",je||Pe.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(me(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:e,callback:t};return n.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Rt(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(I,O){return I.charCodeAt(O)<<24|I.charCodeAt(O+1)<<16|I.charCodeAt(O+2)<<8|I.charCodeAt(O+3)&255}function s(I,O,P,G){const Y=I.substring(0,O),j=I.substring(O+P);return Y+G+j}let o,c;const h=this._document.createElement("canvas");h.width=1,h.height=1;const d=h.getContext("2d");let f=0;function g(I,O){if(++f>30){At("Load test font never loaded."),O();return}if(d.font="30px "+I,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){O();return}setTimeout(g.bind(null,I,O))}const _=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=s(y,976,_.length,_);const A=16,S=1482184792;let w=n(y,A);for(o=0,c=_.length-3;o<c;o+=4)w=w-S+n(_,o)|0;o<_.length&&(w=w-S+n(_+"XXX",o)|0),y=s(y,A,4,n1(w));const C=`url(data:font/opentype;base64,${btoa(y)});`,D=`@font-face {font-family:"${_}";src:${C}}`;this.insertRule(D);const x=this._document.createElement("div");x.style.visibility="hidden",x.style.width=x.style.height="10px",x.style.position="absolute",x.style.top=x.style.left="0px";for(const I of[t.loadedName,_]){const O=this._document.createElement("span");O.textContent="Hi",O.style.fontFamily=I,x.append(O)}this._document.body.append(x),g(_,()=>{x.remove(),e.complete()})}}class b1{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const n in t)this[n]=t[n];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${yv(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let s;try{s=t.get(n)}catch(c){At(`getPathGenerator - ignoring character: "${c}".`)}const o=new Path2D(s||"");return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=o}}function v1(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(je)return r;const t=URL.parse(r,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function A1(r){if(je&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return Ho(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function fc(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const cf=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,S1=r=>typeof r=="object"&&typeof r?.name=="string",E1=o1.bind(null,cf,S1);class w1{#t=new Map;#e=Promise.resolve();postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[s]of this.#t)s.call(this,n)})}addEventListener(t,e,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:o}=n;if(o.aborted){At("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,e);s=()=>o.removeEventListener("abort",c),o.addEventListener("abort",c)}this.#t.set(e,s)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const pc={DATA:1,ERROR:2},fe={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Ky(){}function Je(r){if(r instanceof ts||r instanceof af||r instanceof Yy||r instanceof xc||r instanceof Bd)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Vt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new ts(r.message);case"InvalidPDFException":return new af(r.message);case"PasswordException":return new Yy(r.message,r.code);case"ResponseException":return new xc(r.message,r.status,r.missing);case"UnknownErrorException":return new Bd(r.message,r.details)}return new Bd(r.message,r.toString())}class mo{#t=new AbortController;constructor(t,e,n){this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const n=t.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===pc.DATA)s.resolve(t.data);else if(t.callback===pc.ERROR)s.reject(Je(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,s=t.sourceName,o=this.comObj;Promise.try(e,t.data).then(function(c){o.postMessage({sourceName:n,targetName:s,callback:pc.DATA,callbackId:t.callbackId,data:c})},function(c){o.postMessage({sourceName:n,targetName:s,callback:pc.ERROR,callbackId:t.callbackId,reason:Je(c)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},n)}catch(c){o.reject(c)}return o.promise}sendWithStream(t,e,n,s){const o=this.streamId++,c=this.sourceName,h=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const g=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:g,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:c,targetName:h,action:t,streamId:o,data:e,desiredSize:f.desiredSize},s),g.promise},pull:f=>{const g=Promise.withResolvers();return this.streamControllers[o].pullCall=g,d.postMessage({sourceName:c,targetName:h,stream:fe.PULL,streamId:o,desiredSize:f.desiredSize}),g.promise},cancel:f=>{me(f instanceof Error,"cancel must have a valid reason");const g=Promise.withResolvers();return this.streamControllers[o].cancelCall=g,this.streamControllers[o].isClosed=!0,d.postMessage({sourceName:c,targetName:h,stream:fe.CANCEL,streamId:o,reason:Je(f)}),g.promise}},n)}#n(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,o=this.comObj,c=this,h=this.actionHandler[t.action],d={enqueue(f,g=1,_){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=g,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:fe.ENQUEUE,streamId:e,chunk:f},_)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:fe.CLOSE,streamId:e}),delete c.streamSinks[e])},error(f){me(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:fe.ERROR,streamId:e,reason:Je(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(h,t.data,d).then(function(){o.postMessage({sourceName:n,targetName:s,stream:fe.START_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:fe.START_COMPLETE,streamId:e,reason:Je(f)})})}#i(t){const e=t.streamId,n=this.sourceName,s=t.sourceName,o=this.comObj,c=this.streamControllers[e],h=this.streamSinks[e];switch(t.stream){case fe.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(Je(t.reason));break;case fe.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(Je(t.reason));break;case fe.PULL:if(!h){o.postMessage({sourceName:n,targetName:s,stream:fe.PULL_COMPLETE,streamId:e,success:!0});break}h.desiredSize<=0&&t.desiredSize>0&&h.sinkCapability.resolve(),h.desiredSize=t.desiredSize,Promise.try(h.onPull||Ky).then(function(){o.postMessage({sourceName:n,targetName:s,stream:fe.PULL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:fe.PULL_COMPLETE,streamId:e,reason:Je(f)})});break;case fe.ENQUEUE:if(me(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case fe.CLOSE:if(me(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#a(c,e);break;case fe.ERROR:me(c,"error should have stream controller"),c.controller.error(Je(t.reason)),this.#a(c,e);break;case fe.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(Je(t.reason)),this.#a(c,e);break;case fe.CANCEL:if(!h)break;const d=Je(t.reason);Promise.try(h.onCancel||Ky,d).then(function(){o.postMessage({sourceName:n,targetName:s,stream:fe.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:fe.CANCEL_COMPLETE,streamId:e,reason:Je(f)})}),h.sinkCapability.reject(d),h.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Sv{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Vt("Abstract method `_createCanvas` called.")}}class C1 extends Sv{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class Ev{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class Qy extends Ev{async _fetch(t){const e=await zo(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Ho(e)}}class wv{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,s,o){return"none"}destroy(t=!1){}}class T1 extends wv{#t;#e;#n;#i;#a;#s;#r=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#a=e}get#o(){return this.#e||=new Map}get#l(){return this.#s||=new Map}get#c(){if(!this.#n){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const n=this.#a.createElementNS(_i,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#a.createElementNS(_i,"defs"),t.append(n),n.append(this.#n),this.#a.body.append(t)}return this.#n}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let _=0;_<256;_++)f[_]=d[_]/255;const g=f.join(",");return[g,g,g]}const[e,n,s]=t,o=new Array(256),c=new Array(256),h=new Array(256);for(let d=0;d<256;d++)o[d]=e[d]/255,c[d]=n[d]/255,h[d]=s[d]/255;return[o.join(","),c.join(","),h.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(Jc(e)?At('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=gv(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[n,s,o]=this.#d(t),c=t.length===1?n:`${n}${s}${o}`;if(e=this.#o.get(c),e)return this.#o.set(t,e),e;const h=`g_${this.#i}_transfer_map_${this.#r++}`,d=this.#u(h);this.#o.set(t,d),this.#o.set(c,d);const f=this.#p(h);return this.#m(n,s,o,f),d}addHCMFilter(t,e){const n=`${t}-${e}`,s="base";let o=this.#l.get(s);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#l.set(s,o)),!t||!e))return o.url;const c=this.#_(t);t=ct.makeHexColor(...c);const h=this.#_(e);if(e=ct.makeHexColor(...h),this.#c.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return o.url;const d=new Array(256);for(let b=0;b<=255;b++){const A=b/255;d[b]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const f=d.join(","),g=`g_${this.#i}_hcm_filter`,_=o.filter=this.#p(g);this.#m(f,f,f,_),this.#g(_);const y=(b,A)=>{const S=c[b]/255,w=h[b]/255,C=new Array(A+1);for(let D=0;D<=A;D++)C[D]=S+D/A*(w-S);return C.join(",")};return this.#m(y(0,5),y(1,5),y(2,5),_),o.url=this.#u(g),o.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[n]=this.#d([t]),s=`alpha_${n}`;if(e=this.#o.get(s),e)return this.#o.set(t,e),e;const o=`g_${this.#i}_alpha_map_${this.#r++}`,c=this.#u(o);this.#o.set(t,c),this.#o.set(s,c);const h=this.#p(o);return this.#b(n,h),c}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let n,s;if(t?([n]=this.#d([t]),s=`luminosity_${n}`):s="luminosity",e=this.#o.get(s),e)return this.#o.set(t,e),e;const o=`g_${this.#i}_luminosity_map_${this.#r++}`,c=this.#u(o);this.#o.set(t,c),this.#o.set(s,c);const h=this.#p(o);return this.#f(h),t&&this.#b(n,h),c}addHighlightHCMFilter(t,e,n,s,o){const c=`${e}-${n}-${s}-${o}`;let h=this.#l.get(t);if(h?.key===c||(h?(h.filter?.remove(),h.key=c,h.url="none",h.filter=null):(h={key:c,url:"none",filter:null},this.#l.set(t,h)),!e||!n))return h.url;const[d,f]=[e,n].map(this.#_.bind(this));let g=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),_=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[y,b]=[s,o].map(this.#_.bind(this));_<g&&([g,_,y,b]=[_,g,b,y]),this.#c.style.color="";const A=(C,D,x)=>{const I=new Array(256),O=(_-g)/x,P=C/255,G=(D-C)/(255*x);let Y=0;for(let j=0;j<=x;j++){const at=Math.round(g+j*O),nt=P+j*G;for(let pt=Y;pt<=at;pt++)I[pt]=nt;Y=at+1}for(let j=Y;j<256;j++)I[j]=I[Y-1];return I.join(",")},S=`g_${this.#i}_hcm_${t}_filter`,w=h.filter=this.#p(S);return this.#g(w),this.#m(A(y[0],b[0],5),A(y[1],b[1],5),A(y[2],b[2],5),w),h.url=this.#u(S),h.url}destroy(t=!1){t&&this.#s?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#s?.clear(),this.#s=null,this.#r=0)}#f(t){const e=this.#a.createElementNS(_i,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#a.createElementNS(_i,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#a.createElementNS(_i,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#c.append(e),e}#h(t,e,n){const s=this.#a.createElementNS(_i,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),t.append(s)}#m(t,e,n,s){const o=this.#a.createElementNS(_i,"feComponentTransfer");s.append(o),this.#h(o,"feFuncR",t),this.#h(o,"feFuncG",e),this.#h(o,"feFuncB",n)}#b(t,e){const n=this.#a.createElementNS(_i,"feComponentTransfer");e.append(n),this.#h(n,"feFuncA",t)}#_(t){return this.#c.style.color=t,tu(getComputedStyle(this.#c).getPropertyValue("color"))}}class Cv{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class Zy extends Cv{async _fetch(t){const e=await zo(t,"arraybuffer");return new Uint8Array(e)}}class Tv{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Vt("Abstract method `_fetch` called.")}}class Jy extends Tv{async _fetch(t){const e=await zo(t,"arraybuffer");return new Uint8Array(e)}}je&&At("Please use the `legacy` build in Node.js environments.");async function $f(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class x1 extends wv{}class R1 extends Sv{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class D1 extends Ev{async _fetch(t){return $f(t)}}class M1 extends Cv{async _fetch(t){return $f(t)}}class N1 extends Tv{async _fetch(t){return $f(t)}}const Ma="__forcedDependency";class O1{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Ma]:[]};#n=new Map;#i=[];#a=[];#s=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#l=-1;#c=new Set;#d=new Map;#u=new Map;#f;#g;constructor(t){this.#f=t.width,this.#g=t.height}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Ma]:{__proto__:this.#e[Ma]}},this.#r={__proto__:this.#r},this.#i.push([t,null]),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#r=Object.getPrototypeOf(this.#r);const n=this.#i.pop();return n!==void 0&&(n[1]=t),this}recordOpenMarker(t){return this.#i.push([t,null]),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)[0]}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(e[1]=t),this}beginMarkedContent(t){return this.#a.push([t,null]),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(e[1]=t),this}pushBaseTransform(t){return this.#s.push(ct.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#n.set(t,e),this}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Ma,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#c)this.recordFutureForcedDependency(Ma,t);return this}resetBBox(t){return this.#l=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0,this}get hasPendingBBox(){return this.#l!==-1}recordClipBox(t,e,n,s,o,c){const h=ct.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];ct.axialAlignedBoundingBox([n,o,s,c],h,d);const f=ct.intersect(this.#r,d);return f?(this.#r[0]=f[0],this.#r[1]=f[1],this.#r[2]=f[2],this.#r[3]=f[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(t,e,n,s,o,c){const h=this.#r;if(h[0]===1/0)return this;const d=ct.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform());if(h[0]===-1/0)return ct.axialAlignedBoundingBox([n,o,s,c],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return ct.axialAlignedBoundingBox([n,o,s,c],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],h[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],h[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],h[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],h[3])),this}recordCharacterBBox(t,e,n,s=1,o=0,c=0,h){const d=n.bbox;let f,g;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#u.get(n),f!==!1&&(g=[0,0,0,0],ct.axialAlignedBoundingBox(d,n.fontMatrix,g),(s!==1||o!==0||c!==0)&&ct.scaleMinMax([s,0,0,-s,o,c],g),f)))return this.recordBBox(t,e,g[0],g[2],g[1],g[3]);if(!h)return this.recordFullPageBBox(t);const _=h();return d&&g&&f===void 0&&(f=g[0]<=o-_.actualBoundingBoxLeft&&g[2]>=o+_.actualBoundingBoxRight&&g[1]<=c-_.actualBoundingBoxAscent&&g[3]>=c+_.actualBoundingBoxDescent,this.#u.set(n,f),f)?this.recordBBox(t,e,g[0],g[2],g[1],g[3]):this.recordBBox(t,e,o-_.actualBoundingBoxLeft,o+_.actualBoundingBoxRight,c-_.actualBoundingBoxAscent,c+_.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#g,this.#r[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const n=this.#c,s=this.#t,o=this.#e;for(const c of e)c in this.#t?n.add(s[c]):c in o&&o[c].forEach(n.add,n);return this}copyDependenciesFromIncrementalOperation(t,e){const n=this.#d,s=this.#c;for(const o of this.#e[e])n.get(o).dependencies.forEach(s.add,s.add(o));return this}recordNamedDependency(t,e){return this.#n.has(e)&&this.#c.add(this.#n.get(e)),this}recordOperation(t,e=!1){this.recordDependencies(t,[Ma]);const n=new Set(this.#c),s=this.#i.concat(this.#a),o=this.#l===t?{minX:this.#o[0],minY:this.#o[1],maxX:this.#o[2],maxY:this.#o[3]}:null;return this.#d.set(t,{bbox:o,pairs:s,dependencies:n}),e||(this.#l=-1),this.#c.clear(),this}bboxToClipBoxDropOperation(t){return this.#l!==-1&&(this.#l=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3])),this.#c.clear(),this}_takePendingDependencies(){const t=this.#c;return this.#c=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#c.add(e)}take(){return this.#u.clear(),Array.from(this.#d,([t,{bbox:e,pairs:n,dependencies:s}])=>(n.forEach(o=>o.forEach(s.add,s)),s.delete(t),{minX:(e?.minX??0)/this.#f,maxX:(e?.maxX??this.#f)/this.#f,minY:(e?.minY??0)/this.#g,maxY:(e?.maxY??this.#g)/this.#g,dependencies:Array.from(s).sort((o,c)=>o-c),idx:t}))}}class Rc{#t;#e;#n=0;#i;#a=0;constructor(t,e){if(t instanceof Rc)return t;this.#t=t,this.#i=t._takePendingDependencies(),this.#e=e}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#t.hasPendingBBox||this.#t.resetBBox(this.#e),this}get hasPendingBBox(){return this.#t.hasPendingBBox}recordClipBox(t,e,n,s,o,c){return this.#t.recordClipBox(this.#e,e,n,s,o,c),this}recordBBox(t,e,n,s,o,c){return this.#t.recordBBox(this.#e,e,n,s,o,c),this}recordCharacterBBox(t,e,n,s,o,c,h){return this.#t.recordCharacterBBox(this.#e,e,n,s,o,c,h),this}recordFullPageBBox(t){return this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}copyDependenciesFromIncrementalOperation(t,e){return this.#t.copyDependenciesFromIncrementalOperation(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){this.#t.recordOperation(this.#e,!0);const e=this.#t._extractOperation(this.#e);for(const n of e.dependencies)this.#i.add(n);return this.#i.delete(this.#e),this.#i.delete(null),this}bboxToClipBoxDropOperation(t){return this.#t.bboxToClipBoxDropOperation(this.#e),this}recordNestedDependencies(){this.#t._pushPendingDependencies(this.#i)}take(){throw new Error("Unreachable")}}const Cn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation"],transform:["transform"],transformAndFill:["transform","fillColor"]},Ie={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function uf(r,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,n),r.clip(s)}class Wf{isModifyingCurrentTransform(){return!1}getPattern(){Vt("Abstract method `getPattern` called.")}}class k1 extends Wf{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)e.addColorStop(n[0],n[1]);return e}getPattern(t,e,n,s){let o;if(s===Ie.STROKE||s===Ie.FILL){const c=e.current.getClippedPathBoundingBox(s,ee(t))||[0,0,0,0],h=Math.ceil(c[2]-c[0])||1,d=Math.ceil(c[3]-c[1])||1,f=e.cachedCanvases.getCanvas("pattern",h,d),g=f.context;g.clearRect(0,0,g.canvas.width,g.canvas.height),g.beginPath(),g.rect(0,0,g.canvas.width,g.canvas.height),g.translate(-c[0],-c[1]),n=ct.transform(n,[1,0,0,1,c[0],c[1]]),g.transform(...e.baseTransform),this.matrix&&g.transform(...this.matrix),uf(g,this._bbox),g.fillStyle=this._createGradient(g),g.fill(),o=t.createPattern(f.canvas,"no-repeat");const _=new DOMMatrix(n);o.setTransform(_)}else uf(t,this._bbox),o=this._createGradient(t);return o}}function zd(r,t,e,n,s,o,c,h){const d=t.coords,f=t.colors,g=r.data,_=r.width*4;let y;d[e+1]>d[n+1]&&(y=e,e=n,n=y,y=o,o=c,c=y),d[n+1]>d[s+1]&&(y=n,n=s,s=y,y=c,c=h,h=y),d[e+1]>d[n+1]&&(y=e,e=n,n=y,y=o,o=c,c=y);const b=(d[e]+t.offsetX)*t.scaleX,A=(d[e+1]+t.offsetY)*t.scaleY,S=(d[n]+t.offsetX)*t.scaleX,w=(d[n+1]+t.offsetY)*t.scaleY,C=(d[s]+t.offsetX)*t.scaleX,D=(d[s+1]+t.offsetY)*t.scaleY;if(A>=D)return;const x=f[o],I=f[o+1],O=f[o+2],P=f[c],G=f[c+1],Y=f[c+2],j=f[h],at=f[h+1],nt=f[h+2],pt=Math.round(A),et=Math.round(D);let Et,St,k,U,it,bt,R,$;for(let J=pt;J<=et;J++){if(J<w){const Z=J<A?0:(A-J)/(A-w);Et=b-(b-S)*Z,St=x-(x-P)*Z,k=I-(I-G)*Z,U=O-(O-Y)*Z}else{let Z;J>D?Z=1:w===D?Z=0:Z=(w-J)/(w-D),Et=S-(S-C)*Z,St=P-(P-j)*Z,k=G-(G-at)*Z,U=Y-(Y-nt)*Z}let N;J<A?N=0:J>D?N=1:N=(A-J)/(A-D),it=b-(b-C)*N,bt=x-(x-j)*N,R=I-(I-at)*N,$=O-(O-nt)*N;const q=Math.round(Math.min(Et,it)),K=Math.round(Math.max(Et,it));let Q=_*J+q*4;for(let Z=q;Z<=K;Z++)N=(Et-Z)/(Et-it),N<0?N=0:N>1&&(N=1),g[Q++]=St-(St-bt)*N|0,g[Q++]=k-(k-R)*N|0,g[Q++]=U-(U-$)*N|0,g[Q++]=255}}function L1(r,t,e){const n=t.coords,s=t.colors;let o,c;switch(t.type){case"lattice":const h=t.verticesPerRow,d=Math.floor(n.length/h)-1,f=h-1;for(o=0;o<d;o++){let g=o*h;for(let _=0;_<f;_++,g++)zd(r,e,n[g],n[g+1],n[g+h],s[g],s[g+1],s[g+h]),zd(r,e,n[g+h+1],n[g+1],n[g+h],s[g+h+1],s[g+1],s[g+h])}break;case"triangles":for(o=0,c=n.length;o<c;o+=3)zd(r,e,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class I1 extends Wf{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const h=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-h,g=Math.ceil(this._bounds[3])-d,_=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(g*t[1]*1.1)),3e3),b=f/_,A=g/y,S={coords:this._coords,colors:this._colors,offsetX:-h,offsetY:-d,scaleX:1/b,scaleY:1/A},w=_+4,C=y+4,D=n.getCanvas("mesh",w,C),x=D.context,I=x.createImageData(_,y);if(e){const P=I.data;for(let G=0,Y=P.length;G<Y;G+=4)P[G]=e[0],P[G+1]=e[1],P[G+2]=e[2],P[G+3]=255}for(const P of this._figures)L1(I,P,S);return x.putImageData(I,2,2),{canvas:D.canvas,offsetX:h-2*b,offsetY:d-2*A,scaleX:b,scaleY:A}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,s){uf(t,this._bbox);const o=new Float32Array(2);if(s===Ie.SHADING)ct.singularValueDecompose2dScale(ee(t),o);else if(this.matrix){ct.singularValueDecompose2dScale(this.matrix,o);const[h,d]=o;ct.singularValueDecompose2dScale(e.baseTransform,o),o[0]*=h,o[1]*=d}else ct.singularValueDecompose2dScale(e.baseTransform,o);const c=this._createMeshCanvas(o,s===Ie.SHADING?null:this._background,e.cachedCanvases);return s!==Ie.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class P1 extends Wf{getPattern(){return"hotpink"}}function B1(r){switch(r[0]){case"RadialAxial":return new k1(r);case"Mesh":return new I1(r);case"Dummy":return new P1}throw new Error(`Unknown IR type: ${r[0]}`)}const tb={COLORED:1,UNCOLORED:2};class Kf{static MAX_PATTERN_SIZE=3e3;constructor(t,e,n,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(t){const{bbox:e,operatorList:n,paintType:s,tilingType:o,color:c,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:f}=this;d=Math.abs(d),f=Math.abs(f),Zc("TilingType: "+o);const g=e[0],_=e[1],y=e[2],b=e[3],A=y-g,S=b-_,w=new Float32Array(2);ct.singularValueDecompose2dScale(this.matrix,w);const[C,D]=w;ct.singularValueDecompose2dScale(this.baseTransform,w);const x=C*w[0],I=D*w[1];let O=A,P=S,G=!1,Y=!1;const j=Math.ceil(d*x),at=Math.ceil(f*I),nt=Math.ceil(A*x),pt=Math.ceil(S*I);j>=nt?O=d:G=!0,at>=pt?P=f:Y=!0;const et=this.getSizeAndScale(O,this.ctx.canvas.width,x),Et=this.getSizeAndScale(P,this.ctx.canvas.height,I),St=t.cachedCanvases.getCanvas("pattern",et.size,Et.size),k=St.context,U=h.createCanvasGraphics(k);if(U.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(U,s,c),k.translate(-et.scale*g,-Et.scale*_),U.transform(0,et.scale,0,0,Et.scale,0,0),k.save(),U.dependencyTracker?.save(),this.clipBbox(U,g,_,y,b),U.baseTransform=ee(U.ctx),U.executeOperatorList(n),U.endDrawing(),U.dependencyTracker?.restore().recordNestedDependencies?.(),k.restore(),G||Y){const it=St.canvas;G&&(O=d),Y&&(P=f);const bt=this.getSizeAndScale(O,this.ctx.canvas.width,x),R=this.getSizeAndScale(P,this.ctx.canvas.height,I),$=bt.size,J=R.size,N=t.cachedCanvases.getCanvas("pattern-workaround",$,J),q=N.context,K=G?Math.floor(A/d):0,Q=Y?Math.floor(S/f):0;for(let Z=0;Z<=K;Z++)for(let rt=0;rt<=Q;rt++)q.drawImage(it,$*Z,J*rt,$,J,0,0,$,J);return{canvas:N.canvas,scaleX:bt.scale,scaleY:R.scale,offsetX:g,offsetY:_}}return{canvas:St.canvas,scaleX:et.scale,scaleY:Et.scale,offsetX:g,offsetY:_}}getSizeAndScale(t,e,n){const s=Math.max(Kf.MAX_PATTERN_SIZE,e);let o=Math.ceil(t*n);return o>=s?o=s:n=o/t,{scale:n,size:o}}clipBbox(t,e,n,s,o){const c=s-e,h=o-n;t.ctx.rect(e,n,c,h),ct.axialAlignedBoundingBox([e,n,s,o],ee(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const s=t.ctx,o=t.current;switch(e){case tb.COLORED:const{fillStyle:c,strokeStyle:h}=this.ctx;s.fillStyle=o.fillColor=c,s.strokeStyle=o.strokeColor=h;break;case tb.UNCOLORED:s.fillStyle=s.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new e1(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,s){let o=n;s!==Ie.SHADING&&(o=ct.transform(o,e.baseTransform),this.matrix&&(o=ct.transform(o,this.matrix)));const c=this.createPatternCanvas(e);let h=new DOMMatrix(o);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const d=t.createPattern(c.canvas,"repeat");return d.setTransform(h),d}}function F1({src:r,srcPos:t=0,dest:e,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:c=!1}){const h=Pe.isLittleEndian?4278190080:255,[d,f]=c?[o,h]:[h,o],g=n>>3,_=n&7,y=r.length;e=new Uint32Array(e.buffer);let b=0;for(let A=0;A<s;A++){for(const w=t+g;t<w;t++){const C=t<y?r[t]:255;e[b++]=C&128?f:d,e[b++]=C&64?f:d,e[b++]=C&32?f:d,e[b++]=C&16?f:d,e[b++]=C&8?f:d,e[b++]=C&4?f:d,e[b++]=C&2?f:d,e[b++]=C&1?f:d}if(_===0)continue;const S=t<y?r[t++]:255;for(let w=0;w<_;w++)e[b++]=S&1<<7-w?f:d}return{srcPos:t,destPos:b}}const eb=16,nb=100,H1=15,ib=10,tn=16,Ud=new DOMMatrix,pn=new Float32Array(2),Pa=new Float32Array([1/0,1/0,-1/0,-1/0]);function z1(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},r.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},r.transform=function(e,n,s,o,c,h){t.transform(e,n,s,o,c,h),this.__originalTransform(e,n,s,o,c,h)},r.setTransform=function(e,n,s,o,c,h){t.setTransform(e,n,s,o,c,h),this.__originalSetTransform(e,n,s,o,c,h)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(e){t.rotate(e),this.__originalRotate(e)},r.clip=function(e){t.clip(e),this.__originalClip(e)},r.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},r.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},r.bezierCurveTo=function(e,n,s,o,c,h){t.bezierCurveTo(e,n,s,o,c,h),this.__originalBezierCurveTo(e,n,s,o,c,h)},r.rect=function(e,n,s,o){t.rect(e,n,s,o),this.__originalRect(e,n,s,o)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class U1{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,n)):(s=this.canvasFactory.create(e,n),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function gc(r,t,e,n,s,o,c,h,d,f){const[g,_,y,b,A,S]=ee(r);if(_===0&&y===0){const D=c*g+A,x=Math.round(D),I=h*b+S,O=Math.round(I),P=(c+d)*g+A,G=Math.abs(Math.round(P)-x)||1,Y=(h+f)*b+S,j=Math.abs(Math.round(Y)-O)||1;return r.setTransform(Math.sign(g),0,0,Math.sign(b),x,O),r.drawImage(t,e,n,s,o,0,0,G,j),r.setTransform(g,_,y,b,A,S),[G,j]}if(g===0&&b===0){const D=h*y+A,x=Math.round(D),I=c*_+S,O=Math.round(I),P=(h+f)*y+A,G=Math.abs(Math.round(P)-x)||1,Y=(c+d)*_+S,j=Math.abs(Math.round(Y)-O)||1;return r.setTransform(0,Math.sign(_),Math.sign(y),0,x,O),r.drawImage(t,e,n,s,o,0,0,j,G),r.setTransform(g,_,y,b,A,S),[j,G]}r.drawImage(t,e,n,s,o,c,h,d,f);const w=Math.hypot(g,_),C=Math.hypot(y,b);return[w*d,C*f]}class sb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=sf;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=ke.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,n){n?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Pa.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ie.FILL,e=null){const n=this.minMax.slice();if(t===Ie.STROKE){e||Vt("Stroke bounding box must include transform."),ct.singularValueDecompose2dScale(e,pn);const s=pn[0]*this.lineWidth/2,o=pn[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const t=ct.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Pa,0)}getClippedPathBoundingBox(t=Ie.FILL,e=null){return ct.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function ab(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,n=t.width,s=e%tn,o=(e-s)/tn,c=s===0?o:o+1,h=r.createImageData(n,tn);let d=0,f;const g=t.data,_=h.data;let y,b,A,S;if(t.kind===Sc.GRAYSCALE_1BPP){const w=g.byteLength,C=new Uint32Array(_.buffer,0,_.byteLength>>2),D=C.length,x=n+7>>3,I=4294967295,O=Pe.isLittleEndian?4278190080:255;for(y=0;y<c;y++){for(A=y<o?tn:s,f=0,b=0;b<A;b++){const P=w-d;let G=0;const Y=P>x?n:P*8-7,j=Y&-8;let at=0,nt=0;for(;G<j;G+=8)nt=g[d++],C[f++]=nt&128?I:O,C[f++]=nt&64?I:O,C[f++]=nt&32?I:O,C[f++]=nt&16?I:O,C[f++]=nt&8?I:O,C[f++]=nt&4?I:O,C[f++]=nt&2?I:O,C[f++]=nt&1?I:O;for(;G<Y;G++)at===0&&(nt=g[d++],at=128),C[f++]=nt&at?I:O,at>>=1}for(;f<D;)C[f++]=0;r.putImageData(h,0,y*tn)}}else if(t.kind===Sc.RGBA_32BPP){for(b=0,S=n*tn*4,y=0;y<o;y++)_.set(g.subarray(d,d+S)),d+=S,r.putImageData(h,0,b),b+=tn;y<c&&(S=n*s*4,_.set(g.subarray(d,d+S)),r.putImageData(h,0,b))}else if(t.kind===Sc.RGB_24BPP)for(A=tn,S=n*A,y=0;y<c;y++){for(y>=o&&(A=s,S=n*A),f=0,b=S;b--;)_[f++]=g[d++],_[f++]=g[d++],_[f++]=g[d++],_[f++]=255;r.putImageData(h,0,y*tn)}else throw new Error(`bad image kind: ${t.kind}`)}function rb(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,s=e%tn,o=(e-s)/tn,c=s===0?o:o+1,h=r.createImageData(n,tn);let d=0;const f=t.data,g=h.data;for(let _=0;_<c;_++){const y=_<o?tn:s;({srcPos:d}=F1({src:f,srcPos:d,dest:g,width:n,height:y,nonBlackColor:0})),r.putImageData(h,0,_*tn)}}function ro(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)r[n]!==void 0&&(t[n]=r[n]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function mc(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}function ob(r,t){if(t)return!0;ct.singularValueDecompose2dScale(r,pn);const e=Math.fround(ti.pixelRatio*Xa.PDF_TO_CSS_UNITS);return pn[0]<=e&&pn[1]<=e}const j1=["butt","round","square"],G1=["miter","round","bevel"],q1={},lb={};class za{constructor(t,e,n,s,o,{optionalContentConfig:c,markedContentStack:h=null},d,f,g){this.ctx=t,this.current=new sb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=h||[],this.optionalContentConfig=c,this.cachedCanvases=new U1(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=g??null}getObject(t,e,n=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):n}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,c=this.ctx.canvas.height,h=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,c),this.ctx.fillStyle=h,n){const d=this.cachedCanvases.getCanvas("transparent",o,c);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...ee(this.compositeCtx))}this.ctx.save(),mc(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ee(this.ctx)}executeOperatorList(t,e,n,s,o){const c=t.argsArray,h=t.fnArray;let d=e||0;const f=c.length;if(f===d)return d;const g=f-d>ib&&typeof n=="function",_=g?Date.now()+H1:0;let y=0;const b=this.commonObjs,A=this.objs;let S,w;for(;;){if(s!==void 0&&d===s.nextBreakPoint)return s.breakIt(d,n),d;if(!o||o.has(d))if(S=h[d],w=c[d]??null,S!==Co.dependency)w===null?this[S](d):this[S](d,...w);else for(const C of w){this.dependencyTracker?.recordNamedData(C,d);const D=C.startsWith("g_")?b:A;if(!D.has(C))return D.get(C,n),d}if(d++,d===f)return d;if(g&&++y>ib){if(Date.now()>_)return n(),d;y=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const n=t.width??t.displayWidth,s=t.height??t.displayHeight;let o=Math.max(Math.hypot(e[0],e[1]),1),c=Math.max(Math.hypot(e[2],e[3]),1),h=n,d=s,f="prescale1",g,_;for(;o>2&&h>1||c>2&&d>1;){let y=h,b=d;o>2&&h>1&&(y=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h/2),o/=h/y),c>2&&d>1&&(b=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,c/=d/b),g=this.cachedCanvases.getCanvas(f,y,b),_=g.context,_.clearRect(0,0,y,b),_.drawImage(t,0,0,h,d,0,0,y,b),t=g.canvas,h=y,d=b,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:h,paintHeight:d}}_createMaskCanvas(t,e){const n=this.ctx,{width:s,height:o}=e,c=this.current.fillColor,h=this.current.patternFill,d=ee(n);let f,g,_,y;if((e.bitmap||e.data)&&e.count>1){const at=e.bitmap||e.data.buffer;g=JSON.stringify(h?d:[d.slice(0,4),c]),f=this._cachedBitmapsMap.get(at),f||(f=new Map,this._cachedBitmapsMap.set(at,f));const nt=f.get(g);if(nt&&!h){const pt=Math.round(Math.min(d[0],d[2])+d[4]),et=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,Cn.transformAndFill),{canvas:nt,offsetX:pt,offsetY:et}}_=nt}_||(y=this.cachedCanvases.getCanvas("maskCanvas",s,o),rb(y.context,e));let b=ct.transform(d,[1/s,0,0,-1/o,0,0]);b=ct.transform(b,[1,0,0,1,0,-o]);const A=Pa.slice();ct.axialAlignedBoundingBox([0,0,s,o],b,A);const[S,w,C,D]=A,x=Math.round(C-S)||1,I=Math.round(D-w)||1,O=this.cachedCanvases.getCanvas("fillCanvas",x,I),P=O.context,G=S,Y=w;P.translate(-G,-Y),P.transform(...b),_||(_=this._scaleImage(y.canvas,Vn(P)),_=_.img,f&&h&&f.set(g,_)),P.imageSmoothingEnabled=ob(ee(P),e.interpolate),gc(P,_,0,0,_.width,_.height,0,0,s,o),P.globalCompositeOperation="source-in";const j=ct.transform(Vn(P),[1,0,0,1,-G,-Y]);return P.fillStyle=h?c.getPattern(n,this,j,Ie.FILL):c,P.fillRect(0,0,s,o),f&&!h&&(this.cachedCanvases.delete("fillCanvas"),f.set(g,O.canvas)),this.dependencyTracker?.recordDependencies(t,Cn.transformAndFill),{canvas:O.canvas,offsetX:Math.round(G),offsetY:Math.round(Y)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=j1[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=G1[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,n){this.dependencyTracker?.recordSimpleData("dash",t);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=n)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[n,s]of e)switch(n){case"LW":this.setLineWidth(t,s);break;case"LC":this.setLineCap(t,s);break;case"LJ":this.setLineJoin(t,s);break;case"ML":this.setMiterLimit(t,s);break;case"D":this.setDash(t,s[0],s[1]);break;case"RI":this.setRenderingIntent(t,s);break;case"FL":this.setFlatness(t,s);break;case"Font":this.setFont(t,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(s,e,n);this.suspendedCtx=this.ctx;const c=this.ctx=o.context;c.setTransform(this.suspendedCtx.getTransform()),ro(this.suspendedCtx,c),z1(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ro(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,s){const o=s[0],c=s[1],h=s[2]-o,d=s[3]-c;h===0||d===0||(this.genericComposeSMask(e.context,n,h,d,e.subtype,e.backdrop,e.transferMap,o,c,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,s,o,c,h,d,f,g,_){let y=t.canvas,b=d-g,A=f-_;if(c)if(b<0||A<0||b+n>y.width||A+s>y.height){const w=this.cachedCanvases.getCanvas("maskExtension",n,s),C=w.context;C.drawImage(y,-b,-A),C.globalCompositeOperation="destination-atop",C.fillStyle=c,C.fillRect(0,0,n,s),C.globalCompositeOperation="source-over",y=w.canvas,b=A=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const w=new Path2D;w.rect(b,A,n,s),t.clip(w),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(b,A,n,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),o==="Alpha"&&h?e.filter=this.filterFactory.addAlphaFilter(h):o==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(h));const S=new Path2D;S.rect(d,f,n,s),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(y,b,A,n,s,d,f,n,s),e.restore()}save(t){this.inSMaskMode&&ro(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&ro(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,s,o,c,h){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,n,s,o,c,h),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n,s){let[o]=n;if(!s){o||=n[0]=new Path2D,this[e](t,o);return}if(this.dependencyTracker!==null){const c=e===Co.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,s[0]-c,s[2]+c,s[1]-c,s[3]+c).recordDependencies(t,["transform"])}if(!(o instanceof Path2D)){const c=n[0]=new Path2D;for(let h=0,d=o.length;h<d;)switch(o[h++]){case uc.moveTo:c.moveTo(o[h++],o[h++]);break;case uc.lineTo:c.lineTo(o[h++],o[h++]);break;case uc.curveTo:c.bezierCurveTo(o[h++],o[h++],o[h++],o[h++],o[h++],o[h++]);break;case uc.closePath:c.closePath();break;default:At(`Unrecognized drawing path operator: ${o[h-1]}`);break}o=c}ct.axialAlignedBoundingBox(s,ee(this.ctx),this.current.minMax),this[e](t,o),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,n=!0){const s=this.ctx,o=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const c=o.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=o.getPattern(s,this,Vn(s),Ie.STROKE),c){const h=new Path2D;h.addPath(e,s.getTransform().invertSelf().multiplySelf(c)),e=h}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Cn.stroke),n&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Ie.STROKE,ee(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,n=!0){const s=this.ctx,o=this.current.fillColor,c=this.current.patternFill;let h=!1;if(c){const f=o.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(t),s.save(),s.fillStyle=o.getPattern(s,this,Vn(s),Ie.FILL),f){const g=new Path2D;g.addPath(e,s.getTransform().invertSelf().multiplySelf(f)),e=g}h=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),this.dependencyTracker?.recordDependencies(t,Cn.fill),h&&(s.restore(),this.dependencyTracker?.restore(t)),n&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Cn.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=q1}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=lb}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;e!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",t),s.recordCloseMarker(t)}if(e!==void 0){const s=new Path2D,o=n.getTransform().invertSelf();for(const{transform:c,x:h,y:d,fontSize:f,path:g}of e)g&&s.addPath(g,new DOMMatrix(c).preMultiplySelf(o).translate(h,d).scale(f,-f));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,n){this.dependencyTracker?.recordSimpleData("font",t).recordNamedDependency(t,e);const s=this.commonObjs.get(e),o=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(o.fontMatrix=s.fontMatrix||sf,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&At("Invalid font matrix for font "+e),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const c=s.loadedName||"sans-serif",h=s.systemFontInfo?.css||`"${c}", ${s.fallbackName}`;let d="normal";s.black?d="900":s.bold&&(d="bold");const f=s.italic?"italic":"normal";let g=n;n<eb?g=eb:n>nb&&(g=nb),this.current.fontSizeScale=n/g,this.ctx.font=`${f} ${d} ${g}px ${h}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n}setLeadingMoveText(t,e,n){this.setLeading(t,-n),this.moveText(t,e,n)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:n}=this;n.textMatrix=e,n.textMatrixScale=Math.hypot(e[0],e[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,e,n){const s=new Path2D;return s.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),s}paintChar(t,e,n,s,o,c){const h=this.ctx,d=this.current,f=d.font,g=d.textRenderingMode,_=d.fontSize/d.fontSizeScale,y=g&ke.FILL_STROKE_MASK,b=!!(g&ke.ADD_TO_PATH_FLAG),A=d.patternFill&&!f.missingFile,S=d.patternStroke&&!f.missingFile;let w;if((f.disableFontFace||b||A||S)&&!f.missingFile&&(w=f.getPathGenerator(this.commonObjs,e)),w&&(f.disableFontFace||A||S)){h.save(),h.translate(n,s),h.scale(_,-_),this.dependencyTracker?.recordCharacterBBox(t,h,f);let C;if(y===ke.FILL||y===ke.FILL_STROKE)if(o){C=h.getTransform(),h.setTransform(...o);const D=this.#n(w,C,o);h.fill(D)}else h.fill(w);if(y===ke.STROKE||y===ke.FILL_STROKE)if(c){C||=h.getTransform(),h.setTransform(...c);const{a:D,b:x,c:I,d:O}=C,P=ct.inverseTransform(c),G=ct.transform([D,x,I,O,0,0],P);ct.singularValueDecompose2dScale(G,pn),h.lineWidth*=Math.max(pn[0],pn[1])/_,h.stroke(this.#n(w,C,c))}else h.lineWidth/=_,h.stroke(w);h.restore()}else(y===ke.FILL||y===ke.FILL_STROKE)&&(h.fillText(e,n,s),this.dependencyTracker?.recordCharacterBBox(t,h,f,_,n,s,()=>h.measureText(e))),(y===ke.STROKE||y===ke.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,h,f,_,n,s,()=>h.measureText(e)).recordDependencies(t,Cn.stroke),h.strokeText(e,n,s));b&&((this.pendingTextPaths||=[]).push({transform:ee(h),x:n,y:s,fontSize:_,path:w}),this.dependencyTracker?.recordCharacterBBox(t,h,f,_,n,s))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){n=!0;break}return Rt(this,"isFontSubpixelAAEnabled",n)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Cn.showText).copyDependenciesFromIncrementalOperation(t,"sameLineText").resetBBox(t),this.current.textRenderingMode&ke.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t);return}const o=n.fontSize;if(o===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,h=n.fontSizeScale,d=n.charSpacing,f=n.wordSpacing,g=n.fontDirection,_=n.textHScale*g,y=e.length,b=s.vertical,A=b?1:-1,S=s.defaultVMetrics,w=o*n.fontMatrix[0],C=n.textRenderingMode===ke.FILL&&!s.disableFontFace&&!n.patternFill;c.save(),n.textMatrix&&c.transform(...n.textMatrix),c.translate(n.x,n.y+n.textRise),g>0?c.scale(_,-1):c.scale(_,1);let D,x;if(n.patternFill){c.save();const Y=n.fillColor.getPattern(c,this,Vn(c),Ie.FILL);D=ee(c),c.restore(),c.fillStyle=Y}if(n.patternStroke){c.save();const Y=n.strokeColor.getPattern(c,this,Vn(c),Ie.STROKE);x=ee(c),c.restore(),c.strokeStyle=Y}let I=n.lineWidth;const O=n.textMatrixScale;if(O===0||I===0){const Y=n.textRenderingMode&ke.FILL_STROKE_MASK;(Y===ke.STROKE||Y===ke.FILL_STROKE)&&(I=this.getSinglePixelWidth())}else I/=O;if(h!==1&&(c.scale(h,h),I/=h),c.lineWidth=I,s.isInvalidPDFjsFont){const Y=[];let j=0;for(const nt of e)Y.push(nt.unicode),j+=nt.width;const at=Y.join("");if(c.fillText(at,0,0),this.dependencyTracker!==null){const nt=c.measureText(at);this.dependencyTracker.recordBBox(t,this.ctx,-nt.actualBoundingBoxLeft,nt.actualBoundingBoxRight,-nt.actualBoundingBoxAscent,nt.actualBoundingBoxDescent).recordOperation(t).recordIncrementalData("sameLineText",t)}n.x+=j*w*_,c.restore(),this.compose();return}let P=0,G;for(G=0;G<y;++G){const Y=e[G];if(typeof Y=="number"){P+=A*Y*o/1e3;continue}let j=!1;const at=(Y.isSpace?f:0)+d,nt=Y.fontChar,pt=Y.accent;let et,Et,St=Y.width;if(b){const it=Y.vmetric||S,bt=-(Y.vmetric?it[1]:St*.5)*w,R=it[2]*w;St=it?-it[0]:St,et=bt/h,Et=(P+R)/h}else et=P/h,Et=0;let k;if(s.remeasure&&St>0){k=c.measureText(nt);const it=k.width*1e3/o*h;if(St<it&&this.isFontSubpixelAAEnabled){const bt=St/it;j=!0,c.save(),c.scale(bt,1),et/=bt}else St!==it&&(et+=(St-it)/2e3*o/h)}if(this.contentVisible&&(Y.isInFont||s.missingFile)){if(C&&!pt)c.fillText(nt,et,Et),this.dependencyTracker?.recordCharacterBBox(t,c,k?{bbox:null}:s,o/h,et,Et,()=>k??c.measureText(nt));else if(this.paintChar(t,nt,et,Et,D,x),pt){const it=et+o*pt.offset.x/h,bt=Et-o*pt.offset.y/h;this.paintChar(t,pt.fontChar,it,bt,D,x)}}const U=b?St*w-at*g:St*w+at*g;P+=U,j&&c.restore()}b?n.y-=P:n.x+=P*_,c.restore(),this.compose(),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t)}showType3Text(t,e){const n=this.ctx,s=this.current,o=s.font,c=s.fontSize,h=s.fontDirection,d=o.vertical?1:-1,f=s.charSpacing,g=s.wordSpacing,_=s.textHScale*h,y=s.fontMatrix||sf,b=e.length,A=s.textRenderingMode===ke.INVISIBLE;let S,w,C,D;if(A||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(_,h);const x=this.dependencyTracker;for(this.dependencyTracker=x?new Rc(x,t):null,S=0;S<b;++S){if(w=e[S],typeof w=="number"){D=d*w*c/1e3,this.ctx.translate(D,0),s.x+=D*_;continue}const I=(w.isSpace?g:0)+f,O=o.charProcOperatorList[w.operatorListId];O?this.contentVisible&&(this.save(),n.scale(c,c),n.transform(...y),this.executeOperatorList(O),this.restore()):At(`Type3 character "${w.operatorListId}" is not available.`);const P=[w.width,0];ct.applyTransform(P,y),C=P[0]*c+I,n.translate(C,0),s.x+=C*_}n.restore(),x&&(this.dependencyTracker.recordNestedDependencies(),this.dependencyTracker=x)}setCharWidth(t,e,n){}setCharWidthAndBounds(t,e,n,s,o,c,h){const d=new Path2D;d.rect(s,o,c-s,h-o),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,s,c,o,h).recordClipBox(t,this.ctx,s,c,o,h),this.endPath(t)}getColorN_Pattern(t,e){let n;if(e[0]==="TilingPattern"){const s=this.baseTransform||ee(this.ctx),o={createCanvasGraphics:c=>new za(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Rc(this.dependencyTracker,t):null)};n=new Kf(e,this.ctx,o,s)}else n=this._getPattern(t,e[1],e[2]);return n}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,n=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=B1(this.getObject(t,e)),this.cachedPatterns.set(e,s)),n&&(s.matrix=n),s}shadingFill(t,e){if(!this.contentVisible)return;const n=this.ctx;this.save(t);const s=this._getPattern(t,e);n.fillStyle=s.getPattern(n,this,Vn(n),Ie.SHADING);const o=Vn(n);if(o){const{width:c,height:h}=n.canvas,d=Pa.slice();ct.axialAlignedBoundingBox([0,0,c,h],o,d);const[f,g,_,y]=d;this.ctx.fillRect(f,g,_-f,y-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Cn.transform).recordDependencies(t,Cn.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Vt("Should not call beginInlineImage")}beginImageData(){Vt("Should not call beginImageData")}paintFormXObjectBegin(t,e,n){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=ee(this.ctx),n)){ct.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,o,c,h]=n,d=new Path2D;d.rect(s,o,c-s,h-o),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,s,c,o,h),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;e.isolated||Zc("TODO: Support non-isolated groups."),e.knockout&&At("Knockout groups not supported.");const s=ee(n);if(e.matrix&&n.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let o=Pa.slice();ct.axialAlignedBoundingBox(e.bbox,ee(n),o);const c=[0,0,n.canvas.width,n.canvas.height];o=ct.intersect(o,c)||[0,0,0,0];const h=Math.floor(o[0]),d=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-h,1),g=Math.max(Math.ceil(o[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,g]);let _="groupAt"+this.groupLevel;e.smask&&(_+="_smask_"+this.smaskCounter++%2);const y=this.cachedCanvases.getCanvas(_,f,g),b=y.context;b.translate(-h,-d),b.transform(...s);let A=new Path2D;const[S,w,C,D]=e.bbox;if(A.rect(S,w,C-S,D-w),e.matrix){const x=new Path2D;x.addPath(A,new DOMMatrix(e.matrix)),A=x}b.clip(A),e.smask&&this.smaskStack.push({canvas:y.canvas,context:b,offsetX:h,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(h,d),n.save()),ro(n,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=ee(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...o);const c=Pa.slice();ct.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,c),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,e,n,s,o,c){if(this.#t(),mc(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const h=n[2]-n[0],d=n[3]-n[1];if(c&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=h,n[3]=d,ct.singularValueDecompose2dScale(ee(this.ctx),pn);const{viewportScale:f}=this,g=Math.ceil(h*this.outputScaleX*f),_=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(g,_);const{canvas:y,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(e,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(pn[0],0,0,-pn[1],0,d*pn[1]),mc(this.ctx)}else{mc(this.ctx),this.endPath(t);const f=new Path2D;f.rect(n[0],n[1],h,d),this.ctx.clip(f)}}this.current=new sb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...s),this.transform(t,...o)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const n=e.count;e=this.getObject(t,e.data,e),e.count=n;const s=this.ctx,o=this._createMaskCanvas(t,e),c=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(c,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,o.offsetX,o.offsetX+c.width,o.offsetY,o.offsetY+c.height).recordOperation(t),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n,s=0,o=0,c,h){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=ee(d);d.transform(n,s,o,c,0,0);const g=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,g.offsetX-f[4],g.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let _=0,y=h.length;_<y;_+=2){const b=ct.transform(f,[n,s,o,c,h[_],h[_+1]]);d.drawImage(g.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(t,this.ctx,b[4],b[4]+g.canvas.width,b[5],b[5]+g.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Cn.transformAndFill);for(const c of e){const{data:h,width:d,height:f,transform:g}=c,_=this.cachedCanvases.getCanvas("maskCanvas",d,f),y=_.context;y.save();const b=this.getObject(t,h,c);rb(y,b),y.globalCompositeOperation="source-in",y.fillStyle=o?s.getPattern(y,this,Vn(n),Ie.FILL):s,y.fillRect(0,0,d,f),y.restore(),n.save(),n.transform(...g),n.scale(1,-1),gc(n,_.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,n,0,d,0,f),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const n=this.getObject(t,e);if(!n){At("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,n)}paintImageXObjectRepeat(t,e,n,s,o){if(!this.contentVisible)return;const c=this.getObject(t,e);if(!c){At("Dependent image isn't ready yet");return}const h=c.width,d=c.height,f=[];for(let g=0,_=o.length;g<_;g+=2)f.push({transform:[n,0,0,s,o[g],o[g+1]],x:0,y:0,w:h,h:d});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:s}=t,o=this.cachedCanvases.getCanvas("inlineImage",n,s),c=o.context;return c.filter=this.current.transferMaps,c.drawImage(e,0,0),c.filter="none",o.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const n=e.width,s=e.height,o=this.ctx;this.save(t);const{filter:c}=o;c!=="none"&&c!==""&&(o.filter="none"),o.scale(1/n,-1/s);let h;if(e.bitmap)h=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)h=e;else{const g=this.cachedCanvases.getCanvas("inlineImage",n,s).context;ab(g,e),h=this.applyTransferMapsToCanvas(g)}const d=this._scaleImage(h,Vn(o));o.imageSmoothingEnabled=ob(ee(o),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,o,0,n,-s,0).recordDependencies(t,Cn.imageXObject).recordOperation(t),gc(o,d.img,0,0,d.paintWidth,d.paintHeight,0,-s,n,s),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,n){if(!this.contentVisible)return;const s=this.ctx;let o;if(e.bitmap)o=e.bitmap;else{const c=e.width,h=e.height,f=this.cachedCanvases.getCanvas("inlineImage",c,h).context;ab(f,e),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of n)s.save(),s.transform(...c.transform),s.scale(1,-1),gc(s,o,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Cn.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,n){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,n){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(s||(this.pendingClip===lb?o.clip(e,"evenodd"):o.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ee(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:s,d:o}=this.ctx.getTransform();let c,h;if(n===0&&s===0){const d=Math.abs(e),f=Math.abs(o);if(d===f)if(t===0)c=h=1/d;else{const g=d*t;c=h=g<1?1/g:1}else if(t===0)c=1/d,h=1/f;else{const g=d*t,_=f*t;c=g<1?1/g:1,h=_<1?1/_:1}}else{const d=Math.abs(e*o-n*s),f=Math.hypot(e,n),g=Math.hypot(s,o);if(t===0)c=g/d,h=f/d;else{const _=t*d;c=g>_?g/_:1,h=f>_?f/_:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=h}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:s}}=this,[o,c]=this.getScaleForStroking();if(o===c){n.lineWidth=(s||1)*o,n.stroke(t);return}const h=n.getLineDash();e&&n.save(),n.scale(o,c),Ud.a=1/o,Ud.d=1/c;const d=new Path2D;if(d.addPath(t,Ud),h.length>0){const f=Math.max(o,c);n.setLineDash(h.map(g=>g/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(d),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const r in Co)za.prototype[r]!==void 0&&(za.prototype[Co[r]]=za.prototype[r]);class Ua{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class V1{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const La=Symbol("INTERNAL");class Y1{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:n,usage:s,rbGroups:o}){this.#t=!!(t&fn.DISPLAY),this.#e=!!(t&fn.PRINT),this.name=e,this.intent=n,this.usage=s,this.rbGroups=o}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,n=!1){t!==La&&Vt("Internal method `_setVisible` called."),this.#n=n,this.#i=e}}class X1{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=fn.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const n of t.groups)this.#e.set(n.id,new Y1(e,n));if(t.baseState==="OFF")for(const n of this.#e.values())n._setVisible(La,!1);for(const n of t.on)this.#e.get(n)._setVisible(La,!0);for(const n of t.off)this.#e.get(n)._setVisible(La,!1);this.#n=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let s=1;s<e;s++){const o=t[s];let c;if(Array.isArray(o))c=this.#a(o);else if(this.#e.has(o))c=this.#e.get(o).visible;else return At(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return n==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Zc("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(At(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return At(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return At(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return At(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return At(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return At(`Unknown optional content policy ${t.policy}.`),!0}return At(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){const s=this.#e.get(t);if(!s){At(`Optional content group not found: ${t}`);return}if(n&&e&&s.rbGroups.length)for(const o of s.rbGroups)for(const c of o)c!==t&&this.#e.get(c)?._setVisible(La,!1,!0);s._setVisible(La,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let n;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=this.#e.get(s);if(o)switch(n){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!o.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new vv;for(const[e,n]of this.#e)t.update(`${e}:${n.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class $1{constructor(t,{disableRange:e=!1,disableStream:n=!1}){me(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:c,contentDispositionFilename:h}=t;if(this._queuedChunks=[],this._progressiveDone=c,this._contentDispositionFilename=h,o?.length>0){const d=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(d)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((d,f)=>{this._onReceiveData({begin:d,chunk:f})}),t.addProgressListener((d,f)=>{this._onProgress({loaded:d,total:f})}),t.addProgressiveReadListener(d=>{this._onReceiveData({chunk:d})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==t?!1:(o._enqueue(n),!0)});me(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){me(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new W1(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new K1(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class W1{constructor(t,e,n=!1,s=null){this._stream=t,this._done=n||!1,this._filename=qf(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class K1{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function Q1(r){let t=!0,e=n("filename\\*","i").exec(r);if(e){e=e[1];let g=h(e);return g=unescape(g),g=d(g),g=f(g),o(g)}if(e=c(r),e){const g=f(e);return o(g)}if(e=n("filename","i").exec(r),e){e=e[1];let g=h(e);return g=f(g),o(g)}function n(g,_){return new RegExp("(?:^|;)\\s*"+g+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',_)}function s(g,_){if(g){if(!/^[\x00-\xFF]+$/.test(_))return _;try{const y=new TextDecoder(g,{fatal:!0}),b=Ho(_);_=y.decode(b),t=!1}catch{}}return _}function o(g){return t&&/[\x80-\xff]/.test(g)&&(g=s("utf-8",g),t&&(g=s("iso-8859-1",g))),g}function c(g){const _=[];let y;const b=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=b.exec(g))!==null;){let[,S,w,C]=y;if(S=parseInt(S,10),S in _){if(S===0)break;continue}_[S]=[w,C]}const A=[];for(let S=0;S<_.length&&S in _;++S){let[w,C]=_[S];C=h(C),w&&(C=unescape(C),S===0&&(C=d(C))),A.push(C)}return A.join("")}function h(g){if(g.startsWith('"')){const _=g.slice(1).split('\\"');for(let y=0;y<_.length;++y){const b=_[y].indexOf('"');b!==-1&&(_[y]=_[y].slice(0,b),_.length=y+1),_[y]=_[y].replaceAll(/\\(.)/g,"$1")}g=_.join('"')}return g}function d(g){const _=g.indexOf("'");if(_===-1)return g;const y=g.slice(0,_),A=g.slice(_+1).replace(/^[^']*'/,"");return s(y,A)}function f(g){return!g.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(g)?g:g.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(_,y,b,A){if(b==="q"||b==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,w){return String.fromCharCode(parseInt(w,16))}),s(y,A);try{A=atob(A)}catch{}return s(y,A)})}return""}function xv(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const n in t){const s=t[n];s!==void 0&&e.append(n,s)}return e}function nu(r){return URL.parse(r)?.origin??null}function Rv({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(r.get("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*e)||n||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function Dv(r){const t=r.get("Content-Disposition");if(t){let e=Q1(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(qf(e))return e}return null}function Go(r,t){return new xc(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r,r===404||r===0&&t.startsWith("file:"))}function Mv(r){return r===200||r===206}function Nv(r,t,e){return{method:"GET",headers:r,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Ov(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(At(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class Z1{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=xv(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return me(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new J1(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new tw(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class J1{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),s=e.url;fetch(s,Nv(n,this._withCredentials,this._abortController)).then(o=>{if(t._responseOrigin=nu(o.url),!Mv(o.status))throw Go(o.status,s);this._reader=o.body.getReader(),this._headersCapability.resolve();const c=o.headers,{allowRangeRequests:h,suggestedLength:d}=Rv({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=h,this._contentLength=d||this._contentLength,this._filename=Dv(c),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ts("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Ov(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class tw{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const o=new Headers(t.headers);o.append("Range",`bytes=${e}-${n-1}`);const c=s.url;fetch(c,Nv(o,this._withCredentials,this._abortController)).then(h=>{const d=nu(h.url);if(d!==t._responseOrigin)throw new Error(`Expected range response-origin "${d}" to match "${t._responseOrigin}".`);if(!Mv(h.status))throw Go(h.status,c);this._readCapability.resolve(),this._reader=h.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Ov(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const jd=200,Gd=206;function ew(r){const t=r.response;return typeof t!="string"?t:Ho(t).buffer}class nw{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:n}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=xv(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[o,c]of this.headers)e.setRequestHeader(o,c);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=Gd):s.expectedStatus=jd,e.responseType="arraybuffer",me(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){const n=this.pendingRequests[t];n&&n.onProgress?.(e)}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){n.onError(s.status);return}const o=s.status||jd;if(!(o===jd&&n.expectedStatus===Gd)&&o!==n.expectedStatus){n.onError(s.status);return}const h=ew(s);if(o===Gd){const d=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(d);f?n.onDone({begin:parseInt(f[1],10),chunk:h}):(At('Missing or invalid "Content-Range" header.'),n.onError(0))}else h?n.onDone({begin:0,chunk:h}):n.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class iw{constructor(t){this._source=t,this._manager=new nw(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return me(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new sw(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new aw(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class sw{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=nu(e.responseURL);const n=e.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(h=>{const[d,...f]=h.split(": ");return[d,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:c}=Rv({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=Dv(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=Go(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class aw{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=nu(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=Go(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const rw=/^[a-z][a-z0-9\-+.]+:/i;function ow(r){if(rw.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}class lw{constructor(t){this.source=t,this.url=ow(t.url),me(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return me(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new cw(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new uw(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class cw{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=Go(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ts("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class uw{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const oo=Symbol("INITIAL_DATA");class kv{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:oo}}get(t,e=null){if(e){const s=this.#e(t);return s.promise.then(()=>e(s.data)),null}const n=this.#t[t];if(!n||n.data===oo)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=this.#t[t];return!!e&&e.data!==oo}delete(t){const e=this.#t[t];return!e||e.data===oo?!1:(delete this.#t[t],!0)}resolve(t,e=null){const n=this.#e(t);n.data=e,n.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==oo&&(yield[t,e])}}}const hw=1e5,cb=30;class Ue{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#s=null;#r=0;#o=0;#l=null;#c=null;#d=0;#u=0;#f=Object.create(null);#g=[];#p=null;#h=[];#m=new WeakMap;#b=null;static#_=new Map;static#A=new Map;static#S=new WeakMap;static#y=null;static#E=new Set;constructor({textContentSource:t,container:e,viewport:n}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#c=e,this.#u=n.scale*ti.pixelRatio,this.#d=n.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:o,pageX:c,pageY:h}=n.rawDims;this.#b=[1,0,0,-1,-c,h+o],this.#o=s,this.#r=o,Ue.#D(),ks(e,n),this.#t.promise.finally(()=>{Ue.#E.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Pe.platform;return Rt(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#l.read().then(({value:e,done:n})=>{if(n){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#R(e.items),t()},this.#t.reject)};return this.#l=this.#p.getReader(),Ue.#E.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const n=t.scale*ti.pixelRatio,s=t.rotation;if(s!==this.#d&&(e?.(),this.#d=s,ks(this.#c,{rotation:s})),n!==this.#u){e?.(),this.#u=n;const o={div:null,properties:null,ctx:Ue.#O(this.#a)};for(const c of this.#h)o.properties=this.#m.get(c),o.div=c,this.#w(o)}}cancel(){const t=new ts("TextLayer task cancelled.");this.#l?.cancel(t).catch(()=>{}),this.#l=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#g}#R(t){if(this.#n)return;this.#s.ctx??=Ue.#O(this.#a);const e=this.#h,n=this.#g;for(const s of t){if(e.length>hw){At("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const o=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id&&this.#e.setAttribute("id",`${s.id}`),o.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}n.push(s.str),this.#T(s)}}#T(t){const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const s=ct.transform(this.#b,t.transform);let o=Math.atan2(s[1],s[0]);const c=this.#f[t.fontName];c.vertical&&(o+=Math.PI/2);let h=this.#i&&c.fontSubstitution||c.fontFamily;h=Ue.fontFamilyMap.get(h)||h;const d=Math.hypot(s[2],s[3]),f=d*Ue.#I(h,c,this.#a);let g,_;o===0?(g=s[4],_=s[5]-f):(g=s[4]+f*Math.sin(o),_=s[5]-f*Math.cos(o));const y="calc(var(--total-scale-factor) *",b=e.style;this.#e===this.#c?(b.left=`${(100*g/this.#o).toFixed(2)}%`,b.top=`${(100*_/this.#r).toFixed(2)}%`):(b.left=`${y}${g.toFixed(2)}px)`,b.top=`${y}${_.toFixed(2)}px)`),b.fontSize=`${y}${(Ue.#y*d).toFixed(2)}px)`,b.fontFamily=h,n.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),o!==0&&(n.angle=o*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const S=Math.abs(t.transform[0]),w=Math.abs(t.transform[3]);S!==w&&Math.max(S,w)/Math.min(S,w)>1.5&&(A=!0)}if(A&&(n.canvasWidth=c.vertical?t.height:t.width),this.#m.set(e,n),this.#s.div=e,this.#s.properties=n,this.#w(this.#s),n.hasText&&this.#e.append(e),n.hasEOL){const S=document.createElement("br");S.setAttribute("role","presentation"),this.#e.append(S)}}#w(t){const{div:e,properties:n,ctx:s}=t,{style:o}=e;let c="";if(Ue.#y>1&&(c=`scale(${1/Ue.#y})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:h}=o,{canvasWidth:d,fontSize:f}=n;Ue.#x(s,f*this.#u,h);const{width:g}=s.measureText(e.textContent);g>0&&(c=`scaleX(${d*this.#u/g}) ${c}`)}n.angle!==0&&(c=`rotate(${n.angle}deg) ${c}`),c.length>0&&(o.transform=c)}static cleanup(){if(!(this.#E.size>0)){this.#_.clear();for(const{canvas:t}of this.#A.values())t.remove();this.#A.clear()}}static#O(t=null){let e=this.#A.get(t||="");if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#A.set(t,e),this.#S.set(e,{size:0,family:""})}return e}static#x(t,e,n){const s=this.#S.get(t);e===s.size&&n===s.family||(t.font=`${e}px ${n}`,s.size=e,s.family=n)}static#D(){if(this.#y!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#y=t.getBoundingClientRect().height,t.remove()}static#I(t,e,n){const s=this.#_.get(t);if(s)return s;const o=this.#O(n);o.canvas.width=o.canvas.height=cb,this.#x(o,cb,t);const c=o.measureText(""),h=c.fontBoundingBoxAscent,d=Math.abs(c.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return h?f=h/(h+d):(Pe.platform.isFirefox&&At("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#_.set(t,f),f}}class To{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function s(o){if(!o)return;let c=null;const h=o.name;if(h==="#text")c=o.value;else if(To.shouldBuildText(h))o?.attributes?.textContent?c=o.attributes.textContent:o.value&&(c=o.value);else return;if(c!==null&&e.push({str:c}),!!o.children)for(const d of o.children)s(d)}return s(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const dw=100;function Lv(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new Qf,{docId:e}=t,n=r.url?v1(r.url):null,s=r.data?A1(r.data):null,o=r.httpHeaders||null,c=r.withCredentials===!0,h=r.password??null,d=r.range instanceof Iv?r.range:null,f=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let g=r.worker instanceof xo?r.worker:null;const _=r.verbosity,y=typeof r.docBaseUrl=="string"&&!Jc(r.docBaseUrl)?r.docBaseUrl:null,b=fc(r.cMapUrl),A=r.cMapPacked!==!1,S=r.CMapReaderFactory||(je?D1:Qy),w=fc(r.iccUrl),C=fc(r.standardFontDataUrl),D=r.StandardFontDataFactory||(je?M1:Zy),x=fc(r.wasmUrl),I=r.WasmFactory||(je?N1:Jy),O=r.stopAtErrors!==!0,P=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,G=r.isEvalSupported!==!1,Y=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!je,j=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!je&&(Pe.platform.isFirefox||!globalThis.chrome),at=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,nt=typeof r.disableFontFace=="boolean"?r.disableFontFace:je,pt=r.fontExtraProperties===!0,et=r.enableXfa===!0,Et=r.ownerDocument||globalThis.document,St=r.disableRange===!0,k=r.disableStream===!0,U=r.disableAutoFetch===!0,it=r.pdfBug===!0,bt=r.CanvasFactory||(je?R1:C1),R=r.FilterFactory||(je?x1:T1),$=r.enableHWA===!0,J=r.useWasm!==!1,N=d?d.length:r.length??NaN,q=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!je&&!nt,K=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(S===Qy&&D===Zy&&I===Jy&&b&&C&&x&&go(b,document.baseURI)&&go(C,document.baseURI)&&go(x,document.baseURI)),Q=null;ZE(_);const Z={canvasFactory:new bt({ownerDocument:Et,enableHWA:$}),filterFactory:new R({docId:e,ownerDocument:Et}),cMapReaderFactory:K?null:new S({baseUrl:b,isCompressed:A}),standardFontDataFactory:K?null:new D({baseUrl:C}),wasmFactory:K?null:new I({baseUrl:x})};g||(g=xo.create({verbosity:_,port:Ua.workerPort}),t._worker=g);const rt={docId:e,apiVersion:"5.4.149",data:s,password:h,disableAutoFetch:U,rangeChunkSize:f,length:N,docBaseUrl:y,enableXfa:et,evaluatorOptions:{maxImageSize:P,disableFontFace:nt,ignoreErrors:O,isEvalSupported:G,isOffscreenCanvasSupported:Y,isImageDecoderSupported:j,canvasMaxAreaInBytes:at,fontExtraProperties:pt,useSystemFonts:q,useWasm:J,useWorkerFetch:K,cMapUrl:b,iccUrl:w,standardFontDataUrl:C,wasmUrl:x}},Ut={ownerDocument:Et,pdfBug:it,styleElement:Q,loadingParams:{disableAutoFetch:U,enableXfa:et}};return g.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const Ye=g.messageHandler.sendWithPromise("GetDocRequest",rt,s?[s.buffer]:null);let De;if(d)De=new $1(d,{disableRange:St,disableStream:k});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const rs=go(n)?Z1:je?lw:iw;De=new rs({url:n,length:N,httpHeaders:o,withCredentials:c,rangeChunkSize:f,disableRange:St,disableStream:k})}return Ye.then(rs=>{if(t.destroyed)throw new Error("Loading aborted");if(g.destroyed)throw new Error("Worker was destroyed");const qs=new mo(e,rs,g.port),rr=new gw(qs,t,De,Ut,Z,$);t._transport=rr,qs.send("Ready",null)})}).catch(t._capability.reject),t}class Qf{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Qf.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Iv{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#a=[];constructor(t,e,n=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const n of this.#a)n(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const n of this.#i)n(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Vt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class fw{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Rt(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class pw{#t=!1;constructor(t,e,n,s=!1){this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=s?new $y:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new kv,this._intentStates=new Map,this.destroyed=!1,this.recordedGroups=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new Uo({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Rt(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:s="display",annotationMode:o=$i.ENABLE,transform:c=null,background:h=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:g=null,printAnnotationStorage:_=null,isEditing:y=!1,recordOperations:b=!1,filteredOperationIndexes:A=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(s,o,_,y),{renderingIntent:w,cacheKey:C}=S;this.#t=!1,d||=this._transport.getOptionalContentConfig(w);let D=this._intentStates.get(C);D||(D=Object.create(null),this._intentStates.set(C,D)),D.streamReaderCancelTimeout&&(clearTimeout(D.streamReaderCancelTimeout),D.streamReaderCancelTimeout=null);const x=!!(w&fn.PRINT);D.displayReadyCapability||(D.displayReadyCapability=Promise.withResolvers(),D.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const I=!this.recordedGroups&&(b||this._pdfBug&&globalThis.StepperManager?.enabled),O=Y=>{if(D.renderTasks.delete(P),I){const j=P.gfx?.dependencyTracker.take();j?(P.stepper?.setOperatorGroups(j),b&&(this.recordedGroups=j)):b&&(this.recordedGroups=[])}x&&(this.#t=!0),this.#e(),Y?(P.capability.reject(Y),this._abortOperatorList({intentState:D,reason:Y instanceof Error?Y:new Error(Y)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new Ba({callback:O,params:{canvas:e,canvasContext:t,dependencyTracker:I?new O1(e):null,viewport:n,transform:c,background:h},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:D.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!x,pdfBug:this._pdfBug,pageColors:g,enableHWA:this._transport.enableHWA,filteredOperationIndexes:A});(D.renderTasks||=new Set).add(P);const G=P.task;return Promise.all([D.displayReadyCapability.promise,d]).then(([Y,j])=>{if(this.destroyed){O();return}if(this._stats?.time("Rendering"),!(j.renderingIntent&w))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:Y,optionalContentConfig:j}),P.operatorListChanged()}).catch(O),G}getOperatorList({intent:t="display",annotationMode:e=$i.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function o(){h.operatorList.lastChunk&&(h.opListReadCapability.resolve(h.operatorList),h.renderTasks.delete(d))}const c=this._transport.getRenderingIntent(t,e,n,s,!0);let h=this._intentStates.get(c.cacheKey);h||(h=Object.create(null),this._intentStates.set(c.cacheKey,h));let d;return h.opListReadCapability||(d=Object.create(null),d.operatorListChanged=o,h.opListReadCapability=Promise.withResolvers(),(h.renderTasks||=new Set).add(d),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),h.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>To.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,s){function o(){c.read().then(function({value:d,done:f}){if(f){n(h);return}h.lang??=d.lang,Object.assign(h.styles,d.styles),h.items.push(...d.items),o()},s)}const c=e.getReader(),h={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new $y),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const n=this._intentStates.get(e);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let n=0,s=t.length;n<s;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:c}=n,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:o,modifiedIds:s},c).getReader(),f=this._intentStates.get(e);f.streamReader=d;const g=()=>{d.read().then(({value:_,done:y})=>{if(y){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(_,f),g())},_=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const y of f.renderTasks)y.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(_);else if(f.opListReadCapability)f.opListReadCapability.reject(_);else throw _}})};g()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof Gf){let s=dw;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new ts(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Wi,On,bi,Ds,Wc,Ms,Ns,qe,Ec,Pv,Bv,_o,Ya,wc;const Jt=class Jt{constructor({name:t=null,port:e=null,verbosity:n=JE()}={}){Gn(this,qe);Gn(this,Wi,Promise.withResolvers());Gn(this,On,null);Gn(this,bi,null);Gn(this,Ds,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(Zt(Jt,Ns).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Zt(Jt,Ns).set(e,this),qn(this,qe,Pv).call(this,e)}else qn(this,qe,Bv).call(this)}get promise(){return Zt(this,Wi).promise}get port(){return Zt(this,bi)}get messageHandler(){return Zt(this,On)}destroy(){this.destroyed=!0,Zt(this,Ds)?.terminate(),Ze(this,Ds,null),Zt(Jt,Ns).delete(Zt(this,bi)),Ze(this,bi,null),Zt(this,On)?.destroy(),Ze(this,On,null)}static create(t){const e=Zt(this,Ns).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Jt(t)}static get workerSrc(){if(Ua.workerSrc)return Ua.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Rt(this,"_setupFakeWorkerGlobal",(async()=>Zt(this,Ya,wc)?Zt(this,Ya,wc):(await import(this.workerSrc)).WorkerMessageHandler)())}};Wi=new WeakMap,On=new WeakMap,bi=new WeakMap,Ds=new WeakMap,Wc=new WeakMap,Ms=new WeakMap,Ns=new WeakMap,qe=new WeakSet,Ec=function(){Zt(this,Wi).resolve(),Zt(this,On).send("configure",{verbosity:this.verbosity})},Pv=function(t){Ze(this,bi,t),Ze(this,On,new mo("main","worker",t)),Zt(this,On).on("ready",()=>{}),qn(this,qe,Ec).call(this)},Bv=function(){if(Zt(Jt,Ms)||Zt(Jt,Ya,wc)){qn(this,qe,_o).call(this);return}let{workerSrc:t}=Jt;try{Jt._isSameOrigin(window.location,t)||(t=Jt._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new mo("main","worker",e),s=()=>{o.abort(),n.destroy(),e.terminate(),this.destroyed?Zt(this,Wi).reject(new Error("Worker was destroyed")):qn(this,qe,_o).call(this)},o=new AbortController;e.addEventListener("error",()=>{Zt(this,Ds)||s()},{signal:o.signal}),n.on("test",h=>{if(o.abort(),this.destroyed||!h){s();return}Ze(this,On,n),Ze(this,bi,e),Ze(this,Ds,e),qn(this,qe,Ec).call(this)}),n.on("ready",h=>{if(o.abort(),this.destroyed){s();return}try{c()}catch{qn(this,qe,_o).call(this)}});const c=()=>{const h=new Uint8Array;n.send("test",h,[h.buffer])};c();return}catch{Zc("The worker has been disabled.")}qn(this,qe,_o).call(this)},_o=function(){Zt(Jt,Ms)||(At("Setting up fake worker."),Ze(Jt,Ms,!0)),Jt._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Zt(this,Wi).reject(new Error("Worker was destroyed"));return}const e=new w1;Ze(this,bi,e);const n=`fake${Iy(Jt,Wc)._++}`,s=new mo(n+"_worker",n,e);t.setup(s,e),Ze(this,On,new mo(n,n+"_worker",e)),qn(this,qe,Ec).call(this)}).catch(t=>{Zt(this,Wi).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Ya=new WeakSet,wc=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Gn(Jt,Ya),Gn(Jt,Wc,0),Gn(Jt,Ms,!1),Gn(Jt,Ns,new WeakMap),je&&(Ze(Jt,Ms,!0),Ua.workerSrc||="./pdf.worker.mjs"),Jt._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!n?.origin||n.origin==="null")return!1;const s=new URL(e,n);return n.origin===s.origin},Jt._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Jt.fromPort=t=>{if(h1("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Jt.create(t)};let xo=Jt;class gw{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#a=null;constructor(t,e,n,s,o,c){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new kv,this.fontLoader=new y1({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=c,this.setupMessageHandler()}#s(t,e=null){const n=this.#t.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,s),s}get annotationStorage(){return Rt(this,"annotationStorage",new Xf)}getRenderingIntent(t,e=$i.ENABLE,n=null,s=!1,o=!1){let c=fn.DISPLAY,h=lf;switch(t){case"any":c=fn.ANY;break;case"display":break;case"print":c=fn.PRINT;break;default:At(`getRenderingIntent - invalid intent: ${t}`)}const d=c&fn.PRINT&&n instanceof Av?n:this.annotationStorage;switch(e){case $i.DISABLE:c+=fn.ANNOTATIONS_DISABLE;break;case $i.ENABLE:break;case $i.ENABLE_FORMS:c+=fn.ANNOTATIONS_FORMS;break;case $i.ENABLE_STORAGE:c+=fn.ANNOTATIONS_STORAGE,h=d.serializable;break;default:At(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(c+=fn.IS_EDITING),o&&(c+=fn.OPLIST);const{ids:f,hash:g}=d.modifiedIds,_=[c,h.hash,g];return{renderingIntent:c,cacheKey:_.join("_"),annotationStorageSerializable:h,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#e.values())t.push(n._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),Ue.cleanup(),this._networkStream?.cancelAllRequests(new ts("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,s)=>{me(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:c}){if(c){s.close();return}me(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:o,contentLength:c}=this._fullReader;return(!s||!o)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=h=>{e.onProgress?.({loaded:h.loaded,total:h.total})}),{isStreamingSupported:s,isRangeSupported:o,contentLength:c}}),t.on("GetRangeReader",(n,s)=>{me(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:c,done:h}){if(h){s.close();return}me(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{s.error(c)})},s.onCancel=c=>{o.cancel(c),s.ready.catch(h=>{if(!this.destroyed)throw h})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new fw(n,this))}),t.on("DocException",n=>{e._capability.reject(Je(n))}),t.on("PasswordRequest",n=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw Je(n);const s=o=>{o instanceof Error?this.#a.reject(o):this.#a.resolve({password:o})};e.onPassword(s,n.code)}catch(s){this.#a.reject(s)}return this.#a.promise}),t.on("DataLoaded",n=>{e.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#e.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,s,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in o){const f=o.error;At(`Error during font loading: ${f}`),this.commonObjs.resolve(n,f);break}const c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,g)=>globalThis.FontInspector.fontAdded(f,g):null,h=new b1(o,c);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&(h.data=null),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:d}=o;me(d,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,g]of f.objs)if(g?.ref===d)return g.dataLen?(this.commonObjs.resolve(n,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([n,s,o,c])=>{if(this.destroyed)return;const h=this.#e.get(s);if(!h.objs.has(n)){if(h._intentStates.size===0){c?.bitmap?.close();return}switch(o){case"Image":case"Pattern":h.objs.resolve(n,c);break;default:throw new Error(`Got unknown object type ${o}`)}}}),t.on("DocProgress",n=>{this.destroyed||e.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&At("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=this.#n.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#i.set(o.refStr,t);const c=new pw(e,o,this,this._params.pdfBug);return this.#e.set(e,c),c});return this.#n.set(e,s),s}getPageIndex(t){return cf(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#s("GetOptionalContentConfig").then(e=>new X1(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new V1(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),Ue.cleanup()}}cachedPageNumber(t){if(!cf(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class mw{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Ba{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:c,pageIndex:h,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:g=!1,pdfBug:_=!1,pageColors:y=null,enableHWA:b=!1,filteredOperationIndexes:A=null}){this.callback=t,this.params=e,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=h,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=_,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=g===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new mw(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=b,this._dependencyTracker=e.dependencyTracker,this._filteredOperationIndexes=A}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Ba.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Ba.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:o,dependencyTracker:c}=this.params,h=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new za(h,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:s,viewport:n,transparency:t,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Ba.#e.delete(this._canvas),t||=new Gf(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._filteredOperationIndexes),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Ba.#e.delete(this._canvas),this.callback())))}}const _w="5.4.149",yw="9e2e9e209";class Tn{#t=null;#e=null;#n;#i=null;#a=!1;#s=!1;#r=null;#o;#l=null;#c=null;static#d=null;static get _keyboardManager(){return Rt(this,"_keyboardManager",new jo([[["Escape","mac+Escape"],Tn.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Tn.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Tn.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Tn.prototype._moveToPrevious],[["Home","mac+Home"],Tn.prototype._moveToBeginning],[["End","mac+End"],Tn.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#s=!1,this.#r=t):this.#s=!0,this.#c=t?._uiManager||e,this.#o=this.#c._eventBus,this.#n=t?.color?.toUpperCase()||this.#c?.highlightColors.values().next().value||"#FFFF98",Tn.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#r&&(t.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const e=this.#c._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const n=this.#e=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#n,t.append(n),t}renderMainDropdown(){const t=this.#i=this.#u();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#u(){const t=document.createElement("div"),e=this.#c._signal;t.addEventListener("contextmenu",Rn,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(t.id=`${this.#r.id}_colorpicker_dropdown`);for(const[n,s]of this.#c.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",Tn.#d[n]);const c=document.createElement("span");o.append(c),c.className="swatch",c.style.backgroundColor=s,o.ariaSelected=s===this.#n,o.addEventListener("click",this.#f.bind(this,s),{signal:e}),t.append(o)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:kt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#m){this.#p(t);return}if(t.target===this.#t){this.#i.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstChild||t.target===this.#t){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#p(t);return}this.#i.firstChild?.focus()}_moveToEnd(t){if(!this.#m){this.#p(t);return}this.#i.lastChild?.focus()}#g(t){Tn._keyboardManager.exec(this,t)}#p(t){if(this.#m){this.hideDropdown();return}if(this.#a=t.detail===0,this.#l||(this.#l=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#c.combinedSignal(this.#l)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#u();this.#t.append(e)}#h(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#l?.abort(),this.#l=null}get#m(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#m){this.#r?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#c.highlightColors.values();for(const n of this.#i.children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Ro{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Ro.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:n}=this.#e,s=this.#t=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Ro.#i[t]),s.addEventListener("input",()=>{this.#n.updateParams(e,s.value)},{signal:this.#n._signal}),s}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function ub(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function lo(r){return Math.max(0,Math.min(255,255*r))}class hb{static CMYK_G([t,e,n,s]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=lo(t),[t,t,t]}static G_HTML([t]){const e=ub(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(lo)}static RGB_HTML(t){return`#${t.map(ub).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,n+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,n,s]){return[lo(1-Math.min(1,t+s)),lo(1-Math.min(1,n+s)),lo(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const s=1-t,o=1-e,c=1-n,h=Math.min(s,o,c);return["CMYK",s,o,c,h]}}class bw{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Vt("Abstract method `_createSVG` called.")}}class Dc extends bw{_createSVG(t){return document.createElementNS(_i,t)}}class Fv{static setupStorage(t,e,n,s,o){const c=s.getValue(e,{value:null});switch(n.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),o==="print")break;t.addEventListener("input",h=>{s.setValue(e,{value:h.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(c.value===n.attributes.xfaOn?t.setAttribute("checked",!0):c.value===n.attributes.xfaOff&&t.removeAttribute("checked"),o==="print")break;t.addEventListener("change",h=>{s.setValue(e,{value:h.target.checked?h.target.getAttribute("xfaOn"):h.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),o==="print")break;t.addEventListener("input",h=>{s.setValue(e,{value:h.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const h of n.children)h.attributes.value===c.value?h.attributes.selected=!0:h.attributes.hasOwnProperty("selected")&&delete h.attributes.selected}t.addEventListener("input",h=>{const d=h.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;s.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:s,linkService:o}){const{attributes:c}=e,h=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${s}`);for(const[d,f]of Object.entries(c))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!h||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}h&&o.addLinkAttributes(t,c.href,c.newWindow),n&&c.dataId&&this.setupStorage(t,c.dataId,e,n)}static render(t){const e=t.annotationStorage,n=t.linkService,s=t.xfaHtml,o=t.intent||"display",c=document.createElement(s.name);s.attributes&&this.setAttributes({html:c,element:s,intent:o,linkService:n});const h=o!=="richText",d=t.div;if(d.append(c),t.viewport){const _=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=_}h&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const _=document.createTextNode(s.value);c.append(_),h&&To.shouldBuildText(s.name)&&f.push(_)}return{textDivs:f}}const g=[[s,-1,c]];for(;g.length>0;){const[_,y,b]=g.at(-1);if(y+1===_.children.length){g.pop();continue}const A=_.children[++g.at(-1)[1]];if(A===null)continue;const{name:S}=A;if(S==="#text"){const C=document.createTextNode(A.value);f.push(C),b.append(C);continue}const w=A?.attributes?.xmlns?document.createElementNS(A.attributes.xmlns,S):document.createElement(S);if(b.append(w),A.attributes&&this.setAttributes({html:w,element:A,storage:e,intent:o,linkService:n}),A.children?.length>0)g.push([A,-1,w]);else if(A.value){const C=document.createTextNode(A.value);h&&To.shouldBuildText(S)&&f.push(C),w.append(C)}}for(const _ of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))_.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const vw=9,Ls=new WeakSet,Aw=new Date().getTimezoneOffset()*60*1e3;class db{static create(t){switch(t.data.annotationType){case pe.LINK:return new Zf(t);case pe.TEXT:return new Sw(t);case pe.WIDGET:switch(t.data.fieldType){case"Tx":return new Ew(t);case"Btn":return t.data.radioButton?new Hv(t):t.data.checkBox?new Cw(t):new Tw(t);case"Ch":return new xw(t);case"Sig":return new ww(t)}return new zs(t);case pe.POPUP:return new hf(t);case pe.FREETEXT:return new zv(t);case pe.LINE:return new Dw(t);case pe.SQUARE:return new Mw(t);case pe.CIRCLE:return new Nw(t);case pe.POLYLINE:return new Uv(t);case pe.CARET:return new kw(t);case pe.INK:return new Jf(t);case pe.POLYGON:return new Ow(t);case pe.HIGHLIGHT:return new jv(t);case pe.UNDERLINE:return new Lw(t);case pe.SQUIGGLY:return new Iw(t);case pe.STRIKEOUT:return new Pw(t);case pe.STAMP:return new Gv(t);case pe.FILEATTACHMENT:return new Bw(t);default:return new ue(t)}}}class ue{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return ue._hasPopupData(this.data)}get hasCommentButton(){return this.enableComment&&this._isEditable&&this.hasPopupElement}get commentButtonPosition(){const{quadPoints:t,rect:e}=this.data;let n=-1/0,s=-1/0;if(t?.length>=8){for(let o=0;o<t.length;o+=8)t[o+1]>s?(s=t[o+1],n=t[o+2]):t[o+1]===s&&(n=Math.max(n,t[o+2]));return[n,s]}return e?[e[2],e[3]]:null}get commentButtonColor(){if(!this.data.color)return null;const[t,e,n]=this.data.color,o=255*(1-(this.data.opacity??1));return this.#i(Math.min(t+o,255),Math.min(e+o,255),Math.min(n+o,255))}#i(t,e,n){t/=255,e/=255,n/=255;const s=Math.max(t,e,n),o=Math.min(t,e,n),c=(s+o)/2,h=((1+Math.sqrt(c))/2*100).toFixed(2);if(s===o)return`hsl(0, 0%, ${h}%)`;const d=s-o;let f;s===t?f=(e-n)/d+(e<n?6:0):s===e?f=(n-t)/d+2:f=(t-e)/d+4,f=(f*60).toFixed(2);const g=(d/(1-Math.abs(2*c-1))*100).toFixed(2);return`hsl(${f}, ${g}%, ${h}%)`}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:c}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-o)/n,t[1]=100*(t[1]-c)/s,t}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:n}=t;e&&this.#a(e);let s=this.#n?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#n.popup),s&&(s.updateEdited(t),n?.deleted&&(s.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#a(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#a(t){const{container:{style:e},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:c,pageX:h,pageY:d}}}}=this;n?.splice(0,4,...t),e.left=`${100*(t[0]-h)/o}%`,e.top=`${100*(c-t[3]+d)/c}%`,s===0?(e.width=`${100*(t[2]-t[0])/o}%`,e.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(s)}_createContainer(t){const{data:e,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",e.id),!(this instanceof zs)&&!(this instanceof Zf)&&(o.tabIndex=0);const{style:c}=o;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(o.title=e.alternativeText),e.noRotate&&o.classList.add("norotate"),!e.rect||this instanceof hf){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,o),o}const{width:h,height:d}=this;if(!t&&e.borderStyle.width>0){c.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,w=e.borderStyle.verticalCornerRadius;if(S>0||w>0){const D=`calc(${S}px * var(--total-scale-factor)) / calc(${w}px * var(--total-scale-factor))`;c.borderRadius=D}else if(this instanceof Hv){const D=`calc(${h}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;c.borderRadius=D}switch(e.borderStyle.style){case ka.SOLID:c.borderStyle="solid";break;case ka.DASHED:c.borderStyle="dashed";break;case ka.BEVELED:At("Unimplemented border style: beveled");break;case ka.INSET:At("Unimplemented border style: inset");break;case ka.UNDERLINE:c.borderBottomStyle="solid";break}const C=e.borderColor||null;C?(this.#e=!0,c.borderColor=ct.makeHexColor(C[0]|0,C[1]|0,C[2]|0)):c.borderWidth=0}const f=ct.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:g,pageHeight:_,pageX:y,pageY:b}=s.rawDims;c.left=`${100*(f[0]-y)/g}%`,c.top=`${100*(f[1]-b)/_}%`;const{rotation:A}=e;return e.hasOwnCanvas||A===0?(c.width=`${100*h/g}%`,c.height=`${100*d/_}%`):this.setRotation(A,o),o}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:o,height:c}=this;t%180!==0&&([o,c]=[c,o]),e.style.width=`${100*o/n}%`,e.style.height=`${100*c/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,s)=>{const o=s.detail[e],c=o[0],h=o.slice(1);s.target.style[n]=hb[`${c}_HTML`](h),this.annotationStorage.setValue(this.data.id,{[n]:hb[`${c}_rgb`](h)})};return Rt(this,"_commonActions",{display:e=>{const{display:n}=e.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||n[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[s,o]of Object.entries(e)){const c=n[s];if(c){const h={detail:{[s]:o},target:t};c(h),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,s,o]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,w,C,D]=t.subarray(2,6);if(s===S&&o===w&&e===C&&n===D)return}const{style:c}=this.container;let h;if(this.#e){const{borderColor:S,borderWidth:w}=c;c.borderWidth=0,h=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${w}">`],this.container.classList.add("hasBorder")}const d=s-e,f=o-n,{svgFactory:g}=this,_=g.createElement("svg");_.classList.add("quadrilateralsContainer"),_.setAttribute("width",0),_.setAttribute("height",0),_.role="none";const y=g.createElement("defs");_.append(y);const b=g.createElement("clipPath"),A=`clippath_${this.data.id}`;b.setAttribute("id",A),b.setAttribute("clipPathUnits","objectBoundingBox"),y.append(b);for(let S=2,w=t.length;S<w;S+=8){const C=t[S],D=t[S+1],x=t[S+2],I=t[S+3],O=g.createElement("rect"),P=(x-e)/d,G=(o-D)/f,Y=(C-x)/d,j=(D-I)/f;O.setAttribute("x",P),O.setAttribute("y",G),O.setAttribute("width",Y),O.setAttribute("height",j),b.append(O),h?.push(`<rect vector-effect="non-scaling-stroke" x="${P}" y="${G}" width="${Y}" height="${j}"/>`)}this.#e&&(h.push("</g></svg>')"),c.backgroundImage=h.join("")),this.container.append(_),this.container.style.clipPath=`url(#${A})`}_createPopup(t=null){const{data:e}=this;let n,s;t?(n={str:t.text},s=t.date):(n=e.contentsObj,s=e.modificationDate);const o=this.#n=new hf({data:{color:e.color,titleObj:e.titleObj,modificationDate:s,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent.div.append(o.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}render(){Vt("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:o,id:c,exportValues:h}of s){if(o===-1||c===e)continue;const d=typeof h=="string"?h:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!Ls.has(f)){At(`_getElementsByName - element not allowed: ${c}`);continue}n.push({id:c,exportValue:d,domElement:f})}return n}for(const s of document.getElementsByName(t)){const{exportValue:o}=s,c=s.getAttribute("data-element-id");c!==e&&Ls.has(s)&&n.push({id:c,exportValue:o,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class Zf extends ue{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,n=document.createElement("a");n.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(n,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(n,t.action,t.overlaidText),s=!0):t.attachment?(this.#e(n,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(this.#n(n,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(n,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,t),s=!0),t.resetForm?(this._bindResetFormAction(n,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,n=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),n&&(t.title=n)}_bindNamedAction(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),n&&(t.title=n),this.#t()}#e(t,e,n="",s=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:n&&(t.title=n),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#n(t,e,n=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),n&&(t.title=n),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const o=n.get(s);o&&(t[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const n=t.onclick;if(n||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){At('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(t.onclick=()=>!1);return}t.onclick=()=>{n?.();const{fields:s,refs:o,include:c}=e,h=[];if(s.length!==0||o.length!==0){const g=new Set(o);for(const _ of s){const y=this._fieldObjects[_]||[];for(const{id:b}of y)g.add(b)}for(const _ of Object.values(this._fieldObjects))for(const y of _)g.has(y.id)===c&&h.push(y)}else for(const g of Object.values(this._fieldObjects))h.push(...g);const d=this.annotationStorage,f=[];for(const g of h){const{id:_}=g;switch(f.push(_),g.type){case"text":{const b=g.defaultValue||"";d.setValue(_,{value:b});break}case"checkbox":case"radiobutton":{const b=g.defaultValue===g.exportValues;d.setValue(_,{value:b});break}case"combobox":case"listbox":{const b=g.defaultValue||"";d.setValue(_,{value:b});break}default:continue}const y=document.querySelector(`[data-element-id="${_}"]`);if(y){if(!Ls.has(y)){At(`_bindResetFormAction - element not allowed: ${_}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class Sw extends ue{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class zs extends ue{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Pe.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,s,o){n.includes("mouse")?t.addEventListener(n,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(n,c=>{if(n==="blur"){if(!e.focused||!c.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(c)}})})}_setEventListeners(t,e,n,s){for(const[o,c]of n)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,o,c,s),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":ct.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||vw,o=t.style;let c;const h=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-h),g=Math.round(f/(Pd*s))||1,_=f/g;c=Math.min(s,d(_/Pd))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-h);c=Math.min(s,d(f/Pd))}o.fontSize=`calc(${c}px * var(--total-scale-factor))`,o.color=ct.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class Ew extends zs{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,s){const o=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[e]=n),o.setValue(c.id,{[s]:n})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let o=s.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&o.length>c&&(o=o.slice(0,c));let h=s.formattedValue||this.data.textContent?.join(`
`)||null;h&&this.data.comb&&(h=h.replaceAll(/\s+/g,""));const d={userValue:o,formattedValue:h,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=h??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",h??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),Ls.add(n),n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:g,timeStep:_}=this.data,y=!!g&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),c&&(n.maxLength=c),n.addEventListener("input",A=>{t.setValue(e,{value:A.target.value}),this.setPropertyOnSiblings(n,"value",A.target.value,"value"),d.formattedValue=null}),n.addEventListener("resetform",A=>{const S=this.data.defaultFieldValue??"";n.value=d.userValue=S,d.formattedValue=null});let b=A=>{const{formattedValue:S}=d;S!=null&&(A.target.value=S),A.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",S=>{if(d.focused)return;const{target:w}=S;if(y&&(w.type=g,_&&(w.step=_)),d.userValue){const C=d.userValue;if(y)if(g==="time"){const D=new Date(C),x=[D.getHours(),D.getMinutes(),D.getSeconds()];w.value=x.map(I=>I.toString().padStart(2,"0")).join(":")}else w.value=new Date(C-Aw).toISOString().split(g==="date"?"T":".",1)[0];else w.value=C}d.lastCommittedValue=w.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),n.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const w={value(C){d.userValue=C.detail.value??"",y||t.setValue(e,{value:d.userValue.toString()}),C.target.value=d.userValue},formattedValue(C){const{formattedValue:D}=C.detail;d.formattedValue=D,D!=null&&C.target!==document.activeElement&&(C.target.value=D);const x={formattedValue:D};y&&(x.value=D),t.setValue(e,x)},selRange(C){C.target.setSelectionRange(...C.detail.selRange)},charLimit:C=>{const{charLimit:D}=C.detail,{target:x}=C;if(D===0){x.removeAttribute("maxLength");return}x.setAttribute("maxLength",D);let I=d.userValue;!I||I.length<=D||(I=I.slice(0,D),x.value=d.userValue=I,t.setValue(e,{value:I}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:I,willCommit:!0,commitKey:1,selStart:x.selectionStart,selEnd:x.selectionEnd}}))}};this._dispatchEventFromSandbox(w,S)}),n.addEventListener("keydown",S=>{d.commitKey=1;let w=-1;if(S.key==="Escape"?w=0:S.key==="Enter"&&!this.data.multiLine?w=2:S.key==="Tab"&&(d.commitKey=3),w===-1)return;const{value:C}=S.target;d.lastCommittedValue!==C&&(d.lastCommittedValue=C,d.userValue=C,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:w,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const A=b;b=null,n.addEventListener("blur",S=>{if(!d.focused||!S.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:w}=S;let{value:C}=w;if(y){if(C&&g==="time"){const D=C.split(":").map(x=>parseInt(x,10));C=new Date(2e3,0,1,D[0],D[1],D[2]||0).valueOf(),w.step=""}else C=new Date(C).valueOf();w.type="text"}d.userValue=C,d.lastCommittedValue!==C&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:d.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),A(S)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",S=>{d.lastCommittedValue=null;const{data:w,target:C}=S,{value:D,selectionStart:x,selectionEnd:I}=C;let O=x,P=I;switch(S.inputType){case"deleteWordBackward":{const G=D.substring(0,x).match(/\w*[^\w]*$/);G&&(O-=G[0].length);break}case"deleteWordForward":{const G=D.substring(x).match(/^[^\w]*\w*/);G&&(P+=G[0].length);break}case"deleteContentBackward":x===I&&(O-=1);break;case"deleteContentForward":x===I&&(P+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,change:w||"",willCommit:!1,selStart:O,selEnd:P}})}),this._setEventListeners(n,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(b&&n.addEventListener("blur",b),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;n.classList.add("comb"),n.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class ww extends zs{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class Cw extends zs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let s=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return Ls.add(o),o.setAttribute("data-element-id",n),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=e.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",e.exportValue),o.tabIndex=0,o.addEventListener("change",c=>{const{name:h,checked:d}=c.target;for(const f of this._getElementsByName(h,n)){const g=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=g),t.setValue(f.id,{value:g})}t.setValue(n,{value:d})}),o.addEventListener("resetform",c=>{const h=e.defaultFieldValue||"Off";c.target.checked=h===e.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",c=>{const h={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(n,{value:d.target.checked})}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Hv extends zs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let s=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(n,{value:s})),s)for(const c of this._getElementsByName(e.fieldName,n))t.setValue(c.id,{value:!1});const o=document.createElement("input");if(Ls.add(o),o.setAttribute("data-element-id",n),o.disabled=e.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=e.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",c=>{const{name:h,checked:d}=c.target;for(const f of this._getElementsByName(h,n))t.setValue(f.id,{value:!1});t.setValue(n,{value:d})}),o.addEventListener("resetform",c=>{const h=e.defaultFieldValue;c.target.checked=h!=null&&h===e.buttonValue}),this.enableScripting&&this.hasJSActions){const c=e.buttonValue;o.addEventListener("updatefromsandbox",h=>{const d={value:f=>{const g=c===f.detail.value;for(const _ of this._getElementsByName(f.target.name)){const y=g&&_.id===n;_.domElement&&(_.domElement.checked=y),t.setValue(_.id,{value:y})}}};this._dispatchEventFromSandbox(d,h)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],h=>h.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class Tw extends Zf{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class xw extends zs{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Ls.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",g=>{const _=this.data.defaultFieldValue;for(const y of s.options)y.selected=y.value===_});for(const g of this.data.options){const _=document.createElement("option");_.textContent=g.displayValue,_.value=g.exportValue,n.value.includes(g.exportValue)&&(_.setAttribute("selected",!0),o=!1),s.append(_)}let c=null;if(o){const g=document.createElement("option");g.value=" ",g.setAttribute("hidden",!0),g.setAttribute("selected",!0),s.prepend(g),c=()=>{g.remove(),s.removeEventListener("input",c),c=null},s.addEventListener("input",c)}const h=g=>{const _=g?"value":"textContent",{options:y,multiple:b}=s;return b?Array.prototype.filter.call(y,A=>A.selected).map(A=>A[_]):y.selectedIndex===-1?null:y[y.selectedIndex][_]};let d=h(!1);const f=g=>{const _=g.target.options;return Array.prototype.map.call(_,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",g=>{const _={value(y){c?.();const b=y.detail.value,A=new Set(Array.isArray(b)?b:[b]);for(const S of s.options)S.selected=A.has(S.value);t.setValue(e,{value:h(!0)}),d=h(!1)},multipleSelection(y){s.multiple=!0},remove(y){const b=s.options,A=y.detail.remove;b[A].selected=!1,s.remove(A),b.length>0&&Array.prototype.findIndex.call(b,w=>w.selected)===-1&&(b[0].selected=!0),t.setValue(e,{value:h(!0),items:f(y)}),d=h(!1)},clear(y){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),d=h(!1)},insert(y){const{index:b,displayValue:A,exportValue:S}=y.detail.insert,w=s.children[b],C=document.createElement("option");C.textContent=A,C.value=S,w?w.before(C):s.append(C),t.setValue(e,{value:h(!0),items:f(y)}),d=h(!1)},items(y){const{items:b}=y.detail;for(;s.length!==0;)s.remove(0);for(const A of b){const{displayValue:S,exportValue:w}=A,C=document.createElement("option");C.textContent=S,C.value=w,s.append(C)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:h(!0),items:f(y)}),d=h(!1)},indices(y){const b=new Set(y.detail.indices);for(const A of y.target.options)A.selected=b.has(A.index);t.setValue(e,{value:h(!0)}),d=h(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(_,g)}),s.addEventListener("input",g=>{const _=h(!0),y=h(!1);t.setValue(e,{value:_}),g.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:y,changeEx:_,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],g=>g.target.value)):s.addEventListener("input",function(g){t.setValue(e,{value:h(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class hf extends ue{constructor(t){const{data:e,elements:n}=t;super(t,{isRenderable:ue._hasPopupData(e)}),this.elements=n,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new Rw({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,eventBus:this.linkService.eventBus}),n=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${jf}${s}`).join(",")),this.container}}class Rw{#t=this.#L.bind(this);#e=this.#C.bind(this);#n=this.#H.bind(this);#i=this.#N.bind(this);#a=null;#s=null;#r=null;#o=null;#l=null;#c=null;#d=null;#u=null;#f=!1;#g=null;#p=null;#h=null;#m=null;#b=null;#_=null;#A=null;#S=null;#y=null;#E=null;#R=!1;constructor({container:t,color:e,elements:n,titleObj:s,modificationDate:o,contentsObj:c,richText:h,parent:d,rect:f,parentRect:g,open:_,eventBus:y=null}){this.#s=t,this.#y=s,this.#r=c,this.#S=h,this.#d=d,this.#a=e,this.#A=f,this.#u=g,this.#l=n,this.#c=y,this.#o=rf.toDateObject(o),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup()),this.#T(),this.#s.hidden=!0,_&&this.#N()}#T(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#i,{signal:t}),e.addEventListener("mouseenter",this.#n,{signal:t}),e.addEventListener("mouseleave",this.#e,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#t,{signal:t});this.#O()}#w(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#b=t._normalizePoint(t.commentButtonPosition),this.#_=t.commentButtonColor)}#O(){if(this.#m||(this.#b||this.#w(),!this.#b))return;const t=this.#m=document.createElement("button");t.className="annotationCommentButton";const e=this.#l[0].container;t.style.zIndex=e.style.zIndex+1,t.tabIndex=0;const{signal:n}=this.#p;t.addEventListener("hover",this.#i,{signal:n}),t.addEventListener("keydown",this.#t,{signal:n}),t.addEventListener("click",()=>{const[{data:{id:o},annotationEditorType:c}]=this.#l;this.#c?.dispatch("switchannotationeditormode",{source:this,editId:o,mode:c,editComment:!0})},{signal:n});const{style:s}=t;s.left=`calc(${this.#b[0]}%)`,s.top=`calc(${this.#b[1]}% - var(--comment-button-dim))`,this.#_&&(s.backgroundColor=this.#_),e.after(t)}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#a){const s=t.style.outlineColor=ct.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${s} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#y?.str){const s=document.createElement("span");s.className="title",e.append(s),{dir:s.dir,str:s.textContent}=this.#y}if(t.append(e),this.#o){const s=document.createElement("time");s.className="popupDate",s.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),s.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),s.dateTime=this.#o.toISOString(),e.append(s)}const n=this.#x;if(n)Fv.render({xfaHtml:n,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const s=this._formatContents(this.#r);t.append(s)}this.#s.append(t)}get#x(){const t=this.#S,e=this.#r;return t?.str&&(!e?.str||e.str===t.str)&&this.#S.html||null}get#D(){return this.#x?.attributes?.style?.fontSize||0}get#I(){return this.#x?.attributes?.style?.color||null}#k(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:this.#I,fontSize:this.#D?`calc(${this.#D}px * var(--total-scale-factor))`:""}};for(const o of t.split(`
`))e.push({name:"span",value:o,attributes:s});return n}_formatContents({str:t,dir:e}){const n=document.createElement("p");n.classList.add("popupContent"),n.dir=e;const s=t.split(/(?:\r\n?|\n)/);for(let o=0,c=s.length;o<c;++o){const h=s[o];n.append(document.createTextNode(h)),o<c-1&&n.append(document.createElement("br"))}return n}#L(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#N()}updateEdited({rect:t,popup:e,deleted:n}){if(n||e?.deleted){this.remove();return}this.#T(),this.#E||={contentsObj:this.#r,richText:this.#S},t&&(this.#h=null),e&&(this.#S=this.#k(e.text),this.#o=rf.toDateObject(e.date),this.#r=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#E&&({contentsObj:this.#r,richText:this.#S}=this.#E,this.#E=null,this.#g?.remove(),this.#g=null,this.#h=null)}remove(){this.#p?.abort(),this.#p=null,this.#g?.remove(),this.#g=null,this.#R=!1,this.#f=!1;for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#P(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:s,pageY:o}}}=this.#d;let c=!!this.#u,h=c?this.#u:this.#A;for(const A of this.#l)if(!h||ct.intersect(A.data.rect,h)!==null){h=A.data.rect,c=!0;break}const d=ct.normalizeRect([h[0],t[3]-h[1]+t[1],h[2],t[3]-h[3]+t[1]]),g=c?h[2]-h[0]+5:0,_=d[0]+g,y=d[1];this.#h=[100*(_-s)/e,100*(y-o)/n];const{style:b}=this.#s;b.left=`${this.#h[0]}%`,b.top=`${this.#h[1]}%`}#N(){this.#f=!this.#f,this.#f?(this.#H(),this.#s.addEventListener("click",this.#i),this.#s.addEventListener("keydown",this.#t)):(this.#C(),this.#s.removeEventListener("click",this.#i),this.#s.removeEventListener("keydown",this.#t))}#H(){this.#g||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#P(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#C(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#R=this.isVisible,this.#R&&(this.#s.hidden=!0)}maybeShow(){this.#T(),this.#R&&(this.#g||this.#H(),this.#R=!1,this.#s.hidden=!1)}get isVisible(){return this.#s.hidden===!1}}class zv extends ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=vt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Dw extends ue{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),o=this.#t=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Mw extends ue{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),o=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",o/2),c.setAttribute("y",o/2),c.setAttribute("width",e-o),c.setAttribute("height",n-o),c.setAttribute("stroke-width",o||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),s.append(c),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Nw extends ue{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:n}=this,s=this.svgFactory.create(e,n,!0),o=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",e/2),c.setAttribute("cy",n/2),c.setAttribute("rx",e/2-o/2),c.setAttribute("ry",n/2-o/2),c.setAttribute("stroke-width",o||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),s.append(c),this.container.append(s),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Uv extends ue{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:n,popupRef:s},width:o,height:c}=this;if(!e)return this.container;const h=this.svgFactory.create(o,c,!0);let d=[];for(let g=0,_=e.length;g<_;g+=2){const y=e[g]-t[0],b=t[3]-e[g+1];d.push(`${y},${b}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),h.append(f),this.container.append(h),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Ow extends Uv{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class kw extends ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Jf extends ue{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?vt.HIGHLIGHT:vt.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:n,borderStyle:s,popupRef:o}}=this,{transform:c,width:h,height:d}=this.#n(e,t),f=this.svgFactory.create(h,d,!0),g=this.#t=this.svgFactory.createElement("svg:g");f.append(g),g.setAttribute("stroke-width",s.width||1),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.setAttribute("stroke-miterlimit",10),g.setAttribute("stroke","transparent"),g.setAttribute("fill","transparent"),g.setAttribute("transform",c);for(let _=0,y=n.length;_<y;_++){const b=this.svgFactory.createElement(this.svgElementName);this.#e.push(b),b.setAttribute("points",n[_].join(",")),g.append(b)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:n,rect:s}=t,o=this.#t;if(e>=0&&o.setAttribute("stroke-width",e||1),n)for(let c=0,h=this.#e.length;c<h;c++)this.#e[c].setAttribute("points",n[c].join(","));if(s){const{transform:c,width:h,height:d}=this.#n(this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${h} ${d}`),o.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}get commentButtonPosition(){const{inkLists:t,rect:e}=this.data;if(t?.length>=1){let n=-1/0,s=-1/0;for(const o of t)for(let c=0,h=o.length;c<h;c+=2)o[c+1]>s?(s=o[c+1],n=o[c]):o[c+1]===s&&(n=Math.max(n,o[c]));if(n!==1/0)return[n,s]}return e?[e[2],e[3]]:null}}class jv extends ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=vt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Lw extends ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Iw extends ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Pw extends ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class Gv extends ue{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=vt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class Bw extends ue{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let n;e.hasAppearance||e.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#e.bind(this)),this.#t=n;const{isMac:s}=Pe.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),t.append(n),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class tp{#t=null;#e=null;#n=new Map;#i=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:c,structTreeLayer:h}){this.div=t,this.#t=e,this.#e=n,this.#i=h||null,this.page=o,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return this.#n.size>0}async#a(t,e,n){const s=t.firstChild||t,o=s.id=`${jf}${e}`,c=await this.#i?.getAriaAttributes(o);if(c)for(const[h,d]of c)s.setAttribute(h,d);n?n.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,s,!1))}async render(t){const{annotations:e}=t,n=this.div;ks(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Dc,annotationStorage:t.annotationStorage||new Xf,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const c of e){if(c.noHTML)continue;const h=c.annotationType===pe.POPUP;if(h){const g=s.get(c.id);if(!g)continue;o.elements=g}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;o.data=c;const d=db.create(o);if(!d.isRenderable)continue;if(!h&&c.popupRef){const g=s.get(c.popupRef);g?g.push(d):s.set(c.popupRef,[d])}const f=d.render();c.hidden&&(f.style.visibility="hidden"),await this.#a(f,c.id,o.elements),d._isEditable&&(this.#n.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}this.#s()}async addLinkAnnotations(t,e){const n={data:null,layer:this.div,linkService:e,svgFactory:new Dc,parent:this};for(const s of t){s.borderStyle||=tp._defaultBorderStyle,n.data=s;const o=db.create(n);if(!o.isRenderable)continue;const c=o.render();await this.#a(c,s.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,ks(e,{rotation:t.rotation}),this.#s(),e.hidden=!1}#s(){if(!this.#e)return;const t=this.div;for(const[e,n]of this.#e){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):s.append(n);const c=this.#n.get(e);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,s.id,n),c._hasNoCanvas=!1):c.canvas=n)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}static get _defaultBorderStyle(){return Rt(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ka.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const _c=/\r\n?|\n/g;class Ee extends dt{#t;#e="";#n=`${this.id}-editor`;#i=null;#a;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Ee.prototype,e=o=>o.isEmpty(),n=es.TRANSLATE_SMALL,s=es.TRANSLATE_BIG;return Rt(this,"_keyboardManager",new jo([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-n,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[n,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-n],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,n],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static _type="freetext";static _editorType=vt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||Ee._defaultColor||dt._defaultLineColor,this.#a=t.fontSize||Ee._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){dt.initialize(t,e);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case kt.FREETEXT_SIZE:Ee._defaultFontSize=e;break;case kt.FREETEXT_COLOR:Ee._defaultColor=e;break}}updateParams(t,e){switch(t){case kt.FREETEXT_SIZE:this.#s(e);break;case kt.FREETEXT_COLOR:this.#r(e);break}}static get defaultPropertiesToUpdate(){return[[kt.FREETEXT_SIZE,Ee._defaultFontSize],[kt.FREETEXT_COLOR,Ee._defaultColor||dt._defaultLineColor]]}get propertiesToUpdate(){return[[kt.FREETEXT_SIZE,this.#a],[kt.FREETEXT_COLOR,this.#t]]}get toolbarButtons(){return this._colorPicker||=new Ro(this),[["colorPicker",this._colorPicker]]}get colorType(){return kt.FREETEXT_COLOR}get colorValue(){return this.#t}#s(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#a)*this.parentScale),this.#a=s,this.#l()},n=this.#a;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#r(t){const e=s=>{this.#t=this.editorDiv.style.color=s,this._colorPicker?.update(s)},n=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ee._internalPadding*t,-(Ee._internalPadding+this.#a)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#n),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const n of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(t.push(Ee.#c(n)),e=n);return t.join(`
`)}#l(){const[t,e]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,c=o.style.display,h=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=c,o.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=n.width/t,this.height=n.height/e):(this.width=n.height/t,this.height=n.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const n=s=>{if(this.#e=s,!s){this.remove();return}this.#d(),this._uiManager.rebuild(this),this.#l()};this.addCommands({cmd:()=>{n(e)},undo:()=>{n(t)},mustExec:!1}),this.#l()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ee._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#n),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#a}px * var(--total-scale-factor))`,n.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[h,d]=this.getInitialTranslation();[h,d]=this.pageTranslationToScreen(h,d);const[f,g]=this.pageDimensions,[_,y]=this.pageTranslation;let b,A;switch(this.rotation){case 0:b=t+(c[0]-_)/f,A=e+this.height-(c[1]-y)/g;break;case 90:b=t+(c[0]-_)/f,A=e-(c[1]-y)/g,[h,d]=[d,-h];break;case 180:b=t-this.width+(c[0]-_)/f,A=e-(c[1]-y)/g,[h,d]=[-h,-d];break;case 270:b=t+(c[0]-_-this.height*g)/f,A=e+(c[1]-y-this.width*f)/g,[h,d]=[-d,h];break}this.setAt(b*s,A*o,h,d)}else this._moveAfterPaste(t,e);this.#d(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(_c,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:n}=e;if(n.length===1&&n[0]==="text/plain")return;t.preventDefault();const s=Ee.#f(e.getData("text")||"").replaceAll(_c,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const c=o.getRangeAt(0);if(!s.includes(`
`)){c.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:h,startOffset:d}=c,f=[],g=[];if(h.nodeType===Node.TEXT_NODE){const b=h.parentElement;if(g.push(h.nodeValue.slice(d).replaceAll(_c,"")),b!==this.editorDiv){let A=f;for(const S of this.editorDiv.childNodes){if(S===b){A=g;continue}A.push(Ee.#c(S))}}f.push(h.nodeValue.slice(0,d).replaceAll(_c,""))}else if(h===this.editorDiv){let b=f,A=0;for(const S of this.editorDiv.childNodes)A++===d&&(b=g),b.push(Ee.#c(S))}this.#e=`${f.join(`
`)}${s}${g.join(`
`)}`,this.#d();const _=new Range;let y=Math.sumPrecise(f.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const A=b.nodeValue.length;if(y<=A){_.setStart(b,y),_.setEnd(b,y);break}y-=A}o.removeAllRanges(),o.addRange(_)}#d(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(" "," ")}static#f(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ee._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,n){let s=null;if(t instanceof zv){const{data:{defaultAppearanceData:{fontSize:c,fontColor:h},rect:d,rotation:f,id:g,popupRef:_,contentsObj:y},textContent:b,textPosition:A,parent:{page:{pageNumber:S}}}=t;if(!b||b.length===0)return null;s=t={annotationType:vt.FREETEXT,color:Array.from(h),fontSize:c,value:b.join(`
`),position:A,pageIndex:S-1,rect:d.slice(0),rotation:f,annotationElementId:g,id:g,deleted:!1,popupRef:_,comment:y?.str||null}}const o=await super.deserialize(t,e,n);return o.#a=t.fontSize,o.#t=ct.makeHexColor(...t.color),o.#e=Ee.#f(t.value),o._initialData=s,t.comment&&o.setCommentData(t.comment),o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),n=dt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),s={annotationType:vt.FREETEXT,color:n,fontSize:this.#a,value:this.#u(),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!this.#g(s)?null:(s.id=this.annotationElementId,s)}#g(t){const{value:e,fontSize:n,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==n||t.color.some((c,h)=>c!==s[h])||t.pageIndex!==o}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:n}=e;n.fontSize=`calc(${this.#a}px * var(--total-scale-factor))`,n.color=this.#t,e.replaceChildren();for(const o of this.#e.split(`
`)){const c=document.createElement("div");c.append(o?document.createTextNode(o):document.createElement("br")),e.append(c)}const s={rect:this.getPDFRect()};return s.popup=this.hasEditedComment?this.comment:{text:this.#e},t.updateEdited(s),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class ot{static PRECISION=1e-4;toSVGPath(){Vt("Abstract method `toSVGPath` must be implemented.")}get box(){Vt("Abstract getter `box` must be implemented.")}serialize(t,e){Vt("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,s,o,c){c||=new Float32Array(t.length);for(let h=0,d=t.length;h<d;h+=2)c[h]=e+t[h]*s,c[h+1]=n+t[h+1]*o;return c}static _rescaleAndSwap(t,e,n,s,o,c){c||=new Float32Array(t.length);for(let h=0,d=t.length;h<d;h+=2)c[h]=e+t[h+1]*s,c[h+1]=n+t[h]*o;return c}static _translate(t,e,n,s){s||=new Float32Array(t.length);for(let o=0,c=t.length;o<c;o+=2)s[o]=e+t[o],s[o+1]=n+t[o+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,s,o){switch(o){case 90:return[1-e/n,t/s];case 180:return[1-t/n,1-e/s];case 270:return[e/n,1-t/s];default:return[t/n,e/s]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,s,o,c){return[(t+5*n)/6,(e+5*s)/6,(5*n+o)/6,(5*s+c)/6,(n+o)/2,(s+c)/2]}}class xs{#t;#e=[];#n;#i;#a=[];#s=new Float32Array(18);#r;#o;#l;#c;#d;#u;#f=[];static#g=8;static#p=2;static#h=xs.#g+xs.#p;constructor({x:t,y:e},n,s,o,c,h=0){this.#t=n,this.#u=o*s,this.#i=c,this.#s.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=h,this.#c=xs.#g*s,this.#l=xs.#h*s,this.#d=s,this.#f.push(t,e)}isEmpty(){return isNaN(this.#s[8])}#m(){const t=this.#s.subarray(4,6),e=this.#s.subarray(16,18),[n,s,o,c]=this.#t;return[(this.#r+(t[0]-e[0])/2-n)/o,(this.#o+(t[1]-e[1])/2-s)/c,(this.#r+(e[0]-t[0])/2-n)/o,(this.#o+(e[1]-t[1])/2-s)/c]}add({x:t,y:e}){this.#r=t,this.#o=e;const[n,s,o,c]=this.#t;let[h,d,f,g]=this.#s.subarray(8,12);const _=t-f,y=e-g,b=Math.hypot(_,y);if(b<this.#l)return!1;const A=b-this.#c,S=A/b,w=S*_,C=S*y;let D=h,x=d;h=f,d=g,f+=w,g+=C,this.#f?.push(t,e);const I=-C/A,O=w/A,P=I*this.#u,G=O*this.#u;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([f+P,g+G],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([f-P,g-G],16),isNaN(this.#s[6])?(this.#a.length===0&&(this.#s.set([h+P,d+G],2),this.#a.push(NaN,NaN,NaN,NaN,(h+P-n)/o,(d+G-s)/c),this.#s.set([h-P,d-G],14),this.#e.push(NaN,NaN,NaN,NaN,(h-P-n)/o,(d-G-s)/c)),this.#s.set([D,x,h,d,f,g],6),!this.isEmpty()):(this.#s.set([D,x,h,d,f,g],6),Math.abs(Math.atan2(x-d,D-h)-Math.atan2(C,w))<Math.PI/2?([h,d,f,g]=this.#s.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((h+f)/2-n)/o,((d+g)/2-s)/c),[h,d,D,x]=this.#s.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((D+h)/2-n)/o,((x+d)/2-s)/c),!0):([D,x,h,d,f,g]=this.#s.subarray(0,6),this.#a.push(((D+5*h)/6-n)/o,((x+5*d)/6-s)/c,((5*h+f)/6-n)/o,((5*d+g)/6-s)/c,((h+f)/2-n)/o,((d+g)/2-s)/c),[f,g,h,d,D,x]=this.#s.subarray(12,18),this.#e.push(((D+5*h)/6-n)/o,((x+5*d)/6-s)/c,((5*h+f)/6-n)/o,((5*d+g)/6-s)/c,((h+f)/2-n)/o,((d+g)/2-s)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#b();const n=[];n.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);this.#A(n);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return this.#_(n),n.join(" ")}#b(){const[t,e,n,s]=this.#t,[o,c,h,d]=this.#m();return`M${(this.#s[2]-t)/n} ${(this.#s[3]-e)/s} L${(this.#s[4]-t)/n} ${(this.#s[5]-e)/s} L${o} ${c} L${h} ${d} L${(this.#s[16]-t)/n} ${(this.#s[17]-e)/s} L${(this.#s[14]-t)/n} ${(this.#s[15]-e)/s} Z`}#_(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#A(t){const[e,n,s,o]=this.#t,c=this.#s.subarray(4,6),h=this.#s.subarray(16,18),[d,f,g,_]=this.#m();t.push(`L${(c[0]-e)/s} ${(c[1]-n)/o} L${d} ${f} L${g} ${_} L${(h[0]-e)/s} ${(h[1]-n)/o}`)}newFreeDrawOutline(t,e,n,s,o,c){return new qv(t,e,n,s,o,c)}getOutlines(){const t=this.#a,e=this.#e,n=this.#s,[s,o,c,h]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let _=0,y=d.length-2;_<y;_+=2)d[_]=(this.#f[_]-s)/c,d[_+1]=(this.#f[_+1]-o)/h;if(d[d.length-2]=(this.#r-s)/c,d[d.length-1]=(this.#o-o)/h,isNaN(n[6])&&!this.isEmpty())return this.#S(d);const f=new Float32Array(this.#a.length+24+this.#e.length);let g=t.length;for(let _=0;_<g;_+=2){if(isNaN(t[_])){f[_]=f[_+1]=NaN;continue}f[_]=t[_],f[_+1]=t[_+1]}g=this.#E(f,g);for(let _=e.length-6;_>=6;_-=6)for(let y=0;y<6;y+=2){if(isNaN(e[_+y])){f[g]=f[g+1]=NaN,g+=2;continue}f[g]=e[_+y],f[g+1]=e[_+y+1],g+=2}return this.#y(f,g),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#n,this.#i)}#S(t){const e=this.#s,[n,s,o,c]=this.#t,[h,d,f,g]=this.#m(),_=new Float32Array(36);return _.set([NaN,NaN,NaN,NaN,(e[2]-n)/o,(e[3]-s)/c,NaN,NaN,NaN,NaN,(e[4]-n)/o,(e[5]-s)/c,NaN,NaN,NaN,NaN,h,d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,(e[16]-n)/o,(e[17]-s)/c,NaN,NaN,NaN,NaN,(e[14]-n)/o,(e[15]-s)/c],0),this.newFreeDrawOutline(_,t,this.#t,this.#d,this.#n,this.#i)}#y(t,e){const n=this.#e;return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6}#E(t,e){const n=this.#s.subarray(4,6),s=this.#s.subarray(16,18),[o,c,h,d]=this.#t,[f,g,_,y]=this.#m();return t.set([NaN,NaN,NaN,NaN,(n[0]-o)/h,(n[1]-c)/d,NaN,NaN,NaN,NaN,f,g,NaN,NaN,NaN,NaN,_,y,NaN,NaN,NaN,NaN,(s[0]-o)/h,(s[1]-c)/d],e),e+=24}}class qv extends ot{#t;#e=new Float32Array(4);#n;#i;#a;#s;#r;constructor(t,e,n,s,o,c){super(),this.#r=t,this.#a=e,this.#t=n,this.#s=s,this.#n=o,this.#i=c,this.lastPoint=[NaN,NaN],this.#o(c);const[h,d,f,g]=this.#e;for(let _=0,y=t.length;_<y;_+=2)t[_]=(t[_]-h)/f,t[_+1]=(t[_+1]-d)/g;for(let _=0,y=e.length;_<y;_+=2)e[_]=(e[_]-h)/f,e[_+1]=(e[_+1]-d)/g}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,n=this.#r.length;e<n;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,n,s],o){const c=n-t,h=s-e;let d,f;switch(o){case 0:d=ot._rescale(this.#r,t,s,c,-h),f=ot._rescale(this.#a,t,s,c,-h);break;case 90:d=ot._rescaleAndSwap(this.#r,t,e,c,h),f=ot._rescaleAndSwap(this.#a,t,e,c,h);break;case 180:d=ot._rescale(this.#r,n,e,-c,h),f=ot._rescale(this.#a,n,e,-c,h);break;case 270:d=ot._rescaleAndSwap(this.#r,n,s,-c,-h),f=ot._rescaleAndSwap(this.#a,n,s,-c,-h);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#r;let n=e[4],s=e[5];const o=[n,s,n,s];let c=n,h=s;const d=t?Math.max:Math.min;for(let g=6,_=e.length;g<_;g+=6){const y=e[g+4],b=e[g+5];if(isNaN(e[g]))ct.pointBoundingBox(y,b,o),h<b?(c=y,h=b):h===b&&(c=d(c,y));else{const A=[1/0,1/0,-1/0,-1/0];ct.bezierBoundingBox(n,s,...e.slice(g,g+6),A),ct.rectBoundingBox(...A,o),h<A[3]?(c=A[2],h=A[3]):h===A[3]&&(c=d(c,A[2]))}n=y,s=b}const f=this.#e;f[0]=o[0]-this.#n,f[1]=o[1]-this.#n,f[2]=o[2]-o[0]+2*this.#n,f[3]=o[3]-o[1]+2*this.#n,this.lastPoint=[c,h]}get box(){return this.#e}newOutliner(t,e,n,s,o,c=0){return new xs(t,e,n,s,o,c)}getNewOutline(t,e){const[n,s,o,c]=this.#e,[h,d,f,g]=this.#t,_=o*f,y=c*g,b=n*f+h,A=s*g+d,S=this.newOutliner({x:this.#a[0]*_+b,y:this.#a[1]*y+A},this.#t,this.#s,t,this.#i,e??this.#n);for(let w=2;w<this.#a.length;w+=2)S.add({x:this.#a[w]*_+b,y:this.#a[w+1]*y+A});return S.getOutlines()}}class df{#t;#e;#n=[];#i=[];constructor(t,e=0,n=0,s=!0){const o=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:b,y:A,width:S,height:w}of t){const C=Math.floor((b-e)/c)*c,D=Math.ceil((b+S+e)/c)*c,x=Math.floor((A-e)/c)*c,I=Math.ceil((A+w+e)/c)*c,O=[C,x,I,!0],P=[D,x,I,!1];this.#n.push(O,P),ct.rectBoundingBox(C,x,D,I,o)}const h=o[2]-o[0]+2*n,d=o[3]-o[1]+2*n,f=o[0]-n,g=o[1]-n,_=this.#n.at(s?-1:-2),y=[_[0],_[2]];for(const b of this.#n){const[A,S,w]=b;b[0]=(A-f)/h,b[1]=(S-g)/d,b[2]=(w-g)/d}this.#t=new Float32Array([f,g,h,d]),this.#e=y}getOutlines(){this.#n.sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#r(e)):(this.#o(e),t.push(...this.#l(e)));return this.#a(t)}#a(t){const e=[],n=new Set;for(const c of t){const[h,d,f]=c;e.push([h,d,c],[h,f,c])}e.sort((c,h)=>c[1]-h[1]||c[0]-h[0]);for(let c=0,h=e.length;c<h;c+=2){const d=e[c][2],f=e[c+1][2];d.push(f),f.push(d),n.add(d),n.add(f)}const s=[];let o;for(;n.size>0;){const c=n.values().next().value;let[h,d,f,g,_]=c;n.delete(c);let y=h,b=d;for(o=[h,f],s.push(o);;){let A;if(n.has(g))A=g;else if(n.has(_))A=_;else break;n.delete(A),[h,d,f,g,_]=A,y!==h&&(o.push(y,b,h,b===d?d:f),y=h),b=b===d?f:d}o.push(y,b)}return new Fw(s,this.#t,this.#e)}#s(t){const e=this.#i;let n=0,s=e.length-1;for(;n<=s;){const o=n+s>>1,c=e[o][0];if(c===t)return o;c<t?n=o+1:s=o-1}return s+1}#r([,t,e]){const n=this.#s(t);this.#i.splice(n,0,[t,e])}#o([,t,e]){const n=this.#s(t);for(let s=n;s<this.#i.length;s++){const[o,c]=this.#i[s];if(o!==t)break;if(o===t&&c===e){this.#i.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,c]=this.#i[s];if(o!==t)break;if(o===t&&c===e){this.#i.splice(s,1);return}}}#l(t){const[e,n,s]=t,o=[[e,n,s]],c=this.#s(s);for(let h=0;h<c;h++){const[d,f]=this.#i[h];for(let g=0,_=o.length;g<_;g++){const[,y,b]=o[g];if(!(f<=y||b<=d)){if(y>=d){if(b>f)o[g][1]=f;else{if(_===1)return[];o.splice(g,1),g--,_--}continue}o[g][2]=d,b>f&&o.push([e,f,b])}}}return o}}class Fw extends ot{#t;#e;constructor(t,e,n){super(),this.#e=t,this.#t=e,this.lastPoint=n}toSVGPath(){const t=[];for(const e of this.#e){let[n,s]=e;t.push(`M${n} ${s}`);for(let o=2;o<e.length;o+=2){const c=e[o],h=e[o+1];c===n?(t.push(`V${h}`),s=h):h===s&&(t.push(`H${c}`),n=c)}t.push("Z")}return t.join(" ")}serialize([t,e,n,s],o){const c=[],h=n-t,d=s-e;for(const f of this.#e){const g=new Array(f.length);for(let _=0;_<f.length;_+=2)g[_]=t+f[_]*h,g[_+1]=s-f[_+1]*d;c.push(g)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class ff extends xs{newFreeDrawOutline(t,e,n,s,o,c){return new Hw(t,e,n,s,o,c)}}class Hw extends qv{newOutliner(t,e,n,s,o,c=0){return new ff(t,e,n,s,o,c)}}class le extends dt{#t=null;#e=0;#n;#i=null;#a=null;#s=null;#r=null;#o=0;#l=null;#c=null;#d=null;#u=!1;#f=null;#g;#p=null;#h="";#m;#b="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=vt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=le.prototype;return Rt(this,"_keyboardManager",new jo([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||le._defaultColor,this.#m=t.thickness||le._defaultThickness,this.#g=t.opacity||le._defaultOpacity,this.#n=t.boxes||null,this.#b=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#A(t),this.#T()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#o=t.focusOffset,this.#_(),this.#T(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#b}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#_(){const t=new df(this.#n,.001);this.#c=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#c.box;const e=new df(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#s=e.getOutlines();const{lastPoint:n}=this.#s;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height]}#A({highlightOutlines:t,highlightId:e,clipPathId:n}){this.#c=t;const s=1.5;if(this.#s=t.getNewOutline(this.#m/2+s,.0025),e>=0)this.#d=e,this.#i=n,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:le.#w(this.#c.box,(g-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:le.#w(this.#s.box,g),path:{d:this.#s.toSVGPath()}})}const[o,c,h,d]=t.box;switch(this.rotation){case 0:this.x=o,this.y=c,this.width=h,this.height=d;break;case 90:{const[g,_]=this.parentDimensions;this.x=c,this.y=1-o,this.width=h*_/g,this.height=d*g/_;break}case 180:this.x=1-o,this.y=1-c,this.width=h,this.height=d;break;case 270:{const[g,_]=this.parentDimensions;this.x=1-c,this.y=o,this.width=h*_/g,this.height=d*g/_;break}}const{lastPoint:f}=this.#s;this.#f=[(f[0]-o)/h,(f[1]-c)/d]}static initialize(t,e){dt.initialize(t,e),le._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case kt.HIGHLIGHT_COLOR:le._defaultColor=e;break;case kt.HIGHLIGHT_THICKNESS:le._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#f}updateParams(t,e){switch(t){case kt.HIGHLIGHT_COLOR:this.#S(e);break;case kt.HIGHLIGHT_THICKNESS:this.#y(e);break}}static get defaultPropertiesToUpdate(){return[[kt.HIGHLIGHT_COLOR,le._defaultColor],[kt.HIGHLIGHT_THICKNESS,le._defaultThickness]]}get propertiesToUpdate(){return[[kt.HIGHLIGHT_COLOR,this.color||le._defaultColor],[kt.HIGHLIGHT_THICKNESS,this.#m||le._defaultThickness],[kt.HIGHLIGHT_FREE,this.#u]]}#S(t){const e=(o,c)=>{this.color=o,this.#g=c,this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:o,"fill-opacity":c}}),this.#a?.updateColor(o)},n=this.color,s=this.#g;this.addCommands({cmd:e.bind(this,t,le._defaultOpacity),undo:e.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#y(t){const e=this.#m,n=s=>{this.#m=s,this.#E(s)};this.addCommands({cmd:n.bind(this,t),undo:n.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:kt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Tn({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#R(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#T(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#R():t&&(this.#T(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#E(t){if(!this.#u)return;this.#A({highlightOutlines:this.#c.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}#R(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#T(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#c.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#g},rootClass:{highlight:!0,free:this.#u},path:{d:this.#c.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#u),this.#l&&(this.#l.style.clipPath=this.#i))}static#w([t,e,n,s],o){switch(o){case 90:return[1-e-s,t,s,n];case 180:return[1-t-n,1-e-s,n,s];case 270:return[e,1-t-n,s,n]}return[t,e,n,s]}rotate(t){const{drawLayer:e}=this.parent;let n;this.#u?(t=(t-this.rotation+360)%360,n=le.#w(this.#c.box,t)):n=le.#w([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:le.#w(this.#s.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#O.bind(this),{signal:this._uiManager._signal});const e=this.#l=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i;const[n,s]=this.parentDimensions;return this.setDims(this.width*n,this.height*s),bv(this,this.#l,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#O(t){le._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#x(!0);break;case 1:case 3:this.#x(!1);break}}#x(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#x(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#D(){return this.#u?this.rotation:0}#I(){if(this.#u)return null;const[t,e]=this.pageDimensions,[n,s]=this.pageTranslation,o=this.#n,c=new Float32Array(o.length*8);let h=0;for(const{x:d,y:f,width:g,height:_}of o){const y=d*t+n,b=(1-f)*e+s;c[h]=c[h+4]=y,c[h+1]=c[h+3]=b,c[h+2]=c[h+6]=y+g*t,c[h+5]=c[h+7]=b-_*e,h+=8}return c}#k(t){return this.#c.serialize(t,this.#D())}static startHighlighting(t,e,{target:n,x:s,y:o}){const{x:c,y:h,width:d,height:f}=n.getBoundingClientRect(),g=new AbortController,_=t.combinedSignal(g),y=b=>{g.abort(),this.#P(t,b)};window.addEventListener("blur",y,{signal:_}),window.addEventListener("pointerup",y,{signal:_}),window.addEventListener("pointerdown",ge,{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",Rn,{signal:_}),n.addEventListener("pointermove",this.#L.bind(this,t),{signal:_}),this._freeHighlight=new ff({x:s,y:o},[c,h,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#P(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,n){let s=null;if(t instanceof jv){const{data:{quadPoints:A,rect:S,rotation:w,id:C,color:D,opacity:x,popupRef:I,contentsObj:O},parent:{page:{pageNumber:P}}}=t;s=t={annotationType:vt.HIGHLIGHT,color:Array.from(D),opacity:x,quadPoints:A,boxes:null,pageIndex:P-1,rect:S.slice(0),rotation:w,annotationElementId:C,id:C,deleted:!1,popupRef:I,comment:O?.str||null}}else if(t instanceof Jf){const{data:{inkLists:A,rect:S,rotation:w,id:C,color:D,borderStyle:{rawWidth:x},popupRef:I,contentsObj:O},parent:{page:{pageNumber:P}}}=t;s=t={annotationType:vt.HIGHLIGHT,color:Array.from(D),thickness:x,inkLists:A,boxes:null,pageIndex:P-1,rect:S.slice(0),rotation:w,annotationElementId:C,id:C,deleted:!1,popupRef:I,comment:O?.str||null}}const{color:o,quadPoints:c,inkLists:h,opacity:d}=t,f=await super.deserialize(t,e,n);f.color=ct.makeHexColor(...o),f.#g=d||1,h&&(f.#m=t.thickness),f._initialData=s,t.comment&&f.setCommentData(t.comment);const[g,_]=f.pageDimensions,[y,b]=f.pageTranslation;if(c){const A=f.#n=[];for(let S=0;S<c.length;S+=8)A.push({x:(c[S]-y)/g,y:1-(c[S+1]-b)/_,width:(c[S+2]-c[S])/g,height:(c[S+1]-c[S+5])/_});f.#_(),f.#T(),f.rotate(f.rotation)}else if(h){f.#u=!0;const A=h[0],S={x:A[0]-y,y:_-(A[1]-b)},w=new ff(S,[0,0,g,_],1,f.#m/2,!0,.001);for(let x=0,I=A.length;x<I;x+=2)S.x=A[x]-y,S.y=_-(A[x+1]-b),w.add(S);const{id:C,clipPathId:D}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:w.toSVGPath()}},!0,!0);f.#A({highlightOutlines:w.getOutlines(),highlightId:C,clipPathId:D}),f.#T(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),n=dt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s={annotationType:vt.HIGHLIGHT,color:n,opacity:this.#g,thickness:this.#m,quadPoints:this.#I(),outlines:this.#k(e),pageIndex:this.pageIndex,rect:e,rotation:this.#D(),structTreeParentId:this._structTreeParentId};return this.addComment(s),this.annotationElementId&&!this.#N(s)?null:(s.id=this.annotationElementId,s)}#N(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((n,s)=>n!==e[s])}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}static canCreateNewEmptyEditor(){return!1}}class Vv{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Vt("Not implemented")}}class mt extends dt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#a=null;static#s=NaN;static#r=null;static#o=null;static#l=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#c(t),this.#f())}#c({drawOutlines:t,drawId:e,drawingOptions:n}){this.#t=t,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#d(t,this.parent),this.#h(t.box)}#d(t,e){const{id:n}=e.drawLayer.draw(mt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(t,e){const n=new Set(Object.keys(t));for(const[s,o]of Object.entries(e))n.has(s)?Object.assign(t[s],o):t[s]=o;return t}static getDefaultDrawingOptions(t){Vt("Not implemented")}static get typesMap(){Vt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const n=this.typesMap.get(t);n&&this._defaultDrawingOptions.updateProperty(n,e),this._currentParent&&(mt.#n.updateProperty(n,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const n=this.constructor.typesMap.get(t);n&&this._updateProperty(t,n,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)t.push([n,e[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[n,s]of this.constructor.typesMap)t.push([n,e[s]]);return t}_updateProperty(t,e,n){const s=this._drawingOptions,o=s[e],c=h=>{s.updateProperty(e,h);const d=this.#t.updateProperty(e,h);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this._colorPicker?.update(h)};this.addCommands({cmd:c.bind(this,n),undo:c.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,mt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,mt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,mt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#f(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#t,t)}}#g([t,e,n,s]){const{parentDimensions:[o,c],rotation:h}=this;switch(h){case 90:return[e,1-t,n*(c/o),s*(o/c)];case 180:return[1-t,1-e,n,s];case 270:return[1-e,t,n*(c/o),s*(o/c)];default:return[t,e,n,s]}}#p(){const{x:t,y:e,width:n,height:s,parentDimensions:[o,c],rotation:h}=this;switch(h){case 90:return[1-e,t,n*(o/c),s*(c/o)];case 180:return[1-t,1-e,n,s];case 270:return[e,1-t,n*(o/c),s*(c/o)];default:return[t,e,n,s]}}#h(t){if([this.x,this.y,this.width,this.height]=this.#g(t),this.div){this.fixAndSetPosition();const[e,n]=this.parentDimensions;this.setDims(this.width*e,this.height*n)}this._onResized()}#m(){const{x:t,y:e,width:n,height:s,rotation:o,parentRotation:c,parentDimensions:[h,d]}=this;switch((o*4+c)/90){case 1:return[1-e-s,t,s,n];case 2:return[1-t-n,1-e-s,n,s];case 3:return[e,1-t-n,s,n];case 4:return[t,e-n*(h/d),s*(d/h),n*(h/d)];case 5:return[1-e,t,n*(h/d),s*(d/h)];case 6:return[1-t-s*(d/h),1-e,s*(d/h),n*(h/d)];case 7:return[e-n*(h/d),1-t-s*(d/h),n*(h/d),s*(d/h)];case 8:return[t-n,e-s,n,s];case 9:return[1-e,t-n,s,n];case 10:return[1-t,1-e,n,s];case 11:return[e-s,1-t,s,n];case 12:return[t-s*(d/h),e,s*(d/h),n*(h/d)];case 13:return[1-e-n*(h/d),t-s*(d/h),n*(h/d),s*(d/h)];case 14:return[1-t,1-e-n*(h/d),s*(d/h),n*(h/d)];case 15:return[e,1-t,n*(h/d),s*(d/h)];default:return[t,e,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,mt._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal";const[o,c]=this.parentDimensions;return this.setDims(this.width*o,this.height*c),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),n}static createDrawerInstance(t,e,n,s,o){Vt("Not implemented")}static startDrawing(t,e,n,s){const{target:o,offsetX:c,offsetY:h,pointerId:d,pointerType:f}=s;if(mt.#r&&mt.#r!==f)return;const{viewport:{rotation:g}}=t,{width:_,height:y}=o.getBoundingClientRect(),b=mt.#i=new AbortController,A=t.combinedSignal(b);if(mt.#s||=d,mt.#r??=f,window.addEventListener("pointerup",S=>{mt.#s===S.pointerId?this._endDraw(S):mt.#o?.delete(S.pointerId)},{signal:A}),window.addEventListener("pointercancel",S=>{mt.#s===S.pointerId?this._currentParent.endDrawingSession():mt.#o?.delete(S.pointerId)},{signal:A}),window.addEventListener("pointerdown",S=>{mt.#r===S.pointerType&&((mt.#o||=new Set).add(S.pointerId),mt.#n.isCancellable()&&(mt.#n.removeLastElement(),mt.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Rn,{signal:A}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),o.addEventListener("touchmove",S=>{S.timeStamp===mt.#l&&ge(S)},{signal:A}),t.toggleDrawing(),e._editorUndoBar?.hide(),mt.#n){t.drawLayer.updateProperties(this._currentDrawId,mt.#n.startNew(c,h,_,y,g));return}e.updateUIForDefaultProperties(this),mt.#n=this.createDrawerInstance(c,h,_,y,g),mt.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(mt.#a.toSVGProperties(),mt.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(mt.#l=-1,!mt.#n)return;const{offsetX:e,offsetY:n,pointerId:s}=t;if(mt.#s===s){if(mt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,mt.#n.add(e,n)),mt.#l=t.timeStamp,ge(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,mt.#n=null,mt.#a=null,mt.#r=null,mt.#l=NaN),mt.#i&&(mt.#i.abort(),mt.#i=null,mt.#s=NaN,mt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,mt.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const n=mt.#n,s=this._currentDrawId,o=n.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(s,n.setLastElement(o))},undo:()=>{e.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:kt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(kt.DRAW_STEP),!mt.#n.isEmpty()){const{pageDimensions:[n,s],scale:o}=e,c=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:mt.#n.getOutlines(n*o,s*o,o,this._INNER_MARGIN),drawingOptions:mt.#a,mustBeCommitted:!t});return this._cleanup(!0),c}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,n,s,o,c){Vt("Not implemented")}static async deserialize(t,e,n){const{rawDims:{pageWidth:s,pageHeight:o,pageX:c,pageY:h}}=e.viewport,d=this.deserializeDraw(c,h,s,o,this._INNER_MARGIN,t),f=await super.deserialize(t,e,n);return f.createDrawingOptions(t),f.#c({drawOutlines:d}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,n]=this.pageTranslation,[s,o]=this.pageDimensions;return this.#t.serialize([e,n,s,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class zw{#t=new Float64Array(6);#e;#n;#i;#a;#s;#r="";#o=0;#l=new qo;#c;#d;constructor(t,e,n,s,o,c){this.#c=n,this.#d=s,this.#i=o,this.#a=c,[t,e]=this.#u(t,e);const h=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e],this.#n=[{line:h,points:this.#s}],this.#t.set(h,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#u(t,e){return ot._normalizePoint(t,e,this.#c,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#s.length<=10}add(t,e){[t,e]=this.#u(t,e);const[n,s,o,c]=this.#t.subarray(2,6),h=t-o,d=e-c;return Math.hypot(this.#c*h,this.#d*d)<=2?null:(this.#s.push(t,e),isNaN(n)?(this.#t.set([o,c,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([n,s,o,c,t,e],0),this.#e.push(...ot.createBezierPoints(n,s,o,c,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,s,o){this.#c=n,this.#d=s,this.#i=o,[t,e]=this.#u(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#s=[t,e];const h=this.#n.at(-1);return h&&(h.line=new Float32Array(h.line),h.points=new Float32Array(h.points)),this.#n.push({line:c,points:this.#s}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#s=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#l.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#l.removeLastElement();this.#n.pop(),this.#r="";for(let t=0,e=this.#n.length;t<e;t++){const{line:n,points:s}=this.#n[t];this.#e=n,this.#s=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const t=ot.svgRound(this.#e[4]),e=ot.svgRound(this.#e[5]);if(this.#s.length===2)return this.#r=`${this.#r} M ${t} ${e} Z`,this.#r;if(this.#s.length<=6){const s=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,s)} M ${t} ${e}`,this.#o=6}if(this.#s.length===4){const s=ot.svgRound(this.#e[10]),o=ot.svgRound(this.#e[11]);return this.#r=`${this.#r} L ${s} ${o}`,this.#o=12,this.#r}const n=[];this.#o===0&&(n.push(`M ${t} ${e}`),this.#o=6);for(let s=this.#o,o=this.#e.length;s<o;s+=6){const[c,h,d,f,g,_]=this.#e.slice(s,s+6).map(ot.svgRound);n.push(`C${c} ${h} ${d} ${f} ${g} ${_}`)}return this.#r+=n.join(" "),this.#o=this.#e.length,this.#r}getOutlines(t,e,n,s){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#l.build(this.#n,t,e,n,this.#i,this.#a,s),this.#t=null,this.#e=null,this.#n=null,this.#r=null,this.#l}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class qo extends ot{#t;#e=0;#n;#i;#a;#s;#r;#o;#l;build(t,e,n,s,o,c,h){this.#a=e,this.#s=n,this.#r=s,this.#o=o,this.#l=c,this.#n=h??0,this.#i=t,this.#u()}get thickness(){return this.#l}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${ot.svgRound(e[4])} ${ot.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${ot.svgRound(e[10])} ${ot.svgRound(e[11])}`);continue}for(let n=6,s=e.length;n<s;n+=6){const[o,c,h,d,f,g]=e.subarray(n,n+6).map(ot.svgRound);t.push(`C${o} ${c} ${h} ${d} ${f} ${g}`)}}return t.join("")}serialize([t,e,n,s],o){const c=[],h=[],[d,f,g,_]=this.#d();let y,b,A,S,w,C,D,x,I;switch(this.#o){case 0:I=ot._rescale,y=t,b=e+s,A=n,S=-s,w=t+d*n,C=e+(1-f-_)*s,D=t+(d+g)*n,x=e+(1-f)*s;break;case 90:I=ot._rescaleAndSwap,y=t,b=e,A=n,S=s,w=t+f*n,C=e+d*s,D=t+(f+_)*n,x=e+(d+g)*s;break;case 180:I=ot._rescale,y=t+n,b=e,A=-n,S=s,w=t+(1-d-g)*n,C=e+f*s,D=t+(1-d)*n,x=e+(f+_)*s;break;case 270:I=ot._rescaleAndSwap,y=t+n,b=e+s,A=-n,S=-s,w=t+(1-f-_)*n,C=e+(1-d-g)*s,D=t+(1-f)*n,x=e+(1-d)*s;break}for(const{line:O,points:P}of this.#i)c.push(I(O,y,b,A,S,o?new Array(O.length):null)),h.push(I(P,y,b,A,S,o?new Array(P.length):null));return{lines:c,points:h,rect:[w,C,D,x]}}static deserialize(t,e,n,s,o,{paths:{lines:c,points:h},rotation:d,thickness:f}){const g=[];let _,y,b,A,S;switch(d){case 0:S=ot._rescale,_=-t/n,y=e/s+1,b=1/n,A=-1/s;break;case 90:S=ot._rescaleAndSwap,_=-e/s,y=-t/n,b=1/s,A=1/n;break;case 180:S=ot._rescale,_=t/n+1,y=-e/s,b=-1/n,A=1/s;break;case 270:S=ot._rescaleAndSwap,_=e/s+1,y=t/n+1,b=-1/s,A=-1/n;break}if(!c){c=[];for(const C of h){const D=C.length;if(D===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1]]));continue}if(D===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,C[0],C[1],NaN,NaN,NaN,NaN,C[2],C[3]]));continue}const x=new Float32Array(3*(D-2));c.push(x);let[I,O,P,G]=C.subarray(0,4);x.set([NaN,NaN,NaN,NaN,I,O],0);for(let Y=4;Y<D;Y+=2){const j=C[Y],at=C[Y+1];x.set(ot.createBezierPoints(I,O,P,G,j,at),(Y-2)*3),[I,O,P,G]=[P,G,j,at]}}}for(let C=0,D=c.length;C<D;C++)g.push({line:S(c[C].map(x=>x??NaN),_,y,b,A),points:S(h[C].map(x=>x??NaN),_,y,b,A)});const w=new this.prototype.constructor;return w.build(g,n,s,1,d,f,o),w}#c(t=this.#l){const e=this.#n+t/2*this.#r;return this.#o%180===0?[e/this.#a,e/this.#s]:[e/this.#s,e/this.#a]}#d(){const[t,e,n,s]=this.#t,[o,c]=this.#c(0);return[t+o,e+c,n-2*o,s-2*c]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#i){if(s.length<=12){for(let h=4,d=s.length;h<d;h+=6)ct.pointBoundingBox(s[h],s[h+1],t);continue}let o=s[4],c=s[5];for(let h=6,d=s.length;h<d;h+=6){const[f,g,_,y,b,A]=s.subarray(h,h+6);ct.bezierBoundingBox(o,c,f,g,_,y,b,A,t),o=b,c=A}}const[e,n]=this.#c();t[0]=Ge(t[0]-e,0,1),t[1]=Ge(t[1]-n,0,1),t[2]=Ge(t[2]+e,0,1),t[3]=Ge(t[3]+n,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,n]=this.#c();this.#l=t;const[s,o]=this.#c(),[c,h]=[s-e,o-n],d=this.#t;return d[0]-=c,d[1]-=h,d[2]+=2*c,d[3]+=2*h,d}updateParentDimensions([t,e],n){const[s,o]=this.#c();this.#a=t,this.#s=e,this.#r=n;const[c,h]=this.#c(),d=c-s,f=h-o,g=this.#t;return g[0]-=d,g[1]-=f,g[2]+=2*d,g[3]+=2*f,g}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(ot.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ot.svgRound(t)} ${ot.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let n=0,s=0,o=0,c=0,h=0,d=0;switch(this.#e){case 90:s=e/t,o=-t/e,h=t;break;case 180:n=-1,c=-1,h=t,d=e;break;case 270:s=-e/t,o=t/e,d=e;break;default:return""}return`matrix(${n} ${s} ${o} ${c} ${ot.svgRound(h)} ${ot.svgRound(d)})`}getPathResizingSVGProperties([t,e,n,s]){const[o,c]=this.#c(),[h,d,f,g]=this.#t;if(Math.abs(f-o)<=ot.PRECISION||Math.abs(g-c)<=ot.PRECISION){const S=t+n/2-(h+f/2),w=e+s/2-(d+g/2);return{path:{"transform-origin":`${ot.svgRound(t)} ${ot.svgRound(e)}`,transform:`${this.rotationTransform} translate(${S} ${w})`}}}const _=(n-2*o)/(f-2*o),y=(s-2*c)/(g-2*c),b=f/n,A=g/s;return{path:{"transform-origin":`${ot.svgRound(h)} ${ot.svgRound(d)}`,transform:`${this.rotationTransform} scale(${b} ${A}) translate(${ot.svgRound(o)} ${ot.svgRound(c)}) scale(${_} ${y}) translate(${ot.svgRound(-o)} ${ot.svgRound(-c)})`}}}getPathResizedSVGProperties([t,e,n,s]){const[o,c]=this.#c(),h=this.#t,[d,f,g,_]=h;if(h[0]=t,h[1]=e,h[2]=n,h[3]=s,Math.abs(g-o)<=ot.PRECISION||Math.abs(_-c)<=ot.PRECISION){const w=t+n/2-(d+g/2),C=e+s/2-(f+_/2);for(const{line:D,points:x}of this.#i)ot._translate(D,w,C,D),ot._translate(x,w,C,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ot.svgRound(t)} ${ot.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(n-2*o)/(g-2*o),b=(s-2*c)/(_-2*c),A=-y*(d+o)+t+o,S=-b*(f+c)+e+c;if(y!==1||b!==1||A!==0||S!==0)for(const{line:w,points:C}of this.#i)ot._rescale(w,A,S,y,b,w),ot._rescale(C,A,S,y,b,C);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ot.svgRound(t)} ${ot.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],n){const[s,o]=n,c=this.#t,h=t-c[0],d=e-c[1];if(this.#a===s&&this.#s===o)for(const{line:f,points:g}of this.#i)ot._translate(f,h,d,f),ot._translate(g,h,d,g);else{const f=this.#a/s,g=this.#s/o;this.#a=s,this.#s=o;for(const{line:_,points:y}of this.#i)ot._rescale(_,h,d,f,g,_),ot._rescale(y,h,d,f,g,y);c[2]*=f,c[3]*=g}return c[0]=t,c[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ot.svgRound(t)} ${ot.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ot.svgRound(t[0])} ${ot.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class iu extends Vv{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:dt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new iu(this._viewParameters);return t.updateAll(this),t}}class ep extends mt{static _type="ink";static _editorType=vt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){dt.initialize(t,e),this._defaultDrawingOptions=new iu(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return Rt(this,"typesMap",new Map([[kt.INK_THICKNESS,"stroke-width"],[kt.INK_COLOR,"stroke"],[kt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,n,s,o){return new zw(t,e,n,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,n,s,o,c){return qo.deserialize(t,e,n,s,o,c)}static async deserialize(t,e,n){let s=null;if(t instanceof Jf){const{data:{inkLists:c,rect:h,rotation:d,id:f,color:g,opacity:_,borderStyle:{rawWidth:y},popupRef:b,contentsObj:A},parent:{page:{pageNumber:S}}}=t;s=t={annotationType:vt.INK,color:Array.from(g),thickness:y,opacity:_,paths:{points:c},boxes:null,pageIndex:S-1,rect:h.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:b,comment:A?.str||null}}const o=await super.deserialize(t,e,n);return o._initialData=s,t.comment&&o.setCommentData(t.comment),o}get toolbarButtons(){return this._colorPicker||=new Ro(this),[["colorPicker",this._colorPicker]]}get colorType(){return kt.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:n}=this;e.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:n}){this._drawingOptions=ep.getDefaultDrawingOptions({stroke:ct.makeHexColor(...t),"stroke-width":e,"stroke-opacity":n})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:n,rect:s}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":c,"stroke-width":h}}=this,d={annotationType:vt.INK,color:dt._colorManager.convert(o),opacity:c,thickness:h,paths:{lines:e,points:n},pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(d),t?(d.isCopy=!0,d):this.annotationElementId&&!this.#t(d)?null:(d.id=this.annotationElementId,d)}#t(t){const{color:e,thickness:n,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,h)=>c!==e[h])||t.thickness!==n||t.opacity!==s||t.pageIndex!==o}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:n}=this.serializeDraw(!1),s={rect:n,thickness:this._drawingOptions["stroke-width"],points:e};return this.hasEditedComment&&(s.popup=this.comment),t.updateEdited(s),null}}class pf extends qo{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const yc=8,co=3;class Ia{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,n,s){return n-=t,s-=e,n===0?s>0?0:4:n===1?s+6:2-s}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,n,s,o,c,h){const d=this.#e(n,s,o,c);for(let f=0;f<8;f++){const g=(-f+d-h+16)%8,_=this.#n[2*g],y=this.#n[2*g+1];if(t[(n+_)*e+(s+y)]!==0)return g}return-1}static#a(t,e,n,s,o,c,h){const d=this.#e(n,s,o,c);for(let f=0;f<8;f++){const g=(f+d+h+16)%8,_=this.#n[2*g],y=this.#n[2*g+1];if(t[(n+_)*e+(s+y)]!==0)return g}return-1}static#s(t,e,n,s){const o=t.length,c=new Int32Array(o);for(let g=0;g<o;g++)c[g]=t[g]<=s?1:0;for(let g=1;g<n-1;g++)c[g*e]=c[g*e+e-1]=0;for(let g=0;g<e;g++)c[g]=c[e*n-1-g]=0;let h=1,d;const f=[];for(let g=1;g<n-1;g++){d=1;for(let _=1;_<e-1;_++){const y=g*e+_,b=c[y];if(b===0)continue;let A=g,S=_;if(b===1&&c[y-1]===0)h+=1,S-=1;else if(b>=1&&c[y+1]===0)h+=1,S+=1,b>1&&(d=b);else{b!==1&&(d=Math.abs(b));continue}const w=[_,g],C=S===_+1,D={isHole:C,points:w,id:h,parent:0};f.push(D);let x;for(const nt of f)if(nt.id===d){x=nt;break}x?x.isHole?D.parent=C?x.parent:d:D.parent=C?d:x.parent:D.parent=C?d:0;const I=this.#i(c,e,g,_,A,S,0);if(I===-1){c[y]=-h,c[y]!==1&&(d=Math.abs(c[y]));continue}let O=this.#n[2*I],P=this.#n[2*I+1];const G=g+O,Y=_+P;A=G,S=Y;let j=g,at=_;for(;;){const nt=this.#a(c,e,j,at,A,S,1);O=this.#n[2*nt],P=this.#n[2*nt+1];const pt=j+O,et=at+P;w.push(et,pt);const Et=j*e+at;if(c[Et+1]===0?c[Et]=-h:c[Et]===1&&(c[Et]=h),pt===g&&et===_&&j===G&&at===Y){c[y]!==1&&(d=Math.abs(c[y]));break}else A=j,S=at,j=pt,at=et}}}return f}static#r(t,e,n,s){if(n-e<=4){for(let G=e;G<n-2;G+=2)s.push(t[G],t[G+1]);return}const o=t[e],c=t[e+1],h=t[n-4]-o,d=t[n-3]-c,f=Math.hypot(h,d),g=h/f,_=d/f,y=g*c-_*o,b=d/h,A=1/f,S=Math.atan(b),w=Math.cos(S),C=Math.sin(S),D=A*(Math.abs(w)+Math.abs(C)),x=A*(1-D+D**2),I=Math.max(Math.atan(Math.abs(C+w)*x),Math.atan(Math.abs(C-w)*x));let O=0,P=e;for(let G=e+2;G<n-2;G+=2){const Y=Math.abs(y-g*t[G+1]+_*t[G]);Y>O&&(P=G,O=Y)}O>(f*I)**2?(this.#r(t,e,P+2,s),this.#r(t,P,n,s)):s.push(o,c)}static#o(t){const e=[],n=t.length;return this.#r(t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e}static#l(t,e,n,s,o,c){const h=new Float32Array(c**2),d=-2*s**2,f=c>>1;for(let S=0;S<c;S++){const w=(S-f)**2;for(let C=0;C<c;C++)h[S*c+C]=Math.exp((w+(C-f)**2)/d)}const g=new Float32Array(256),_=-2*o**2;for(let S=0;S<256;S++)g[S]=Math.exp(S**2/_);const y=t.length,b=new Uint8Array(y),A=new Uint32Array(256);for(let S=0;S<n;S++)for(let w=0;w<e;w++){const C=S*e+w,D=t[C];let x=0,I=0;for(let P=0;P<c;P++){const G=S+P-f;if(!(G<0||G>=n))for(let Y=0;Y<c;Y++){const j=w+Y-f;if(j<0||j>=e)continue;const at=t[G*e+j],nt=h[P*c+Y]*g[Math.abs(at-D)];x+=at*nt,I+=nt}}const O=b[C]=Math.round(x/I);A[O]++}return[b,A]}static#c(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e}static#d(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let s=-1/0,o=1/0;for(let h=0,d=n.length;h<d;h++){const f=n[h]=t[h<<2];s=Math.max(s,f),o=Math.min(o,f)}const c=255/(s-o);for(let h=0,d=n.length;h<d;h++)n[h]=(n[h]-o)*c;return n}static#u(t){let e,n=-1/0,s=-1/0;const o=t.findIndex(d=>d!==0);let c=o,h=o;for(e=o;e<256;e++){const d=t[e];d>n&&(e-c>s&&(s=e-c,h=e-1),n=d,c=e)}for(e=h-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:n,height:s}=t,{maxDim:o}=this.#t;let c=n,h=s;if(n>o||s>o){let y=n,b=s,A=Math.log2(Math.max(n,s)/o);const S=Math.floor(A);A=A===S?S-1:S;for(let C=0;C<A;C++){c=Math.ceil(y/2),h=Math.ceil(b/2);const D=new OffscreenCanvas(c,h);D.getContext("2d").drawImage(t,0,0,y,b,0,0,c,h),y=c,b=h,t!==e&&t.close(),t=D.transferToImageBitmap()}const w=Math.min(o/c,o/h);c=Math.round(c*w),h=Math.round(h*w)}const f=new OffscreenCanvas(c,h).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,h),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,h);const g=f.getImageData(0,0,c,h).data;return[this.#d(g),c,h]}static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:s},o,c,h,d){let f=new OffscreenCanvas(1,1),g=f.getContext("2d",{alpha:!1});const _=200,y=g.font=`${n} ${s} ${_}px ${e}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:A,actualBoundingBoxAscent:S,actualBoundingBoxDescent:w,fontBoundingBoxAscent:C,fontBoundingBoxDescent:D,width:x}=g.measureText(t),I=1.5,O=Math.ceil(Math.max(Math.abs(b)+Math.abs(A)||0,x)*I),P=Math.ceil(Math.max(Math.abs(S)+Math.abs(w)||_,Math.abs(C)+Math.abs(D)||_)*I);f=new OffscreenCanvas(O,P),g=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),g.font=y,g.filter="grayscale(1)",g.fillStyle="white",g.fillRect(0,0,O,P),g.fillStyle="black",g.fillText(t,O*(I-1)/2,P*(3-I)/2);const G=this.#d(g.getImageData(0,0,O,P).data),Y=this.#c(G),j=this.#u(Y),at=this.#s(G,O,P,j);return this.processDrawnLines({lines:{curves:at,width:O,height:P},pageWidth:o,pageHeight:c,rotation:h,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,n,s,o){const[c,h,d]=this.#f(t),[f,g]=this.#l(c,h,d,Math.hypot(h,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),_=this.#u(g),y=this.#s(f,h,d,_);return this.processDrawnLines({lines:{curves:y,width:h,height:d},pageWidth:e,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:c,areContours:h}){s%180!==0&&([e,n]=[n,e]);const{curves:d,width:f,height:g}=t,_=t.thickness??0,y=[],b=Math.min(e/f,n/g),A=b/e,S=b/n,w=[];for(const{points:D}of d){const x=c?this.#o(D):D;if(!x)continue;w.push(x);const I=x.length,O=new Float32Array(I),P=new Float32Array(3*(I===2?2:I-2));if(y.push({line:P,points:O}),I===2){O[0]=x[0]*A,O[1]=x[1]*S,P.set([NaN,NaN,NaN,NaN,O[0],O[1]],0);continue}let[G,Y,j,at]=x;G*=A,Y*=S,j*=A,at*=S,O.set([G,Y,j,at],0),P.set([NaN,NaN,NaN,NaN,G,Y],0);for(let nt=4;nt<I;nt+=2){const pt=O[nt]=x[nt]*A,et=O[nt+1]=x[nt+1]*S;P.set(ot.createBezierPoints(G,Y,j,at,pt,et),(nt-2)*3),[G,Y,j,at]=[j,at,pt,et]}}if(y.length===0)return null;const C=h?new pf:new qo;return C.build(y,e,n,1,s,h?0:_,o),{outline:C,newCurves:w,areContours:h,thickness:_,width:f,height:g}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:s,height:o}){let c=1/0,h=-1/0,d=0;for(const x of t){d+=x.length;for(let I=2,O=x.length;I<O;I++){const P=x[I]-x[I-2];c=Math.min(c,P),h=Math.max(h,P)}}let f;c>=-128&&h<=127?f=Int8Array:c>=-32768&&h<=32767?f=Int16Array:f=Int32Array;const g=t.length,_=yc+co*g,y=new Uint32Array(_);let b=0;y[b++]=_*Uint32Array.BYTES_PER_ELEMENT+(d-2*g)*f.BYTES_PER_ELEMENT,y[b++]=0,y[b++]=s,y[b++]=o,y[b++]=e?0:1,y[b++]=Math.max(0,Math.floor(n??0)),y[b++]=g,y[b++]=f.BYTES_PER_ELEMENT;for(const x of t)y[b++]=x.length-2,y[b++]=x[0],y[b++]=x[1];const A=new CompressionStream("deflate-raw"),S=A.writable.getWriter();await S.ready,S.write(y);const w=f.prototype.constructor;for(const x of t){const I=new w(x.length-2);for(let O=2,P=x.length;O<P;O++)I[O-2]=x[O]-x[O-2];S.write(I)}S.close();const C=await new Response(A.readable).arrayBuffer(),D=new Uint8Array(C);return yv(D)}static async decompressSignature(t){try{const e=l1(t),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),o=s.getWriter();await o.ready,o.write(e).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let c=null,h=0;for await(const x of n)c||=new Uint8Array(new Uint32Array(x.buffer,0,4)[0]),c.set(x,h),h+=x.length;const d=new Uint32Array(c.buffer,0,c.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const g=d[2],_=d[3],y=d[4]===0,b=d[5],A=d[6],S=d[7],w=[],C=(yc+co*A)*Uint32Array.BYTES_PER_ELEMENT;let D;switch(S){case Int8Array.BYTES_PER_ELEMENT:D=new Int8Array(c.buffer,C);break;case Int16Array.BYTES_PER_ELEMENT:D=new Int16Array(c.buffer,C);break;case Int32Array.BYTES_PER_ELEMENT:D=new Int32Array(c.buffer,C);break}h=0;for(let x=0;x<A;x++){const I=d[co*x+yc],O=new Float32Array(I+2);w.push(O);for(let P=0;P<co-1;P++)O[P]=d[co*x+yc+P+1];for(let P=0;P<I;P++)O[P+2]=O[P]+D[h++]}return{areContours:y,thickness:b,outlines:w,width:g,height:_}}catch(e){return At(`decompressSignature: ${e}`),null}}}class np extends Vv{constructor(){super(),super.updateProperties({fill:dt._defaultLineColor,"stroke-width":0})}clone(){const t=new np;return t.updateAll(this),t}}class ip extends iu{constructor(t){super(t),super.updateProperties({stroke:dt._defaultLineColor,"stroke-width":1})}clone(){const t=new ip(this._viewParameters);return t.updateAll(this),t}}class Kn extends mt{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=vt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){dt.initialize(t,e),this._defaultDrawingOptions=new np,this._defaultDrawnSignatureOptions=new ip(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return Rt(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:s,mustSmooth:o,areContours:c,description:h,uuid:d,heightInPage:f}=this.#n,{rawDims:{pageWidth:g,pageHeight:_},rotation:y}=this.parent.viewport,b=Ia.processDrawnLines({lines:s,pageWidth:g,pageHeight:_,rotation:y,innerMargin:Kn._INNER_MARGIN,mustSmooth:o,areContours:c});this.addSignature(b,f,h,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:n,width:s,height:o}=this.#n,c=Math.max(s,o),h=Ia.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:n,width:s,height:o},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:h.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,n,s){const{x:o,y:c}=this,{outline:h}=this.#n=t;this.#t=h instanceof pf,this.description=n;let d;this.#t?d=Kn.getDefaultDrawingOptions():(d=Kn._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":h.thickness})),this._addOutlines({drawOutlines:h,drawingOptions:d});const[f,g]=this.parentDimensions,[,_]=this.pageDimensions;let y=e/_;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(f*this.width,g*this.height),this.x=o,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:s}=this.parent.viewport;return Ia.process(t,e,n,s,Kn._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return Ia.extractContoursFromText(t,e,n,s,o,Kn._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:n},rotation:s}=this.parent.viewport;return Ia.processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:s,innerMargin:Kn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Kn.getDefaultDrawingOptions():(this._drawingOptions=Kn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:n,rect:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":o}}=this,c={annotationType:vt.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:o,pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(c),t?(c.paths={lines:e,points:n},c.uuid=this.#i,c.isCopy=!0):c.lines=e,this.#e&&(c.accessibilityData={type:"Figure",alt:this.#e}),c}static deserializeDraw(t,e,n,s,o,c){return c.areContours?pf.deserialize(t,e,n,s,o,c):qo.deserialize(t,e,n,s,o,c)}static async deserialize(t,e,n){const s=await super.deserialize(t,e,n);return s.#t=t.areContours,s.description=t.accessibilityData?.alt||"",s.#i=t.uuid,s}}class Uw extends dt{#t=null;#e=null;#n=null;#i=null;#a=null;#s="";#r=null;#o=!1;#l=null;#c=!1;#d=!1;static _type="stamp";static _editorType=vt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){dt.initialize(t,e)}static isHandlingMimeForPasting(t){return of.includes(t)}static paste(t,e){e.pasteEditor({mode:vt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#c=t.isSvg),t.file&&(this.#s=t.file.name),this.#p()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:c}=t||this.copyCanvas(null,null,!0).imageData,h=await n.guess({name:"altText",request:{data:s,width:o,height:c,channels:s.length/(o*c)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const d=h.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(n=>this.#u(n,!0)).finally(()=>this.#f());return}if(this.#i){const n=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#u(s)).finally(()=>this.#f());return}if(this.#a){const n=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(s=>this.#u(s)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=of.join(",");const e=this._uiManager._signal;this.#n=new Promise(n=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(s)}n()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),n()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#l&&(clearTimeout(this.#l),this.#l=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#e=n,s&&(this.#t=s),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#l!==null&&clearTimeout(this.#l);const t=200;this.#l=setTimeout(()=>{this.#l=null,this.#m()},t)}#p(){const{div:t}=this;let{width:e,height:n}=this.#t;const[s,o]=this.pageDimensions,c=.75;if(this.width)e=this.width*s,n=this.height*o;else if(e>c*s||n>c*o){const g=Math.min(c*s/e,c*o/n);e*=g,n*=g}const[h,d]=this.parentDimensions;this.setDims(e*h/s,n*d/o),this._uiManager.enableWaiting(!1);const f=this.#r=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/s,this.height=n/o,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,n=!1){t||(t=224);const{width:s,height:o}=this.#t,c=new ti;let h=this.#t,d=s,f=o,g=null;if(e){if(s>e||o>e){const P=Math.min(e/s,e/o);d=Math.floor(s*P),f=Math.floor(o*P)}g=document.createElement("canvas");const y=g.width=Math.ceil(d*c.sx),b=g.height=Math.ceil(f*c.sy);this.#c||(h=this.#h(y,b));const A=g.getContext("2d");A.filter=this._uiManager.hcmFilter;let S="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(S="#8f8f9d",w="#42414d");const C=15,D=C*c.sx,x=C*c.sy,I=new OffscreenCanvas(D*2,x*2),O=I.getContext("2d");O.fillStyle=S,O.fillRect(0,0,D*2,x*2),O.fillStyle=w,O.fillRect(0,0,D,x),O.fillRect(D,x,D,x),A.fillStyle=A.createPattern(I,"repeat"),A.fillRect(0,0,y,b),A.drawImage(h,0,0,h.width,h.height,0,0,y,b)}let _=null;if(n){let y,b;if(c.symmetric&&h.width<t&&h.height<t)y=h.width,b=h.height;else if(h=this.#t,s>t||o>t){const w=Math.min(t/s,t/o);y=Math.floor(s*w),b=Math.floor(o*w),this.#c||(h=this.#h(y,b))}const S=new OffscreenCanvas(y,b).getContext("2d",{willReadFrequently:!0});S.drawImage(h,0,0,h.width,h.height,0,0,y,b),_={width:y,height:b,data:S.getImageData(0,0,y,b).data}}return{canvas:g,width:d,height:f,imageData:_}}#h(t,e){const{width:n,height:s}=this.#t;let o=n,c=s,h=this.#t;for(;o>2*t||c>2*e;){const d=o,f=c;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),c>2*e&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const g=new OffscreenCanvas(o,c);g.getContext("2d").drawImage(h,0,0,d,f,0,0,o,c),h=g.transferToImageBitmap()}return h}#m(){const[t,e]=this.parentDimensions,{width:n,height:s}=this,o=new ti,c=Math.ceil(n*t*o.sx),h=Math.ceil(s*e*o.sy),d=this.#r;if(!d||d.width===c&&d.height===h)return;d.width=c,d.height=h;const f=this.#c?this.#t:this.#h(c,h),g=d.getContext("2d");g.filter=this._uiManager.hcmFilter,g.drawImage(f,0,0,f.width,f.height,0,0,c,h)}#b(t){if(t){if(this.#c){const s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#c){const[e,n]=this.pageDimensions,s=Math.round(this.width*e*Xa.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*Xa.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(s,o);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,o),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,n){let s=null,o=!1;if(t instanceof Gv){const{data:{rect:S,rotation:w,id:C,structParent:D,popupRef:x,contentsObj:I},container:O,parent:{page:{pageNumber:P}},canvas:G}=t;let Y,j;G?(delete t.canvas,{id:Y,bitmap:j}=n.imageManager.getFromCanvas(O.id,G),G.remove()):(o=!0,t._hasNoCanvas=!0);const at=(await e._structTree.getAriaAttributes(`${jf}${C}`))?.get("aria-label")||"";s=t={annotationType:vt.STAMP,bitmapId:Y,bitmap:j,pageIndex:P-1,rect:S.slice(0),rotation:w,annotationElementId:C,id:C,deleted:!1,accessibilityData:{decorative:!1,altText:at},isSvg:!1,structParent:D,popupRef:x,comment:I?.str||null}}const c=await super.deserialize(t,e,n),{rect:h,bitmap:d,bitmapUrl:f,bitmapId:g,isSvg:_,accessibilityData:y}=t;o?(n.addMissingCanvas(t.id,c),c.#o=!0):g&&n.imageManager.isValidId(g)?(c.#e=g,d&&(c.#t=d)):c.#i=f,c.#c=_;const[b,A]=c.pageDimensions;return c.width=(h[2]-h[0])/b,c.height=(h[3]-h[1])/A,y&&(c.altTextData=y),c._initialData=s,t.comment&&c.setCommentData(t.comment),c.#d=!!s,c}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n={annotationType:vt.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(this.addComment(n),t)return n.bitmapUrl=this.#b(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const h=this.#_(n);if(h.isSame)return null;h.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1}if(n.id=this.annotationElementId,e===null)return n;e.stamps||=new Map;const c=this.#c?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:c,serialized:n}),n.bitmap=this.#b(!1);else if(this.#c){const h=e.stamps.get(this.#e);c>h.area&&(h.area=c,h.serialized.bitmap.close(),h.serialized.bitmap=this.#b(!1))}return n}#_(t){const{pageIndex:e,accessibilityData:{altText:n}}=this._initialData,s=t.pageIndex===e,o=(t.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}}class yi{#t;#e=!1;#n=null;#i=null;#a=null;#s=new Map;#r=!1;#o=!1;#l=!1;#c=null;#d=null;#u=null;#f=null;#g=null;#p=-1;#h;static _initialized=!1;static#m=new Map([Ee,ep,Uw,le,Kn].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:s,accessibilityManager:o,annotationLayer:c,drawLayer:h,textLayer:d,viewport:f,l10n:g}){const _=[...yi.#m.values()];if(!yi._initialized){yi._initialized=!0;for(const y of _)y.initialize(g,t)}t.registerEditorTypes(_),this.#h=t,this.pageIndex=e,this.div=n,this.#t=o,this.#n=c,this.viewport=f,this.#u=d,this.drawLayer=h,this._structTree=s,this.#h.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===vt.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#y(),t){case vt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case vt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case vt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const n of yi.#m.values())e.toggle(`${n._type}Editing`,t===n._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.div.classList.toggle("disabled",!t)}async enable(){this.#l=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#g?.abort(),this.#g=null;const t=new Set;for(const n of this.#s.values())n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#h.removeChangedExistingAnnotation(n),t.add(n.annotationElementId));if(!this.#n){this.#l=!1;return}const e=this.#n.getEditableAnnotations();for(const n of e){if(n.hide(),this.#h.isDeletedAnnotationElement(n.data.id)||t.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#l=!1}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#u&&!this.#g){this.#g=new AbortController;const s=this.#h.combinedSignal(this.#g);this.#u.div.addEventListener("pointerdown",o=>{const{clientX:h,clientY:d,timeStamp:f}=o,g=this.#p;if(f-g>500){this.#p=f;return}this.#p=-1;const{classList:_}=this.div;_.toggle("getElements",!0);const y=document.elementsFromPoint(h,d);if(_.toggle("getElements",!1),!this.div.contains(y[0]))return;let b;const A=new RegExp(`^${fv}[0-9]+$`);for(const w of y)if(A.test(w.id)){b=w.id;break}if(!b)return;const S=this.#s.get(b);S?.annotationElementId===null&&(o.stopPropagation(),o.preventDefault(),S.dblclick())},{signal:s,capture:!0})}const t=new Map,e=new Map;for(const s of this.#s.values())if(s.disableEditing(),!!s.annotationElementId){if(s.serialize()!==null){t.set(s.annotationElementId,s);continue}else e.set(s.annotationElementId,s);this.getEditableAnnotation(s.annotationElementId)?.show(),s.remove()}if(this.#n){const s=this.#n.getEditableAnnotations();for(const o of s){const{id:c}=o.data;if(this.#h.isDeletedAnnotationElement(c)){o.updateEdited({deleted:!0});continue}let h=e.get(c);if(h){h.resetAnnotationElement(o),h.show(!1),o.show();continue}h=t.get(c),h&&(this.#h.addChangedExistingAnnotation(h),h.renderAnnotationElement(o)&&h.show(!1)),o.show()}}this.#y(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const s of yi.#m.values())n.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#f){this.#f=new AbortController;const t=this.#h.combinedSignal(this.#f);this.#u.div.addEventListener("pointerdown",this.#b.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#u.div.classList.remove("highlighting"))}#b(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:n}=Pe.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#h.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),le.startHighlighting(this,this.#h.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#h.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#s.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#s.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),dt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#l),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getNextId(){return this.#h.getId()}get#_(){return yi.#m.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#A(t){const e=this.#_;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#_?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:n,offsetY:s}=this.#S(),o=this.getNextId(),c=this.#A({parent:this,id:o,x:n,y:s,uiManager:this.#h,isCentered:!0,...e});c&&this.add(c)}async deserialize(t){return await yi.#m.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,n={}){const s=this.getNextId(),o=this.#A({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...n});return o&&this.add(o),o}#S(){const{x:t,y:e,width:n,height:s}=this.div.getBoundingClientRect(),o=Math.max(0,t),c=Math.max(0,e),h=Math.min(window.innerWidth,t+n),d=Math.min(window.innerHeight,e+s),f=(o+h)/2-t,g=(c+d)/2-e,[_,y]=this.viewport.rotation%180===0?[f,g]:[g,f];return{offsetX:_,offsetY:y}}addNewEditor(t={}){this.createAndAddNewEditor(this.#S(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=Pe.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#r||(this.#r=!1,this.#_?.isDrawer&&this.#_.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const n=this.#h.getMode();if(n===vt.STAMP||n===vt.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===vt.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:e}=Pe.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#r=!0,this.#_?.isDrawer){this.startDrawingSession(t);return}const n=this.#h.getActive();this.#e=!n||n.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#c){this.#_.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#c=new AbortController;const e=this.#h.combinedSignal(this.#c);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#_.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#c?(this.#h.setCurrentDrawingSession(null),this.#c.abort(),this.#c=null,this.#d=null,this.#_.endDrawing(t)):null}findNewParent(t,e,n){const s=this.#h.findParent(e,n);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return this.#c?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#c&&this.#_.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#s.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#s.clear(),this.#h.removeLayer(this)}#y(){for(const t of this.#s.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ks(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#y();const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,ks(this.div,{rotation:n}),e!==n)for(const s of this.#s.values())s.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}}class Le{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return Rt(this,"_svgFactory",new Dc)}static#a(t,[e,n,s,o]){const{style:c}=t;c.top=`${100*n}%`,c.left=`${100*e}%`,c.width=`${100*s}%`,c.height=`${100*o}%`}#s(){const t=Le._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#r(t,e){const n=Le._svgFactory.createElement("clipPath");t.append(n);const s=`clip_${e}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=Le._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${e}`),o.classList.add("clip"),s}#o(t,e){for(const[n,s]of Object.entries(e))s===null?t.removeAttribute(n):t.setAttribute(n,s)}draw(t,e=!1,n=!1){const s=Le.#i++,o=this.#s(),c=Le._svgFactory.createElement("defs");o.append(c);const h=Le._svgFactory.createElement("path");c.append(h);const d=`path_p${this.pageIndex}_${s}`;h.setAttribute("id",d),h.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(s,h);const f=n?this.#r(c,d):null,g=Le._svgFactory.createElement("use");return o.append(g),g.setAttribute("href",`#${d}`),this.updateProperties(o,t),this.#e.set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(t,e){const n=Le.#i++,s=this.#s(),o=Le._svgFactory.createElement("defs");s.append(o);const c=Le._svgFactory.createElement("path");o.append(c);const h=`path_p${this.pageIndex}_${n}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const _=Le._svgFactory.createElement("mask");o.append(_),d=`mask_p${this.pageIndex}_${n}`,_.setAttribute("id",d),_.setAttribute("maskUnits","objectBoundingBox");const y=Le._svgFactory.createElement("rect");_.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const b=Le._svgFactory.createElement("use");_.append(b),b.setAttribute("href",`#${h}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const f=Le._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${h}`),d&&f.setAttribute("mask",`url(#${d})`);const g=f.cloneNode();return s.append(g),f.classList.add("mainOutline"),g.classList.add("secondaryOutline"),this.updateProperties(s,t),this.#e.set(n,s),n}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:n,bbox:s,rootClass:o,path:c}=e,h=typeof t=="number"?this.#e.get(t):t;if(h){if(n&&this.#o(h,n),s&&Le.#a(h,s),o){const{classList:d}=h;for(const[f,g]of Object.entries(o))d.toggle(f,g)}if(c){const f=h.firstChild.firstChild;this.#o(f,c)}}}updateParent(t,e){if(e===this)return;const n=this.#e.get(t);n&&(e.#t.append(n),this.#e.delete(t),e.#e.set(t,n))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:df};globalThis.pdfjsLib={AbortException:ts,AnnotationEditorLayer:yi,AnnotationEditorParamsType:kt,AnnotationEditorType:vt,AnnotationEditorUIManager:es,AnnotationLayer:tp,AnnotationMode:$i,AnnotationType:pe,build:yw,ColorPicker:Tn,createValidAbsoluteUrl:pv,DOMSVGFactory:Dc,DrawLayer:Le,FeatureTest:Pe,fetchData:zo,getDocument:Lv,getFilenameFromUrl:c1,getPdfFilenameFromUrl:u1,getRGB:tu,getUuid:_v,getXfaPageViewport:d1,GlobalWorkerOptions:Ua,ImageKind:Sc,InvalidPDFException:af,isDataScheme:Jc,isPdfFile:qf,isValidExplicitDest:E1,MathClamp:Ge,noContextMenu:Rn,normalizeUnicode:r1,OPS:Co,OutputScale:ti,PasswordResponses:QE,PDFDataRangeTransport:Iv,PDFDateString:rf,PDFWorker:xo,PermissionFlag:KE,PixelsPerInch:Xa,RenderingCancelledException:Gf,ResponseException:xc,setLayerDimensions:ks,shadow:Rt,SignatureExtractor:Ia,stopEvent:ge,SupportedImageMimeTypes:of,TextLayer:Ue,TouchManager:eu,updateUrlHash:gv,Util:ct,VerbosityLevel:Kc,version:_w,XfaLayer:Fv};const gf=(r,t)=>t.some(e=>r instanceof e);let fb,pb;function jw(){return fb||(fb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Gw(){return pb||(pb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const mf=new WeakMap,qd=new WeakMap,su=new WeakMap;function qw(r){const t=new Promise((e,n)=>{const s=()=>{r.removeEventListener("success",o),r.removeEventListener("error",c)},o=()=>{e(Os(r.result)),s()},c=()=>{n(r.error),s()};r.addEventListener("success",o),r.addEventListener("error",c)});return su.set(t,r),t}function Vw(r){if(mf.has(r))return;const t=new Promise((e,n)=>{const s=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",c),r.removeEventListener("abort",c)},o=()=>{e(),s()},c=()=>{n(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",o),r.addEventListener("error",c),r.addEventListener("abort",c)});mf.set(r,t)}let _f={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return mf.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Os(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function Yv(r){_f=r(_f)}function Yw(r){return Gw().includes(r)?function(...t){return r.apply(yf(this),t),Os(this.request)}:function(...t){return Os(r.apply(yf(this),t))}}function Xw(r){return typeof r=="function"?Yw(r):(r instanceof IDBTransaction&&Vw(r),gf(r,jw())?new Proxy(r,_f):r)}function Os(r){if(r instanceof IDBRequest)return qw(r);if(qd.has(r))return qd.get(r);const t=Xw(r);return t!==r&&(qd.set(r,t),su.set(t,r)),t}const yf=r=>su.get(r);function sp(r,t,{blocked:e,upgrade:n,blocking:s,terminated:o}={}){const c=indexedDB.open(r,t),h=Os(c);return n&&c.addEventListener("upgradeneeded",d=>{n(Os(c.result),d.oldVersion,d.newVersion,Os(c.transaction),d)}),e&&c.addEventListener("blocked",d=>e(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),h}const $w=["get","getKey","getAll","getAllKeys","count"],Ww=["put","add","delete","clear"],Vd=new Map;function gb(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if(Vd.get(t))return Vd.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,s=Ww.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(s||$w.includes(e)))return;const o=async function(c,...h){const d=this.transaction(c,s?"readwrite":"readonly");let f=d.store;return n&&(f=f.index(h.shift())),(await Promise.all([f[e](...h),s&&d.done]))[0]};return Vd.set(t,o),o}Yv(r=>({...r,get:(t,e,n)=>gb(t,e)||r.get(t,e,n),has:(t,e)=>!!gb(t,e)||r.has(t,e)}));const Kw=["continue","continuePrimaryKey","advance"],mb={},bf=new WeakMap,Xv=new WeakMap,Qw={get(r,t){if(!Kw.includes(t))return r[t];let e=mb[t];return e||(e=mb[t]=function(...n){bf.set(this,Xv.get(this)[t](...n))}),e}};async function*Zw(...r){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...r)),!t)return;t=t;const e=new Proxy(t,Qw);for(Xv.set(e,t),su.set(e,yf(t));t;)yield e,t=await(bf.get(e)||t.continue()),bf.delete(e)}function _b(r,t){return t===Symbol.asyncIterator&&gf(r,[IDBIndex,IDBObjectStore,IDBCursor])||t==="iterate"&&gf(r,[IDBIndex,IDBObjectStore])}Yv(r=>({...r,get(t,e,n){return _b(t,e)?Zw:r.get(t,e,n)},has(t,e){return _b(t,e)||r.has(t,e)}}));Ua.workerSrc="./pdf.worker.min.js";async function Jw(r){const t=await Lv({url:URL.createObjectURL(r)}).promise,e=[];for(let n=0;n<t.numPages;n++){const s=await t.getPage(n+1),o=await tC(s);e.push(o)}return e}async function tC(r){const n=(await r.getTextContent()).items.map(f=>{const[g,_,y,b,A,S]=f.transform;return{text:f.str,x:A,y:S,width:f.width,height:b}}).sort((f,g)=>Math.abs(f.y-g.y)>5?g.y-f.y:f.x-g.x),s=[];let o=[],c=null;const h=5;for(let f of n)c===null||Math.abs(f.y-c)<=h?(o.push(f),c===null?c=f.y:c=o.reduce((g,_)=>g+_.y,0)/o.length):(o.length&&s.push(o),o=[f],c=f.y);o.length&&s.push(o);let d="";for(let f of s){f.sort((y,b)=>y.x-b.x);let g="",_=null;for(let y of f)_!==null&&y.x-_>y.height*.2&&(g+=" "),g+=y.text,_=y.x+y.width;g.trim()&&(d+=g+`
`)}return d.trim()}function eC(r){return!r||!Array.isArray(r)||r.length===0?(console.warn("No se pudo extraer texto del PDF"),{}):r}function nC(r){const t=["Fecha Fin","Frec. Horas","F. Real de Ejecucion","Frec. Comb.","Incidencia"],e={"Numero orden":/Número orden\s+?(\d+)/,"Tipo de Orden":/[A-Z0-9]\nClase/,Clase:/Clase (.+?) Asignado a/,"Asignado a":/Asignado a (.+?)\n/,Descripcion:/Descripción (.+?) Tipo/,Tipo:/Tipo (.+?) Estado/,Estado:/Estado (.+?) Frec/,"Frec. Dias":/Frec\. D[ií]as ([0-9]+)/,"N Unidad":/Nº Unidad (.+?) Parte/,Parte:/Parte (.+?) F inicial/,"F inicial":/F inicial ([0-9/]+)/,"Frec. Comb.":/Frec\. Comb\. (.+?)/,Especialidad:/Especialidad (.+?) Elemento/,Elemento:/Elemento (.+?) FF\.\.RReeaall/,"F. Real de Ejecucion":/FF\.\.RReeaall EEjjeeccuucciioonn (.+?) Frec\. Km/,"Frec. Km":/Frec\. Km ([^ ]*)/,Modo:/Modo ([^ ]*?)(?:\s+(?:Fecha Fin|Frec\. Horas))/,"Fecha Fin":/Fecha Fin ([0-9/]+)/,"Frec. Horas":/Frec\. Horas ([^ ]*)/,Originador:/Originador\s+?([A-Z]+ [A-ZÁÉÍÓÚÑa-z\s]+)\nIncidencia/,Incidencia:/Incidencia (.+?) Fecha Venc\./,"Fecha Venc.":/Fecha Venc\. ([0-9/]+)/,"Ultima Realiz.":/Ultima Realiz\.\s+?([0-9/]+)/,Linea:/Linea (.+?) Kit de Tareas/,"Kit de Tareas":/Kit de Tareas ([0-9]+)/,"Proximo Venc.":/Proximo Venc\. ([0-9/]+)/,"Fecha Prox Emision":/Fecha Prox Emisión ([0-9/]+)/,"N de Serie":/Nº de Serie (.+?) Planta/,Planta:/Planta (.+?) Tipo servici/,"Tipo servici":/Tipo servici ([A-Z0-9]+ [A-ZÁÉÍÓÚÑa-z\.]+)/,Prioridad:/Prioridad: ([A-Z\-a-z]+)/,"Seg. y Medio Ambiente":/Seg\. y Medio Ambiente ([A-Z0-9]+)/,Calidad:/Calidad ([A-Z0-9]+)/,Operacion:/Operación ([A-Z0-9]+)/,Mantenimiento:/Mantenimiento ([A-Z0-9]+)/,Categorizacion:/Categorización\s+?([A-Z0-9]+)/,"Tipo de Servicio":/Tipo de Servicio (.+?)\n/},n={};t.forEach(o=>n[o]=null);for(const[o,c]of Object.entries(e)){const h=r.match(c);h&&(n[o]=h[1].trim())}let s=n["Tipo de Servicio"];return s&&s.includes("SYS")?s=1:s&&s.includes("CCL")?s=2:s=3,n["Frec. Dias"]=n["Frec. Dias"]&&!isNaN(n["Frec. Dias"])?parseInt(n["Frec. Dias"]):null,n.prioridad=s,n.asignado_a_code=null,n.asignado_por_name=null,n.asignado_por_code=null,n.Especialidad_id=null,n.hs_reales=0,n.fecha_inicio=null,n.fecha_fin=null,n.observaciones=null,n.status=0,n.obs_anulada=null,n.code_orden_anulada=null,n.checkListDict={},n}function iC(r){const t=r.split(`
`),e=[];let n=0;const s=/^([A-ZÁÉÍÓÚÑa-z0-9]+)\s+([\d\S]+)\s+(\d+)\s+(.*)\s+(\d\.\d+|\.\d+)\s+(.+)/,o=/^([A-ZÁÉÍÓÚÑa-z0-9]+)\s+([\d\.]+)\s+(\d+)\s+(.+)/;let c=0;for(let h=17;h<t.length;h++){const d=t[h];let f=d.match(s);if(f){let g=parseFloat(f[5]);isNaN(g)&&(g=0);const _={Taller:f[1],"Numero sec oper":parseFloat(f[2]),"Tarea Standard":f[3],Descripcion:f[4],"Hs Estim":g,"Valor esperado":f[6],completed_by:null,date_completed:null,obs_assigned_by:null,obs_assigned_to:null,init_task:null,end_task:null,status:0,duration_seconds:null,pause:null};e.push(_),n++}else if(f=d.match(o),f){const g={Taller:f[1],"Numero sec oper":parseFloat(f[2]),"Tarea Standard":f[3],Descripcion:f[4],"Hs Estim":0,"Valor esperado":f[4],completed_by:null,date_completed:null,obs_assigned_by:null,obs_assigned_to:null,init_task:null,end_task:null,status:0,duration_seconds:null,pause:null};e.push(g),n++}else{try{c=e.reduce((g,_)=>g+(_["Hs Estim"]||0),0),c=Math.round(c*1e3)/1e3}catch{c=0}return{data:e,Tasks_N:n,h_estimadas:c}}}try{c=e.reduce((h,d)=>h+(d["Hs Estim"]||0),0),c=Math.round(c*1e3)/1e3}catch{c=0}return{data:e,Tasks_N:n,h_estimadas:c}}function sC(r,t){let e="";const n=["OT Generadas","Realizado por:","Firma:"];e=t.split(`
`).slice(r+17).join(`
`).trim();for(const o of n){const c=e.indexOf(o);if(c!==-1){e=e.slice(0,c).trim();break}}return e}function aC(r,t){t=sC(r,t);const e=/^(.?.?T\d+)/im,n=/^(.?.?SEGURIDAD)|^(.?.?SGURIDAD)/im,s=[];let o="",c="",h=0,d=0;for(const f of t.split(`
`))e.test(f)?(h===1&&(c!==""&&(o=c+`
`+o),s.push(o)),o=f,h=1,d=0):n.test(f)&&h===1&&d===0?o+=`
`+f:n.test(f)?d===1&&h===1?(o=c+`
`+o,s.push(o)):(c=f,h=2,d=1):h===1?o+=`
`+f:h===2&&(c+=`
`+f);return h===1?(c!==""&&(o=c+`
`+o),s.push(o)):h===2&&c!==""&&s.push(c),s}function rC(r){const t=eC(r),e=/Número orden\s+?(\d+)/,n=/(\nOT Generadas)|(\nRealizado por:)|(\nFirma:)/g,s="",o={};for(const c of t){let h;if((h=e.exec(c))!==null){const d=h[1];if(o[d]){let f=c.replace(n,s);f=f.split(`
`).slice(3).join(`
`),o[d].data+=`
`+f}else{o[d]={};let f=c.replace(n,s);o[d].data=f}}}for(const c in o)o[c].info=nC(o[c].data),o[c].tasks=iC(o[c].data),o[c].protocolos=aC(o[c].tasks.Tasks_N,o[c].data);return o}async function oC(r){let t=[];Array.isArray(r)?t=r:typeof r=="object"&&r!==null&&(t=Object.entries(r).map(([s,o])=>({id:s,...o})));const n=(await sp("pdfDataDB",1,{upgrade(s){s.objectStoreNames.contains("pdfData")||s.createObjectStore("pdfData",{keyPath:"id"})}})).transaction("pdfData","readwrite");for(const s of t)await n.store.put(s);await n.done}async function lC(r,t){const e=await Jw(r),n=rC(e);await oC(n),t(Object.keys(n).length)}const cC=()=>{};var yb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $v={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tt=function(r,t){if(!r)throw er(t)},er=function(r){return new Error("Firebase Database ("+$v.SDK_VERSION+") INTERNAL ASSERT FAILED: "+r)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wv=function(r){const t=[];let e=0;for(let n=0;n<r.length;n++){let s=r.charCodeAt(n);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(r.charCodeAt(++n)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},uC=function(r){const t=[];let e=0,n=0;for(;e<r.length;){const s=r[e++];if(s<128)t[n++]=String.fromCharCode(s);else if(s>191&&s<224){const o=r[e++];t[n++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=r[e++],c=r[e++],h=r[e++],d=((s&7)<<18|(o&63)<<12|(c&63)<<6|h&63)-65536;t[n++]=String.fromCharCode(55296+(d>>10)),t[n++]=String.fromCharCode(56320+(d&1023))}else{const o=r[e++],c=r[e++];t[n++]=String.fromCharCode((s&15)<<12|(o&63)<<6|c&63)}}return t.join("")},ap={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,t){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<r.length;s+=3){const o=r[s],c=s+1<r.length,h=c?r[s+1]:0,d=s+2<r.length,f=d?r[s+2]:0,g=o>>2,_=(o&3)<<4|h>>4;let y=(h&15)<<2|f>>6,b=f&63;d||(b=64,c||(y=64)),n.push(e[g],e[_],e[y],e[b])}return n.join("")},encodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(r):this.encodeByteArray(Wv(r),t)},decodeString(r,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(r):uC(this.decodeStringToByteArray(r,t))},decodeStringToByteArray(r,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<r.length;){const o=e[r.charAt(s++)],h=s<r.length?e[r.charAt(s)]:0;++s;const f=s<r.length?e[r.charAt(s)]:64;++s;const _=s<r.length?e[r.charAt(s)]:64;if(++s,o==null||h==null||f==null||_==null)throw new hC;const y=o<<2|h>>4;if(n.push(y),f!==64){const b=h<<4&240|f>>2;if(n.push(b),_!==64){const A=f<<6&192|_;n.push(A)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class hC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kv=function(r){const t=Wv(r);return ap.encodeByteArray(t,!0)},Mc=function(r){return Kv(r).replace(/\./g,"")},vf=function(r){try{return ap.decodeString(r,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dC(r){return Qv(void 0,r)}function Qv(r,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const e=t;return new Date(e.getTime());case Object:r===void 0&&(r={});break;case Array:r=[];break;default:return t}for(const e in t)!t.hasOwnProperty(e)||!fC(e)||(r[e]=Qv(r[e],t[e]));return r}function fC(r){return r!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=()=>pC().__FIREBASE_DEFAULTS__,mC=()=>{if(typeof process>"u"||typeof yb>"u")return;const r=yb.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},_C=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=r&&vf(r[1]);return t&&JSON.parse(t)},Zv=()=>{try{return cC()||gC()||mC()||_C()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},yC=r=>Zv()?.emulatorHosts?.[r],bC=r=>{const t=yC(r);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),n]:[t.substring(0,e),n]},Jv=()=>Zv()?.config;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function vC(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AC(r,t){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},n=t||"demo-project",s=r.iat||0,o=r.sub||r.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...r};return[Mc(JSON.stringify(e)),Mc(JSON.stringify(c)),""].join(".")}const bo={};function SC(){const r={prod:[],emulator:[]};for(const t of Object.keys(bo))bo[t]?r.emulator.push(t):r.prod.push(t);return r}function EC(r){let t=document.getElementById(r),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",r),e=!0),{created:e,element:t}}let bb=!1;function wC(r,t){if(typeof window>"u"||typeof document>"u"||!rp(window.location.host)||bo[r]===t||bo[r]||bb)return;bo[r]=t;function e(y){return`__firebase__banner__${y}`}const n="__firebase__banner",o=SC().prod.length>0;function c(){const y=document.getElementById(n);y&&y.remove()}function h(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function d(y,b){y.setAttribute("width","24"),y.setAttribute("id",b),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function f(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{bb=!0,c()},y}function g(y,b){y.setAttribute("id",b),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function _(){const y=EC(n),b=e("text"),A=document.getElementById(b)||document.createElement("span"),S=e("learnmore"),w=document.getElementById(S)||document.createElement("a"),C=e("preprendIcon"),D=document.getElementById(C)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const x=y.element;h(x),g(w,S);const I=f();d(D,C),x.append(D,A,w,I),document.body.appendChild(x)}o?(A.innerText="Preview backend disconnected.",D.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(D.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",b)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function t0(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(CC())}function TC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function xC(){return $v.NODE_ADMIN===!0}function RC(){try{return typeof indexedDB=="object"}catch{return!1}}function DC(){return new Promise((r,t)=>{try{let e=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(n),r(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MC="FirebaseError";class Vo extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name=MC,Object.setPrototypeOf(this,Vo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,e0.prototype.create)}}class e0{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},s=`${this.service}/${t}`,o=this.errors[t],c=o?NC(o,n):"Error",h=`${this.serviceName}: ${c} (${s}).`;return new Vo(s,h,n)}}function NC(r,t){return r.replace(OC,(e,n)=>{const s=t[n];return s!=null?String(s):`<${n}?>`})}const OC=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(r){return JSON.parse(r)}function xe(r){return JSON.stringify(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0=function(r){let t={},e={},n={},s="";try{const o=r.split(".");t=Do(vf(o[0])||""),e=Do(vf(o[1])||""),s=o[2],n=e.d||{},delete e.d}catch{}return{header:t,claims:e,data:n,signature:s}},kC=function(r){const t=n0(r),e=t.claims;return!!e&&typeof e=="object"&&e.hasOwnProperty("iat")},LC=function(r){const t=n0(r).claims;return typeof t=="object"&&t.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(r,t){return Object.prototype.hasOwnProperty.call(r,t)}function $a(r,t){if(Object.prototype.hasOwnProperty.call(r,t))return r[t]}function Af(r){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t))return!1;return!0}function Nc(r,t,e){const n={};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(n[s]=t.call(e,r[s],s,r));return n}function Oc(r,t){if(r===t)return!0;const e=Object.keys(r),n=Object.keys(t);for(const s of e){if(!n.includes(s))return!1;const o=r[s],c=t[s];if(vb(o)&&vb(c)){if(!Oc(o,c))return!1}else if(o!==c)return!1}for(const s of n)if(!e.includes(s))return!1;return!0}function vb(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IC(r){const t=[];for(const[e,n]of Object.entries(r))Array.isArray(n)?n.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n));return t.length?"&"+t.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const n=this.W_;if(typeof t=="string")for(let _=0;_<16;_++)n[_]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let _=0;_<16;_++)n[_]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let _=16;_<80;_++){const y=n[_-3]^n[_-8]^n[_-14]^n[_-16];n[_]=(y<<1|y>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],c=this.chain_[2],h=this.chain_[3],d=this.chain_[4],f,g;for(let _=0;_<80;_++){_<40?_<20?(f=h^o&(c^h),g=1518500249):(f=o^c^h,g=1859775393):_<60?(f=o&c|h&(o|c),g=2400959708):(f=o^c^h,g=3395469782);const y=(s<<5|s>>>27)+f+d+g+n[_]&4294967295;d=h,h=c,c=(o<<30|o>>>2)&4294967295,o=s,s=y}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295}update(t,e){if(t==null)return;e===void 0&&(e=t.length);const n=e-this.blockSize;let s=0;const o=this.buf_;let c=this.inbuf_;for(;s<e;){if(c===0)for(;s<=n;)this.compress_(t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(o[c]=t.charCodeAt(s),++c,++s,c===this.blockSize){this.compress_(o),c=0;break}}else for(;s<e;)if(o[c]=t[s],++c,++s,c===this.blockSize){this.compress_(o),c=0;break}}this.inbuf_=c,this.total_+=e}digest(){const t=[];let e=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=e&255,e/=256;this.compress_(this.buf_);let n=0;for(let s=0;s<5;s++)for(let o=24;o>=0;o-=8)t[n]=this.chain_[s]>>o&255,++n;return t}}function Wa(r,t){return`${r} failed: ${t} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC=function(r){const t=[];let e=0;for(let n=0;n<r.length;n++){let s=r.charCodeAt(n);if(s>=55296&&s<=56319){const o=s-55296;n++,tt(n<r.length,"Surrogate pair missing trail surrogate.");const c=r.charCodeAt(n)-56320;s=65536+(o<<10)+c}s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):s<65536?(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},au=function(r){let t=0;for(let e=0;e<r.length;e++){const n=r.charCodeAt(e);n<128?t++:n<2048?t+=2:n>=55296&&n<=56319?(t+=4,e++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Us(r){return r&&r._delegate?r._delegate:r}class Mo{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const n=new Jn;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),n=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(zC(t))try{this.getOrInitializeService({instanceIdentifier:Cs})}catch{}for(const[e,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const o=this.getOrInitializeService({instanceIdentifier:s});n.resolve(o)}catch{}}}}clearInstance(t=Cs){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Cs){return this.instances.has(t)}getOptions(t=Cs){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[o,c]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(o);n===h&&c.resolve(s)}return s}onInit(t,e){const n=this.normalizeInstanceIdentifier(e),s=this.onInitCallbacks.get(n)??new Set;s.add(t),this.onInitCallbacks.set(n,s);const o=this.instances.get(n);return o&&t(o,n),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:HC(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch{}return n||null}normalizeInstanceIdentifier(t=Cs){return this.component?this.component.multipleInstances?t:Cs:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HC(r){return r===Cs?void 0:r}function zC(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new FC(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Kt||(Kt={}));const jC={debug:Kt.DEBUG,verbose:Kt.VERBOSE,info:Kt.INFO,warn:Kt.WARN,error:Kt.ERROR,silent:Kt.SILENT},GC=Kt.INFO,qC={[Kt.DEBUG]:"log",[Kt.VERBOSE]:"log",[Kt.INFO]:"info",[Kt.WARN]:"warn",[Kt.ERROR]:"error"},VC=(r,t,...e)=>{if(t<r.logLevel)return;const n=new Date().toISOString(),s=qC[t];if(s)console[s](`[${n}]  ${r.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class i0{constructor(t){this.name=t,this._logLevel=GC,this._logHandler=VC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Kt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?jC[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Kt.DEBUG,...t),this._logHandler(this,Kt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Kt.VERBOSE,...t),this._logHandler(this,Kt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Kt.INFO,...t),this._logHandler(this,Kt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Kt.WARN,...t),this._logHandler(this,Kt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Kt.ERROR,...t),this._logHandler(this,Kt.ERROR,...t)}}const YC=(r,t)=>t.some(e=>r instanceof e);let Ab,Sb;function XC(){return Ab||(Ab=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $C(){return Sb||(Sb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const s0=new WeakMap,Sf=new WeakMap,a0=new WeakMap,Yd=new WeakMap,op=new WeakMap;function WC(r){const t=new Promise((e,n)=>{const s=()=>{r.removeEventListener("success",o),r.removeEventListener("error",c)},o=()=>{e(Qi(r.result)),s()},c=()=>{n(r.error),s()};r.addEventListener("success",o),r.addEventListener("error",c)});return t.then(e=>{e instanceof IDBCursor&&s0.set(e,r)}).catch(()=>{}),op.set(t,r),t}function KC(r){if(Sf.has(r))return;const t=new Promise((e,n)=>{const s=()=>{r.removeEventListener("complete",o),r.removeEventListener("error",c),r.removeEventListener("abort",c)},o=()=>{e(),s()},c=()=>{n(r.error||new DOMException("AbortError","AbortError")),s()};r.addEventListener("complete",o),r.addEventListener("error",c),r.addEventListener("abort",c)});Sf.set(r,t)}let Ef={get(r,t,e){if(r instanceof IDBTransaction){if(t==="done")return Sf.get(r);if(t==="objectStoreNames")return r.objectStoreNames||a0.get(r);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Qi(r[t])},set(r,t,e){return r[t]=e,!0},has(r,t){return r instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in r}};function QC(r){Ef=r(Ef)}function ZC(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const n=r.call(Xd(this),t,...e);return a0.set(n,t.sort?t.sort():[t]),Qi(n)}:$C().includes(r)?function(...t){return r.apply(Xd(this),t),Qi(s0.get(this))}:function(...t){return Qi(r.apply(Xd(this),t))}}function JC(r){return typeof r=="function"?ZC(r):(r instanceof IDBTransaction&&KC(r),YC(r,XC())?new Proxy(r,Ef):r)}function Qi(r){if(r instanceof IDBRequest)return WC(r);if(Yd.has(r))return Yd.get(r);const t=JC(r);return t!==r&&(Yd.set(r,t),op.set(t,r)),t}const Xd=r=>op.get(r);function tT(r,t,{blocked:e,upgrade:n,blocking:s,terminated:o}={}){const c=indexedDB.open(r,t),h=Qi(c);return n&&c.addEventListener("upgradeneeded",d=>{n(Qi(c.result),d.oldVersion,d.newVersion,Qi(c.transaction),d)}),e&&c.addEventListener("blocked",d=>e(d.oldVersion,d.newVersion,d)),h.then(d=>{o&&d.addEventListener("close",()=>o()),s&&d.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),h}const eT=["get","getKey","getAll","getAllKeys","count"],nT=["put","add","delete","clear"],$d=new Map;function Eb(r,t){if(!(r instanceof IDBDatabase&&!(t in r)&&typeof t=="string"))return;if($d.get(t))return $d.get(t);const e=t.replace(/FromIndex$/,""),n=t!==e,s=nT.includes(e);if(!(e in(n?IDBIndex:IDBObjectStore).prototype)||!(s||eT.includes(e)))return;const o=async function(c,...h){const d=this.transaction(c,s?"readwrite":"readonly");let f=d.store;return n&&(f=f.index(h.shift())),(await Promise.all([f[e](...h),s&&d.done]))[0]};return $d.set(t,o),o}QC(r=>({...r,get:(t,e,n)=>Eb(t,e)||r.get(t,e,n),has:(t,e)=>!!Eb(t,e)||r.has(t,e)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iT{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(sT(e)){const n=e.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(e=>e).join(" ")}}function sT(r){return r.getComponent()?.type==="VERSION"}const wf="@firebase/app",wb="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new i0("@firebase/app"),aT="@firebase/app-compat",rT="@firebase/analytics-compat",oT="@firebase/analytics",lT="@firebase/app-check-compat",cT="@firebase/app-check",uT="@firebase/auth",hT="@firebase/auth-compat",dT="@firebase/database",fT="@firebase/data-connect",pT="@firebase/database-compat",gT="@firebase/functions",mT="@firebase/functions-compat",_T="@firebase/installations",yT="@firebase/installations-compat",bT="@firebase/messaging",vT="@firebase/messaging-compat",AT="@firebase/performance",ST="@firebase/performance-compat",ET="@firebase/remote-config",wT="@firebase/remote-config-compat",CT="@firebase/storage",TT="@firebase/storage-compat",xT="@firebase/firestore",RT="@firebase/ai",DT="@firebase/firestore-compat",MT="firebase",NT="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cf="[DEFAULT]",OT={[wf]:"fire-core",[aT]:"fire-core-compat",[oT]:"fire-analytics",[rT]:"fire-analytics-compat",[cT]:"fire-app-check",[lT]:"fire-app-check-compat",[uT]:"fire-auth",[hT]:"fire-auth-compat",[dT]:"fire-rtdb",[fT]:"fire-data-connect",[pT]:"fire-rtdb-compat",[gT]:"fire-fn",[mT]:"fire-fn-compat",[_T]:"fire-iid",[yT]:"fire-iid-compat",[bT]:"fire-fcm",[vT]:"fire-fcm-compat",[AT]:"fire-perf",[ST]:"fire-perf-compat",[ET]:"fire-rc",[wT]:"fire-rc-compat",[CT]:"fire-gcs",[TT]:"fire-gcs-compat",[xT]:"fire-fst",[DT]:"fire-fst-compat",[RT]:"fire-vertex","fire-js":"fire-js",[MT]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kc=new Map,kT=new Map,Tf=new Map;function Cb(r,t){try{r.container.addComponent(t)}catch(e){Si.debug(`Component ${t.name} failed to register with FirebaseApp ${r.name}`,e)}}function Lc(r){const t=r.name;if(Tf.has(t))return Si.debug(`There were multiple attempts to register component ${t}.`),!1;Tf.set(t,r);for(const e of kc.values())Cb(e,r);for(const e of kT.values())Cb(e,r);return!0}function LT(r,t){const e=r.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),r.container.getProvider(t)}function IT(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PT={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zi=new e0("app","Firebase",PT);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(t,e,n){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Mo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw Zi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT=NT;function r0(r,t={}){let e=r;typeof t!="object"&&(t={name:t});const n={name:Cf,automaticDataCollectionEnabled:!0,...t},s=n.name;if(typeof s!="string"||!s)throw Zi.create("bad-app-name",{appName:String(s)});if(e||(e=Jv()),!e)throw Zi.create("no-options");const o=kc.get(s);if(o){if(Oc(e,o.options)&&Oc(n,o.config))return o;throw Zi.create("duplicate-app",{appName:s})}const c=new UC(s);for(const d of Tf.values())c.addComponent(d);const h=new BT(e,n,c);return kc.set(s,h),h}function HT(r=Cf){const t=kc.get(r);if(!t&&r===Cf&&Jv())return r0();if(!t)throw Zi.create("no-app",{appName:r});return t}function ja(r,t,e){let n=OT[r]??r;e&&(n+=`-${e}`);const s=n.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const c=[`Unable to register library "${n}" with version "${t}":`];s&&c.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&c.push("and"),o&&c.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Si.warn(c.join(" "));return}Lc(new Mo(`${n}-version`,()=>({library:n,version:t}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT="firebase-heartbeat-database",UT=1,No="firebase-heartbeat-store";let Wd=null;function o0(){return Wd||(Wd=tT(zT,UT,{upgrade:(r,t)=>{switch(t){case 0:try{r.createObjectStore(No)}catch(e){console.warn(e)}}}}).catch(r=>{throw Zi.create("idb-open",{originalErrorMessage:r.message})})),Wd}async function jT(r){try{const e=(await o0()).transaction(No),n=await e.objectStore(No).get(l0(r));return await e.done,n}catch(t){if(t instanceof Vo)Si.warn(t.message);else{const e=Zi.create("idb-get",{originalErrorMessage:t?.message});Si.warn(e.message)}}}async function Tb(r,t){try{const n=(await o0()).transaction(No,"readwrite");await n.objectStore(No).put(t,l0(r)),await n.done}catch(e){if(e instanceof Vo)Si.warn(e.message);else{const n=Zi.create("idb-set",{originalErrorMessage:e?.message});Si.warn(n.message)}}}function l0(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GT=1024,qT=30;class VT{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new XT(e),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=xb();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:e}),this._heartbeatsCache.heartbeats.length>qT){const s=$T(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){Si.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=xb(),{heartbeatsToSend:e,unsentEntries:n}=YT(this._heartbeatsCache.heartbeats),s=Mc(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Si.warn(t),""}}}function xb(){return new Date().toISOString().substring(0,10)}function YT(r,t=GT){const e=[];let n=r.slice();for(const s of r){const o=e.find(c=>c.agent===s.agent);if(o){if(o.dates.push(s.date),Rb(e)>t){o.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),Rb(e)>t){e.pop();break}n=n.slice(1)}return{heartbeatsToSend:e,unsentEntries:n}}class XT{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return RC()?DC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await jT(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return Tb(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const n=await this.read();return Tb(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}else return}}function Rb(r){return Mc(JSON.stringify({version:2,heartbeats:r})).length}function $T(r){if(r.length===0)return-1;let t=0,e=r[0].date;for(let n=1;n<r.length;n++)r[n].date<e&&(e=r[n].date,t=n);return t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(r){Lc(new Mo("platform-logger",t=>new iT(t),"PRIVATE")),Lc(new Mo("heartbeat",t=>new VT(t),"PRIVATE")),ja(wf,wb,r),ja(wf,wb,"esm2020"),ja("fire-js","")}WT("");var KT="firebase",QT="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ja(KT,QT,"app");var Db={};const Mb="@firebase/database",Nb="1.1.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c0="";function ZT(r){c0=r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JT{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){e==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),xe(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return e==null?null:Do(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){e==null?delete this.cache_[t]:this.cache_[t]=e}get(t){return ei(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u0=function(r){try{if(typeof window<"u"&&typeof window[r]<"u"){const t=window[r];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new JT(t)}}catch{}return new tx},Rs=u0("localStorage"),ex=u0("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ga=new i0("@firebase/database"),nx=(function(){let r=1;return function(){return r++}})(),h0=function(r){const t=BC(r),e=new PC;e.update(t);const n=e.digest();return ap.encodeByteArray(n)},Yo=function(...r){let t="";for(let e=0;e<r.length;e++){const n=r[e];Array.isArray(n)||n&&typeof n=="object"&&typeof n.length=="number"?t+=Yo.apply(null,n):typeof n=="object"?t+=xe(n):t+=n,t+=" "}return t};let vo=null,Ob=!0;const ix=function(r,t){tt(!0,"Can't turn on custom loggers persistently."),Ga.logLevel=Kt.VERBOSE,vo=Ga.log.bind(Ga)},Te=function(...r){if(Ob===!0&&(Ob=!1,vo===null&&ex.get("logging_enabled")===!0&&ix()),vo){const t=Yo.apply(null,r);vo(t)}},Xo=function(r){return function(...t){Te(r,...t)}},xf=function(...r){const t="FIREBASE INTERNAL ERROR: "+Yo(...r);Ga.error(t)},Ei=function(...r){const t=`FIREBASE FATAL ERROR: ${Yo(...r)}`;throw Ga.error(t),new Error(t)},Ve=function(...r){const t="FIREBASE WARNING: "+Yo(...r);Ga.warn(t)},sx=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ve("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},ru=function(r){return typeof r=="number"&&(r!==r||r===Number.POSITIVE_INFINITY||r===Number.NEGATIVE_INFINITY)},ax=function(r){if(document.readyState==="complete")r();else{let t=!1;const e=function(){if(!document.body){setTimeout(e,Math.floor(10));return}t||(t=!0,r())};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&e()}),window.attachEvent("onload",e))}},Ka="[MIN_NAME]",Is="[MAX_NAME]",js=function(r,t){if(r===t)return 0;if(r===Ka||t===Is)return-1;if(t===Ka||r===Is)return 1;{const e=kb(r),n=kb(t);return e!==null?n!==null?e-n===0?r.length-t.length:e-n:-1:n!==null?1:r<t?-1:1}},rx=function(r,t){return r===t?0:r<t?-1:1},uo=function(r,t){if(t&&r in t)return t[r];throw new Error("Missing required key ("+r+") in object: "+xe(t))},lp=function(r){if(typeof r!="object"||r===null)return xe(r);const t=[];for(const n in r)t.push(n);t.sort();let e="{";for(let n=0;n<t.length;n++)n!==0&&(e+=","),e+=xe(t[n]),e+=":",e+=lp(r[t[n]]);return e+="}",e},d0=function(r,t){const e=r.length;if(e<=t)return[r];const n=[];for(let s=0;s<e;s+=t)s+t>e?n.push(r.substring(s,e)):n.push(r.substring(s,s+t));return n};function Re(r,t){for(const e in r)r.hasOwnProperty(e)&&t(e,r[e])}const f0=function(r){tt(!ru(r),"Invalid JSON number");const t=11,e=52,n=(1<<t-1)-1;let s,o,c,h,d;r===0?(o=0,c=0,s=1/r===-1/0?1:0):(s=r<0,r=Math.abs(r),r>=Math.pow(2,1-n)?(h=Math.min(Math.floor(Math.log(r)/Math.LN2),n),o=h+n,c=Math.round(r*Math.pow(2,e-h)-Math.pow(2,e))):(o=0,c=Math.round(r/Math.pow(2,1-n-e))));const f=[];for(d=e;d;d-=1)f.push(c%2?1:0),c=Math.floor(c/2);for(d=t;d;d-=1)f.push(o%2?1:0),o=Math.floor(o/2);f.push(s?1:0),f.reverse();const g=f.join("");let _="";for(d=0;d<64;d+=8){let y=parseInt(g.substr(d,8),2).toString(16);y.length===1&&(y="0"+y),_=_+y}return _.toLowerCase()},ox=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},lx=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function cx(r,t){let e="Unknown Error";r==="too_big"?e="The data requested exceeds the maximum size that can be accessed with a single request.":r==="permission_denied"?e="Client doesn't have permission to access the desired data.":r==="unavailable"&&(e="The service is unavailable");const n=new Error(r+" at "+t._path.toString()+": "+e);return n.code=r.toUpperCase(),n}const ux=new RegExp("^-?(0*)\\d{1,10}$"),hx=-2147483648,dx=2147483647,kb=function(r){if(ux.test(r)){const t=Number(r);if(t>=hx&&t<=dx)return t}return null},nr=function(r){try{r()}catch(t){setTimeout(()=>{const e=t.stack||"";throw Ve("Exception was thrown by user callback.",e),t},Math.floor(0))}},fx=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ao=function(r,t){const e=setTimeout(r,t);return typeof e=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):typeof e=="object"&&e.unref&&e.unref(),e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(t,e){this.appCheckProvider=e,this.appName=t.name,IT(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(n=>this.appCheck=n)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((e,n)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,n):e(null)},0)})}addTokenChangeListener(t){this.appCheckProvider?.get().then(e=>e.addTokenListener(t))}notifyForInvalidToken(){Ve(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(t,e,n){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(s=>this.auth_=s)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(e=>e&&e.code==="auth/token-not-initialized"?(Te("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,n)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,n):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ve(t)}}class Cc{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}Cc.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp="5",p0="v",g0="s",m0="r",_0="f",y0=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,b0="ls",v0="p",Rf="ac",A0="websocket",S0="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E0{constructor(t,e,n,s,o=!1,c="",h=!1,d=!1,f=null){this.secure=e,this.namespace=n,this.webSocketOnly=s,this.nodeAdmin=o,this.persistenceKey=c,this.includeNamespaceInQueryParams=h,this.isUsingEmulator=d,this.emulatorOptions=f,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Rs.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Rs.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}}function mx(r){return r.host!==r.internalHost||r.isCustomHost()||r.includeNamespaceInQueryParams}function w0(r,t,e){tt(typeof t=="string","typeof type must == string"),tt(typeof e=="object","typeof params must == object");let n;if(t===A0)n=(r.secure?"wss://":"ws://")+r.internalHost+"/.ws?";else if(t===S0)n=(r.secure?"https://":"http://")+r.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);mx(r)&&(e.ns=r.namespace);const s=[];return Re(e,(o,c)=>{s.push(o+"="+c)}),n+s.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(){this.counters_={}}incrementCounter(t,e=1){ei(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return dC(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd={},Qd={};function up(r){const t=r.toString();return Kd[t]||(Kd[t]=new _x),Kd[t]}function yx(r,t){const e=r.toString();return Qd[e]||(Qd[e]=t()),Qd[e]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bx{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const n=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<n.length;++s)n[s]&&nr(()=>{this.onMessage_(n[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb="start",vx="close",Ax="pLPCommand",Sx="pRTLPCB",C0="id",T0="pw",x0="ser",Ex="cb",wx="seg",Cx="ts",Tx="d",xx="dframe",R0=1870,D0=30,Rx=R0-D0,Dx=25e3,Mx=3e4;class Fa{constructor(t,e,n,s,o,c,h){this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=s,this.authToken=o,this.transportSessionId=c,this.lastSessionId=h,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xo(t),this.stats_=up(e),this.urlFn=d=>(this.appCheckToken&&(d[Rf]=this.appCheckToken),w0(e,S0,d))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new bx(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Mx)),ax(()=>{if(this.isClosed_)return;this.scriptTagHolder=new hp((...o)=>{const[c,h,d,f,g]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,c===Lb)this.id=h,this.password=d;else if(c===vx)h?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(h,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+c)},(...o)=>{const[c,h]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(c,h)},()=>{this.onClosed_()},this.urlFn);const n={};n[Lb]="t",n[x0]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(n[Ex]=this.scriptTagHolder.uniqueCallbackIdentifier),n[p0]=cp,this.transportSessionId&&(n[g0]=this.transportSessionId),this.lastSessionId&&(n[b0]=this.lastSessionId),this.applicationId&&(n[v0]=this.applicationId),this.appCheckToken&&(n[Rf]=this.appCheckToken),typeof location<"u"&&location.hostname&&y0.test(location.hostname)&&(n[m0]=_0);const s=this.urlFn(n);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Fa.forceAllow_=!0}static forceDisallow(){Fa.forceDisallow_=!0}static isAvailable(){return Fa.forceAllow_?!0:!Fa.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!ox()&&!lx()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=xe(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=Kv(e),s=d0(n,Rx);for(let o=0;o<s.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[o]),this.curSegmentNum++}addDisconnectPingFrame(t,e){this.myDisconnFrame=document.createElement("iframe");const n={};n[xx]="t",n[C0]=t,n[T0]=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=xe(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class hp{constructor(t,e,n,s){this.onDisconnect=n,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=nx(),window[Ax+this.uniqueCallbackIdentifier]=t,window[Sx+this.uniqueCallbackIdentifier]=e,this.myIFrame=hp.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(h){Te("frame writing exception"),h.stack&&Te(h.stack),Te(h)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Te("No IE domain setting required")}catch{const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[C0]=this.myID,t[T0]=this.myPW,t[x0]=this.currentSerial;let e=this.urlFn(t),n="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+D0+n.length<=R0;){const c=this.pendingSegs.shift();n=n+"&"+wx+s+"="+c.seg+"&"+Cx+s+"="+c.ts+"&"+Tx+s+"="+c.d,s++}return e=e+n,this.addLongPollTag_(e,this.currentSerial),!0}else return!1}enqueueSegment(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const n=()=>{this.outstandingRequests.delete(e),this.newRequest_()},s=setTimeout(n,Math.floor(Dx)),o=()=>{clearTimeout(s),n()};this.addTag(t,o)}addTag(t,e){setTimeout(()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const s=n.readyState;(!s||s==="loaded"||s==="complete")&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),e())},n.onerror=()=>{Te("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx=16384,Ox=45e3;let Ic=null;typeof MozWebSocket<"u"?Ic=MozWebSocket:typeof WebSocket<"u"&&(Ic=WebSocket);class kn{constructor(t,e,n,s,o,c,h){this.connId=t,this.applicationId=n,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xo(this.connId),this.stats_=up(e),this.connURL=kn.connectionURL_(e,c,h,s,n),this.nodeAdmin=e.nodeAdmin}static connectionURL_(t,e,n,s,o){const c={};return c[p0]=cp,typeof location<"u"&&location.hostname&&y0.test(location.hostname)&&(c[m0]=_0),e&&(c[g0]=e),n&&(c[b0]=n),s&&(c[Rf]=s),o&&(c[v0]=o),w0(t,A0,c)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Rs.set("previous_websocket_failure",!0);try{let n;xC(),this.mySock=new Ic(this.connURL,[],n)}catch(n){this.log_("Error instantiating WebSocket.");const s=n.message||n.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=n=>{this.handleIncomingFrame(n)},this.mySock.onerror=n=>{this.log_("WebSocket error.  Closing connection.");const s=n.message||n.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){kn.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const e=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(e);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&Ic!==null&&!kn.forceDisallow_}static previouslyFailed(){return Rs.isInMemoryStorage||Rs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Rs.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const n=Do(e);this.onMessage(n)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(tt(this.frames===null,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(e);else{const n=this.extractFrameCount_(e);n!==null&&this.appendFrame_(n)}}send(t){this.resetKeepAlive();const e=xe(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=d0(e,Nx);n.length>1&&this.sendString_(String(n.length));for(let s=0;s<n.length;s++)this.sendString_(n[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Ox))}sendString_(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}kn.responsesRequiredToBeHealthy=2;kn.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{static get ALL_TRANSPORTS(){return[Fa,kn]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const e=kn&&kn.isAvailable();let n=e&&!kn.previouslyFailed();if(t.webSocketOnly&&(e||Ve("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[kn];else{const s=this.transports_=[];for(const o of Oo.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);Oo.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Oo.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx=6e4,Lx=5e3,Ix=10*1024,Px=100*1024,Zd="t",Ib="d",Bx="s",Pb="r",Fx="e",Bb="o",Fb="a",Hb="n",zb="p",Hx="h";class zx{constructor(t,e,n,s,o,c,h,d,f,g){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=s,this.authToken_=o,this.onMessage_=c,this.onReady_=h,this.onDisconnect_=d,this.onKill_=f,this.lastSessionId=g,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xo("c:"+this.id+":"),this.transportManager_=new Oo(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,n)},Math.floor(0));const s=t.healthyTimeout||0;s>0&&(this.healthyTimeout_=Ao(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Px?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>Ix?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){const e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(Zd in t){const e=t[Zd];e===Fb?this.upgradeIfSecondaryHealthy_():e===Pb?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):e===Bb&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=uo("t",t),n=uo("d",t);if(e==="c")this.onSecondaryControl_(n);else if(e==="d")this.pendingDataMessages.push(n);else throw new Error("Unknown protocol layer: "+e)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:zb,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Fb,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Hb,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=uo("t",t),n=uo("d",t);e==="c"?this.onControl_(n):e==="d"&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=uo(Zd,t);if(Ib in t){const n=t[Ib];if(e===Hx){const s={...n};this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(e===Hb){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else e===Bx?this.onConnectionShutdown_(n):e===Pb?this.onReset_(n):e===Fx?xf("Server Error: "+n):e===Bb?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):xf("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,n=t.v,s=t.h;this.sessionId=t.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),cp!==n&&Ve("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,n),Ao(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(kx))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ao(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Lx))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:zb,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Rs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{put(t,e,n,s){}merge(t,e,n,s){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,n){}onDisconnectMerge(t,e,n){}onDisconnectCancel(t,e){}reportStats(t){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(t){this.allowedEvents_=t,this.listeners_={},tt(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let s=0;s<n.length;s++)n[s].callback.apply(n[s].context,e)}}on(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});const s=this.getInitialEvent(t);s&&e.apply(n,s)}off(t,e,n){this.validateEventType_(t);const s=this.listeners_[t]||[];for(let o=0;o<s.length;o++)if(s[o].callback===e&&(!n||n===s[o].context)){s.splice(o,1);return}}validateEventType_(t){tt(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc extends N0{static getInstance(){return new Pc}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!t0()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return tt(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ub=32,jb=768;class zt{constructor(t,e){if(e===void 0){this.pieces_=t.split("/");let n=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[n]=this.pieces_[s],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)this.pieces_[e]!==""&&(t+="/"+this.pieces_[e]);return t||"/"}}function Bt(){return new zt("")}function Tt(r){return r.pieceNum_>=r.pieces_.length?null:r.pieces_[r.pieceNum_]}function ns(r){return r.pieces_.length-r.pieceNum_}function Xt(r){let t=r.pieceNum_;return t<r.pieces_.length&&t++,new zt(r.pieces_,t)}function dp(r){return r.pieceNum_<r.pieces_.length?r.pieces_[r.pieces_.length-1]:null}function Ux(r){let t="";for(let e=r.pieceNum_;e<r.pieces_.length;e++)r.pieces_[e]!==""&&(t+="/"+encodeURIComponent(String(r.pieces_[e])));return t||"/"}function ko(r,t=0){return r.pieces_.slice(r.pieceNum_+t)}function O0(r){if(r.pieceNum_>=r.pieces_.length)return null;const t=[];for(let e=r.pieceNum_;e<r.pieces_.length-1;e++)t.push(r.pieces_[e]);return new zt(t,0)}function ne(r,t){const e=[];for(let n=r.pieceNum_;n<r.pieces_.length;n++)e.push(r.pieces_[n]);if(t instanceof zt)for(let n=t.pieceNum_;n<t.pieces_.length;n++)e.push(t.pieces_[n]);else{const n=t.split("/");for(let s=0;s<n.length;s++)n[s].length>0&&e.push(n[s])}return new zt(e,0)}function Dt(r){return r.pieceNum_>=r.pieces_.length}function en(r,t){const e=Tt(r),n=Tt(t);if(e===null)return t;if(e===n)return en(Xt(r),Xt(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+r+")")}function jx(r,t){const e=ko(r,0),n=ko(t,0);for(let s=0;s<e.length&&s<n.length;s++){const o=js(e[s],n[s]);if(o!==0)return o}return e.length===n.length?0:e.length<n.length?-1:1}function fp(r,t){if(ns(r)!==ns(t))return!1;for(let e=r.pieceNum_,n=t.pieceNum_;e<=r.pieces_.length;e++,n++)if(r.pieces_[e]!==t.pieces_[n])return!1;return!0}function xn(r,t){let e=r.pieceNum_,n=t.pieceNum_;if(ns(r)>ns(t))return!1;for(;e<r.pieces_.length;){if(r.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0}class Gx{constructor(t,e){this.errorPrefix_=e,this.parts_=ko(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=au(this.parts_[n]);k0(this)}}function qx(r,t){r.parts_.length>0&&(r.byteLength_+=1),r.parts_.push(t),r.byteLength_+=au(t),k0(r)}function Vx(r){const t=r.parts_.pop();r.byteLength_-=au(t),r.parts_.length>0&&(r.byteLength_-=1)}function k0(r){if(r.byteLength_>jb)throw new Error(r.errorPrefix_+"has a key path longer than "+jb+" bytes ("+r.byteLength_+").");if(r.parts_.length>Ub)throw new Error(r.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Ub+") or object contains a cycle "+Ts(r))}function Ts(r){return r.parts_.length===0?"":"in property '"+r.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp extends N0{static getInstance(){return new pp}constructor(){super(["visible"]);let t,e;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const n=!document[t];n!==this.visible_&&(this.visible_=n,this.trigger("visible",n))},!1)}getInitialEvent(t){return tt(t==="visible","Unknown event type: "+t),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho=1e3,Yx=300*1e3,Gb=30*1e3,Xx=1.3,$x=3e4,Wx="server_kill",qb=3;class Ai extends M0{constructor(t,e,n,s,o,c,h,d){if(super(),this.repoInfo_=t,this.applicationId_=e,this.onDataUpdate_=n,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=c,this.appCheckTokenProvider_=h,this.authOverride_=d,this.id=Ai.nextPersistentConnectionId_++,this.log_=Xo("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ho,this.maxReconnectDelay_=Yx,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,d)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");pp.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&Pc.getInstance().on("online",this.onOnline_,this)}sendRequest(t,e,n){const s=++this.requestNumber_,o={r:s,a:t,b:e};this.log_(xe(o)),tt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),n&&(this.requestCBHash_[s]=n)}get(t){this.initConnection_();const e=new Jn,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:c=>{const h=c.d;c.s==="ok"?e.resolve(h):e.reject(h)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),e.promise}listen(t,e,n,s){this.initConnection_();const o=t._queryIdentifier,c=t._path.toString();this.log_("Listen called for "+c+" "+o),this.listens.has(c)||this.listens.set(c,new Map),tt(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),tt(!this.listens.get(c).has(o),"listen() called twice for same path/queryId.");const h={onComplete:s,hashFn:e,query:t,tag:n};this.listens.get(c).set(o,h),this.connected_&&this.sendListen_(h)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(n)})}sendListen_(t){const e=t.query,n=e._path.toString(),s=e._queryIdentifier;this.log_("Listen on "+n+" for "+s);const o={p:n},c="q";t.tag&&(o.q=e._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest(c,o,h=>{const d=h.d,f=h.s;Ai.warnOnListenWarnings_(d,e),(this.listens.get(n)&&this.listens.get(n).get(s))===t&&(this.log_("listen response",h),f!=="ok"&&this.removeListen_(n,s),t.onComplete&&t.onComplete(f,d))})}static warnOnListenWarnings_(t,e){if(t&&typeof t=="object"&&ei(t,"w")){const n=$a(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const s='".indexOn": "'+e._queryParams.getIndex().toString()+'"',o=e._path.toString();Ve(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||LC(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Gb)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=kC(t)?"auth":"gauth",n={cred:t};this.authOverride_===null?n.noauth=!0:typeof this.authOverride_=="object"&&(n.authvar=this.authOverride_),this.sendRequest(e,n,s=>{const o=s.s,c=s.d||"error";this.authToken_===t&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const e=t.s,n=t.d||"error";e==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,n)})}unlisten(t,e){const n=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+s),tt(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,s)&&this.connected_&&this.sendUnlisten_(n,s,t._queryObject,e)}sendUnlisten_(t,e,n,s){this.log_("Unlisten on "+t+" for "+e);const o={p:t},c="n";s&&(o.q=n,o.t=s),this.sendRequest(c,o)}onDisconnectPut(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})}onDisconnectMerge(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,n,s){const o={p:e,d:n};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,c=>{s&&setTimeout(()=>{s(c.s,c.d)},Math.floor(0))})}put(t,e,n,s){this.putInternal("p",t,e,n,s)}merge(t,e,n,s){this.putInternal("m",t,e,n,s)}putInternal(t,e,n,s,o){this.initConnection_();const c={p:e,d:n};o!==void 0&&(c.h=o),this.outstandingPuts_.push({action:t,request:c,onComplete:s}),this.outstandingPutCount_++;const h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,n,o=>{this.log_(e+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,n=>{if(n.s!=="ok"){const o=n.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+xe(t));const e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),t==="d"?this.onDataUpdate_(e.p,e.d,!1,e.t):t==="m"?this.onDataUpdate_(e.p,e.d,!0,e.t):t==="c"?this.onListenRevoked_(e.p,e.q):t==="ac"?this.onAuthRevoked_(e.s,e.d):t==="apc"?this.onAppCheckRevoked_(e.s,e.d):t==="sd"?this.onSecurityDebugPacket_(e):xf("Unrecognized action received from server: "+xe(t)+`
Are you using the latest client?`)}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){tt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ho,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ho,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>$x&&(this.reconnectDelay_=ho),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Xx)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),e=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Ai.nextConnectionId_++,o=this.lastSessionId;let c=!1,h=null;const d=function(){h?h.close():(c=!0,n())},f=function(_){tt(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(_)};this.realtime_={close:d,sendRequest:f};const g=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[_,y]=await Promise.all([this.authTokenProvider_.getToken(g),this.appCheckTokenProvider_.getToken(g)]);c?Te("getToken() completed but was canceled"):(Te("getToken() completed. Creating connection."),this.authToken_=_&&_.accessToken,this.appCheckToken_=y&&y.token,h=new zx(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,e,n,b=>{Ve(b+" ("+this.repoInfo_.toString()+")"),this.interrupt(Wx)},o))}catch(_){this.log_("Failed to get token: "+_),c||(this.repoInfo_.nodeAdmin&&Ve(_),d())}}}interrupt(t){Te("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Te("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Af(this.interruptReasons_)&&(this.reconnectDelay_=ho,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let n;e?n=e.map(o=>lp(o)).join("$"):n="default";const s=this.removeListen_(t,n);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,e){const n=new zt(t).toString();let s;if(this.listens.has(n)){const o=this.listens.get(n);s=o.get(e),o.delete(e),o.size===0&&this.listens.delete(n)}else s=void 0;return s}onAuthRevoked_(t,e){Te("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=qb&&(this.reconnectDelay_=Gb,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){Te("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=qb&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";t["sdk."+e+"."+c0.replace(/\./g,"-")]=1,t0()?t["framework.cordova"]=1:TC()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=Pc.getInstance().currentlyOnline();return Af(this.interruptReasons_)&&t}}Ai.nextPersistentConnectionId_=0;Ai.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new Mt(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const n=new Mt(Ka,t),s=new Mt(Ka,e);return this.compare(n,s)!==0}minPost(){return Mt.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bc;class L0 extends ou{static get __EMPTY_NODE(){return bc}static set __EMPTY_NODE(t){bc=t}compare(t,e){return js(t.name,e.name)}isDefinedOn(t){throw er("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return Mt.MIN}maxPost(){return new Mt(Is,bc)}makePost(t,e){return tt(typeof t=="string","KeyIndex indexValue must always be a string."),new Mt(t,bc)}toString(){return".key"}}const qa=new L0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(t,e,n,s,o=null){this.isReverse_=s,this.resultGenerator_=o,this.nodeStack_=[];let c=1;for(;!t.isEmpty();)if(t=t,c=e?n(t.key,e):1,s&&(c*=-1),c<0)this.isReverse_?t=t.left:t=t.right;else if(c===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),e;if(this.resultGenerator_?e=this.resultGenerator_(t.key,t.value):e={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class Ce{constructor(t,e,n,s,o){this.key=t,this.value=e,this.color=n??Ce.RED,this.left=s??nn.EMPTY_NODE,this.right=o??nn.EMPTY_NODE}copy(t,e,n,s,o){return new Ce(t??this.key,e??this.value,n??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let s=this;const o=n(t,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(t,e,n),null):o===0?s=s.copy(null,e,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,e,n)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return nn.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let n,s;if(n=this,e(t,n.key)<0)!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()&&(n=n.moveRedRight_()),e(t,n.key)===0){if(n.right.isEmpty())return nn.EMPTY_NODE;s=n.right.min_(),n=n.copy(s.key,s.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,Ce.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,Ce.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}Ce.RED=!0;Ce.BLACK=!1;class Kx{copy(t,e,n,s,o){return this}insert(t,e,n){return new Ce(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class nn{constructor(t,e=nn.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new nn(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,Ce.BLACK,null,null))}remove(t){return new nn(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Ce.BLACK,null,null))}get(t){let e,n=this.root_;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),e===0)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null}getPredecessorKey(t){let e,n=this.root_,s=null;for(;!n.isEmpty();)if(e=this.comparator_(t,n.key),e===0){if(n.left.isEmpty())return s?s.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}else e<0?n=n.left:e>0&&(s=n,n=n.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new vc(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new vc(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new vc(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new vc(this.root_,null,this.comparator_,!0,t)}}nn.EMPTY_NODE=new Kx;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qx(r,t){return js(r.name,t.name)}function gp(r,t){return js(r,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Df;function Zx(r){Df=r}const I0=function(r){return typeof r=="number"?"number:"+f0(r):"string:"+r},P0=function(r){if(r.isLeafNode()){const t=r.val();tt(typeof t=="string"||typeof t=="number"||typeof t=="object"&&ei(t,".sv"),"Priority must be a string or number.")}else tt(r===Df||r.isEmpty(),"priority of unexpected type.");tt(r===Df||r.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vb;class we{static set __childrenNodeConstructor(t){Vb=t}static get __childrenNodeConstructor(){return Vb}constructor(t,e=we.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=e,this.lazyHash_=null,tt(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),P0(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new we(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:we.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Dt(t)?this:Tt(t)===".priority"?this.priorityNode_:we.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(t,e){return t===".priority"?this.updatePriority(e):e.isEmpty()&&t!==".priority"?this:we.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)}updateChild(t,e){const n=Tt(t);return n===null?e:e.isEmpty()&&n!==".priority"?this:(tt(n!==".priority"||ns(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(n,we.__childrenNodeConstructor.EMPTY_NODE.updateChild(Xt(t),e)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+I0(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",e==="number"?t+=f0(this.value_):t+=this.value_,this.lazyHash_=h0(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===we.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof we.__childrenNodeConstructor?-1:(tt(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const e=typeof t.value_,n=typeof this.value_,s=we.VALUE_TYPE_ORDER.indexOf(e),o=we.VALUE_TYPE_ORDER.indexOf(n);return tt(s>=0,"Unknown leaf type: "+e),tt(o>=0,"Unknown leaf type: "+n),s===o?n==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}else return!1}}we.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let B0,F0;function Jx(r){B0=r}function tR(r){F0=r}class eR extends ou{compare(t,e){const n=t.node.getPriority(),s=e.node.getPriority(),o=n.compareTo(s);return o===0?js(t.name,e.name):o}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return Mt.MIN}maxPost(){return new Mt(Is,new we("[PRIORITY-POST]",F0))}makePost(t,e){const n=B0(t);return new Mt(e,new we("[PRIORITY-POST]",n))}toString(){return".priority"}}const ie=new eR;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=Math.log(2);class iR{constructor(t){const e=o=>parseInt(Math.log(o)/nR,10),n=o=>parseInt(Array(o+1).join("1"),2);this.count=e(t+1),this.current_=this.count-1;const s=n(this.count);this.bits_=t+1&s}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Bc=function(r,t,e,n){r.sort(t);const s=function(d,f){const g=f-d;let _,y;if(g===0)return null;if(g===1)return _=r[d],y=e?e(_):_,new Ce(y,_.node,Ce.BLACK,null,null);{const b=parseInt(g/2,10)+d,A=s(d,b),S=s(b+1,f);return _=r[b],y=e?e(_):_,new Ce(y,_.node,Ce.BLACK,A,S)}},o=function(d){let f=null,g=null,_=r.length;const y=function(A,S){const w=_-A,C=_;_-=A;const D=s(w+1,C),x=r[w],I=e?e(x):x;b(new Ce(I,x.node,S,null,D))},b=function(A){f?(f.left=A,f=A):(g=A,f=A)};for(let A=0;A<d.count;++A){const S=d.nextBitIsOne(),w=Math.pow(2,d.count-(A+1));S?y(w,Ce.BLACK):(y(w,Ce.BLACK),y(w,Ce.RED))}return g},c=new iR(r.length),h=o(c);return new nn(n||t,h)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jd;const Na={};class vi{static get Default(){return tt(Na&&ie,"ChildrenNode.ts has not been loaded"),Jd=Jd||new vi({".priority":Na},{".priority":ie}),Jd}constructor(t,e){this.indexes_=t,this.indexSet_=e}get(t){const e=$a(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof nn?e:null}hasIndex(t){return ei(this.indexSet_,t.toString())}addIndex(t,e){tt(t!==qa,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let s=!1;const o=e.getIterator(Mt.Wrap);let c=o.getNext();for(;c;)s=s||t.isDefinedOn(c.node),n.push(c),c=o.getNext();let h;s?h=Bc(n,t.getCompare()):h=Na;const d=t.toString(),f={...this.indexSet_};f[d]=t;const g={...this.indexes_};return g[d]=h,new vi(g,f)}addToIndexes(t,e){const n=Nc(this.indexes_,(s,o)=>{const c=$a(this.indexSet_,o);if(tt(c,"Missing index implementation for "+o),s===Na)if(c.isDefinedOn(t.node)){const h=[],d=e.getIterator(Mt.Wrap);let f=d.getNext();for(;f;)f.name!==t.name&&h.push(f),f=d.getNext();return h.push(t),Bc(h,c.getCompare())}else return Na;else{const h=e.get(t.name);let d=s;return h&&(d=d.remove(new Mt(t.name,h))),d.insert(t,t.node)}});return new vi(n,this.indexSet_)}removeFromIndexes(t,e){const n=Nc(this.indexes_,s=>{if(s===Na)return s;{const o=e.get(t.name);return o?s.remove(new Mt(t.name,o)):s}});return new vi(n,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fo;class yt{static get EMPTY_NODE(){return fo||(fo=new yt(new nn(gp),null,vi.Default))}constructor(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&P0(this.priorityNode_),this.children_.isEmpty()&&tt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||fo}updatePriority(t){return this.children_.isEmpty()?this:new yt(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const e=this.children_.get(t);return e===null?fo:e}}getChild(t){const e=Tt(t);return e===null?this:this.getImmediateChild(e).getChild(Xt(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,e){if(tt(e,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(e);{const n=new Mt(t,e);let s,o;e.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(n,this.children_)):(s=this.children_.insert(t,e),o=this.indexMap_.addToIndexes(n,this.children_));const c=s.isEmpty()?fo:this.priorityNode_;return new yt(s,c,o)}}updateChild(t,e){const n=Tt(t);if(n===null)return e;{tt(Tt(t)!==".priority"||ns(t)===1,".priority must be the last token in a path");const s=this.getImmediateChild(n).updateChild(Xt(t),e);return this.updateImmediateChild(n,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const e={};let n=0,s=0,o=!0;if(this.forEachChild(ie,(c,h)=>{e[c]=h.val(t),n++,o&&yt.INTEGER_REGEXP_.test(c)?s=Math.max(s,Number(c)):o=!1}),!t&&o&&s<2*n){const c=[];for(const h in e)c[h]=e[h];return c}else return t&&!this.getPriority().isEmpty()&&(e[".priority"]=this.getPriority().val()),e}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+I0(this.getPriority().val())+":"),this.forEachChild(ie,(e,n)=>{const s=n.hash();s!==""&&(t+=":"+e+":"+s)}),this.lazyHash_=t===""?"":h0(t)}return this.lazyHash_}getPredecessorChildName(t,e,n){const s=this.resolveIndex_(n);if(s){const o=s.getPredecessorKey(new Mt(t,e));return o?o.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const n=e.minKey();return n&&n.name}else return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new Mt(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const n=e.maxKey();return n&&n.name}else return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new Mt(e,this.children_.get(e)):null}forEachChild(t,e){const n=this.resolveIndex_(t);return n?n.inorderTraversal(s=>e(s.name,s.node)):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,Mt.Wrap);let o=s.peek();for(;o!=null&&e.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,Mt.Wrap);let o=s.peek();for(;o!=null&&e.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===$o?-1:0}withIndex(t){if(t===qa||this.indexMap_.hasIndex(t))return this;{const e=this.indexMap_.addIndex(t,this.children_);return new yt(this.children_,this.priorityNode_,e)}}isIndexed(t){return t===qa||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority()))if(this.children_.count()===e.children_.count()){const n=this.getIterator(ie),s=e.getIterator(ie);let o=n.getNext(),c=s.getNext();for(;o&&c;){if(o.name!==c.name||!o.node.equals(c.node))return!1;o=n.getNext(),c=s.getNext()}return o===null&&c===null}else return!1;else return!1}}resolveIndex_(t){return t===qa?null:this.indexMap_.get(t.toString())}}yt.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class sR extends yt{constructor(){super(new nn(gp),yt.EMPTY_NODE,vi.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return yt.EMPTY_NODE}isEmpty(){return!1}}const $o=new sR;Object.defineProperties(Mt,{MIN:{value:new Mt(Ka,yt.EMPTY_NODE)},MAX:{value:new Mt(Is,$o)}});L0.__EMPTY_NODE=yt.EMPTY_NODE;we.__childrenNodeConstructor=yt;Zx($o);tR($o);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR=!0;function ce(r,t=null){if(r===null)return yt.EMPTY_NODE;if(typeof r=="object"&&".priority"in r&&(t=r[".priority"]),tt(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof r=="object"&&".value"in r&&r[".value"]!==null&&(r=r[".value"]),typeof r!="object"||".sv"in r){const e=r;return new we(e,ce(t))}if(!(r instanceof Array)&&aR){const e=[];let n=!1;if(Re(r,(c,h)=>{if(c.substring(0,1)!=="."){const d=ce(h);d.isEmpty()||(n=n||!d.getPriority().isEmpty(),e.push(new Mt(c,d)))}}),e.length===0)return yt.EMPTY_NODE;const o=Bc(e,Qx,c=>c.name,gp);if(n){const c=Bc(e,ie.getCompare());return new yt(o,ce(t),new vi({".priority":c},{".priority":ie}))}else return new yt(o,ce(t),vi.Default)}else{let e=yt.EMPTY_NODE;return Re(r,(n,s)=>{if(ei(r,n)&&n.substring(0,1)!=="."){const o=ce(s);(o.isLeafNode()||!o.isEmpty())&&(e=e.updateImmediateChild(n,o))}}),e.updatePriority(ce(t))}}Jx(ce);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR extends ou{constructor(t){super(),this.indexPath_=t,tt(!Dt(t)&&Tt(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const n=this.extractChild(t.node),s=this.extractChild(e.node),o=n.compareTo(s);return o===0?js(t.name,e.name):o}makePost(t,e){const n=ce(t),s=yt.EMPTY_NODE.updateChild(this.indexPath_,n);return new Mt(e,s)}maxPost(){const t=yt.EMPTY_NODE.updateChild(this.indexPath_,$o);return new Mt(Is,t)}toString(){return ko(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR extends ou{compare(t,e){const n=t.node.compareTo(e.node);return n===0?js(t.name,e.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return Mt.MIN}maxPost(){return Mt.MAX}makePost(t,e){const n=ce(t);return new Mt(e,n)}toString(){return".value"}}const lR=new oR;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(r){return{type:"value",snapshotNode:r}}function Qa(r,t){return{type:"child_added",snapshotNode:t,childName:r}}function Lo(r,t){return{type:"child_removed",snapshotNode:t,childName:r}}function Io(r,t,e){return{type:"child_changed",snapshotNode:t,childName:r,oldSnap:e}}function cR(r,t){return{type:"child_moved",snapshotNode:t,childName:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(t){this.index_=t}updateChild(t,e,n,s,o,c){tt(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const h=t.getImmediateChild(e);return h.getChild(s).equals(n.getChild(s))&&h.isEmpty()===n.isEmpty()||(c!=null&&(n.isEmpty()?t.hasChild(e)?c.trackChildChange(Lo(e,h)):tt(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):h.isEmpty()?c.trackChildChange(Qa(e,n)):c.trackChildChange(Io(e,n,h))),t.isLeafNode()&&n.isEmpty())?t:t.updateImmediateChild(e,n).withIndex(this.index_)}updateFullNode(t,e,n){return n!=null&&(t.isLeafNode()||t.forEachChild(ie,(s,o)=>{e.hasChild(s)||n.trackChildChange(Lo(s,o))}),e.isLeafNode()||e.forEachChild(ie,(s,o)=>{if(t.hasChild(s)){const c=t.getImmediateChild(s);c.equals(o)||n.trackChildChange(Io(s,o,c))}else n.trackChildChange(Qa(s,o))})),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?yt.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Po{constructor(t){this.indexedFilter_=new mp(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Po.getStartPost_(t),this.endPost_=Po.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,n=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&n}updateChild(t,e,n,s,o,c){return this.matches(new Mt(e,n))||(n=yt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,s,o,c)}updateFullNode(t,e,n){e.isLeafNode()&&(e=yt.EMPTY_NODE);let s=e.withIndex(this.index_);s=s.updatePriority(yt.EMPTY_NODE);const o=this;return e.forEachChild(ie,(c,h)=>{o.matches(new Mt(c,h))||(s=s.updateImmediateChild(c,yt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,s,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}else return t.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(t){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const n=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?n<=0:n<0},this.withinEndPost=e=>{const n=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?n<=0:n<0},this.rangedFilter_=new Po(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,n,s,o,c){return this.rangedFilter_.matches(new Mt(e,n))||(n=yt.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,s,o,c):this.fullLimitUpdateChild_(t,e,n,o,c)}updateFullNode(t,e,n){let s;if(e.isLeafNode()||e.isEmpty())s=yt.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<e.numChildren()&&e.isIndexed(this.index_)){s=yt.EMPTY_NODE.withIndex(this.index_);let o;this.reverse_?o=e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):o=e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;o.hasNext()&&c<this.limit_;){const h=o.getNext();if(this.withinDirectionalStart(h))if(this.withinDirectionalEnd(h))s=s.updateImmediateChild(h.name,h.node),c++;else break;else continue}}else{s=e.withIndex(this.index_),s=s.updatePriority(yt.EMPTY_NODE);let o;this.reverse_?o=s.getReverseIterator(this.index_):o=s.getIterator(this.index_);let c=0;for(;o.hasNext();){const h=o.getNext();c<this.limit_&&this.withinDirectionalStart(h)&&this.withinDirectionalEnd(h)?c++:s=s.updateImmediateChild(h.name,yt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,s,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,n,s,o){let c;if(this.reverse_){const _=this.index_.getCompare();c=(y,b)=>_(b,y)}else c=this.index_.getCompare();const h=t;tt(h.numChildren()===this.limit_,"");const d=new Mt(e,n),f=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),g=this.rangedFilter_.matches(d);if(h.hasChild(e)){const _=h.getImmediateChild(e);let y=s.getChildAfterChild(this.index_,f,this.reverse_);for(;y!=null&&(y.name===e||h.hasChild(y.name));)y=s.getChildAfterChild(this.index_,y,this.reverse_);const b=y==null?1:c(y,d);if(g&&!n.isEmpty()&&b>=0)return o?.trackChildChange(Io(e,n,_)),h.updateImmediateChild(e,n);{o?.trackChildChange(Lo(e,_));const S=h.updateImmediateChild(e,yt.EMPTY_NODE);return y!=null&&this.rangedFilter_.matches(y)?(o?.trackChildChange(Qa(y.name,y.node)),S.updateImmediateChild(y.name,y.node)):S}}else return n.isEmpty()?t:g&&c(f,d)>=0?(o!=null&&(o.trackChildChange(Lo(f.name,f.node)),o.trackChildChange(Qa(e,n))),h.updateImmediateChild(e,n).updateImmediateChild(f.name,yt.EMPTY_NODE)):t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ie}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return tt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return tt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Ka}hasEnd(){return this.endSet_}getIndexEndValue(){return tt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return tt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Is}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return tt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ie}copy(){const t=new _p;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function hR(r){return r.loadsAllData()?new mp(r.getIndex()):r.hasLimit()?new uR(r):new Po(r)}function Yb(r){const t={};if(r.isDefault())return t;let e;if(r.index_===ie?e="$priority":r.index_===lR?e="$value":r.index_===qa?e="$key":(tt(r.index_ instanceof rR,"Unrecognized index type!"),e=r.index_.toString()),t.orderBy=xe(e),r.startSet_){const n=r.startAfterSet_?"startAfter":"startAt";t[n]=xe(r.indexStartValue_),r.startNameSet_&&(t[n]+=","+xe(r.indexStartName_))}if(r.endSet_){const n=r.endBeforeSet_?"endBefore":"endAt";t[n]=xe(r.indexEndValue_),r.endNameSet_&&(t[n]+=","+xe(r.indexEndName_))}return r.limitSet_&&(r.isViewFromLeft()?t.limitToFirst=r.limit_:t.limitToLast=r.limit_),t}function Xb(r){const t={};if(r.startSet_&&(t.sp=r.indexStartValue_,r.startNameSet_&&(t.sn=r.indexStartName_),t.sin=!r.startAfterSet_),r.endSet_&&(t.ep=r.indexEndValue_,r.endNameSet_&&(t.en=r.indexEndName_),t.ein=!r.endBeforeSet_),r.limitSet_){t.l=r.limit_;let e=r.viewFrom_;e===""&&(r.isViewFromLeft()?e="l":e="r"),t.vf=e}return r.index_!==ie&&(t.i=r.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc extends M0{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return e!==void 0?"tag$"+e:(tt(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,e,n,s){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=n,this.appCheckTokenProvider_=s,this.log_=Xo("p:rest:"),this.listens_={}}listen(t,e,n,s){const o=t._path.toString();this.log_("Listen called for "+o+" "+t._queryIdentifier);const c=Fc.getListenId_(t,n),h={};this.listens_[c]=h;const d=Yb(t._queryParams);this.restRequest_(o+".json",d,(f,g)=>{let _=g;if(f===404&&(_=null,f=null),f===null&&this.onDataUpdate_(o,_,!1,n),$a(this.listens_,c)===h){let y;f?f===401?y="permission_denied":y="rest_error:"+f:y="ok",s(y,null)}})}unlisten(t,e){const n=Fc.getListenId_(t,e);delete this.listens_[n]}get(t){const e=Yb(t._queryParams),n=t._path.toString(),s=new Jn;return this.restRequest_(n+".json",e,(o,c)=>{let h=c;o===404&&(h=null,o=null),o===null?(this.onDataUpdate_(n,h,!1,null),s.resolve(h)):s.reject(new Error(h))}),s.promise}refreshAuthToken(t){}restRequest_(t,e={},n){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,o])=>{s&&s.accessToken&&(e.auth=s.accessToken),o&&o.token&&(e.ac=o.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+IC(e);this.log_("Sending REST request for "+c);const h=new XMLHttpRequest;h.onreadystatechange=()=>{if(n&&h.readyState===4){this.log_("REST Response for "+c+" received. status:",h.status,"response:",h.responseText);let d=null;if(h.status>=200&&h.status<300){try{d=Do(h.responseText)}catch{Ve("Failed to parse JSON response for "+c+": "+h.responseText)}n(null,d)}else h.status!==401&&h.status!==404&&Ve("Got unsuccessful REST response for "+c+" Status: "+h.status),n(h.status);n=null}},h.open("GET",c,!0),h.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(){this.rootNode_=yt.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(){return{value:null,children:new Map}}function ir(r,t,e){if(Dt(t))r.value=e,r.children.clear();else if(r.value!==null)r.value=r.value.updateChild(t,e);else{const n=Tt(t);r.children.has(n)||r.children.set(n,Hc());const s=r.children.get(n);t=Xt(t),ir(s,t,e)}}function Mf(r,t){if(Dt(t))return r.value=null,r.children.clear(),!0;if(r.value!==null){if(r.value.isLeafNode())return!1;{const e=r.value;return r.value=null,e.forEachChild(ie,(n,s)=>{ir(r,new zt(n),s)}),Mf(r,t)}}else if(r.children.size>0){const e=Tt(t);return t=Xt(t),r.children.has(e)&&Mf(r.children.get(e),t)&&r.children.delete(e),r.children.size===0}else return!0}function Nf(r,t,e){r.value!==null?e(t,r.value):fR(r,(n,s)=>{const o=new zt(t.toString()+"/"+n);Nf(s,o,e)})}function fR(r,t){r.children.forEach((e,n)=>{t(n,e)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e={...t};return this.last_&&Re(this.last_,(n,s)=>{e[n]=e[n]-s}),this.last_=t,e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $b=10*1e3,gR=30*1e3,mR=300*1e3;class _R{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new pR(t);const n=$b+(gR-$b)*Math.random();Ao(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),e={};let n=!1;Re(t,(s,o)=>{o>0&&ei(this.statsToReport_,s)&&(e[s]=o,n=!0)}),n&&this.server_.reportStats(e),Ao(this.reportStats_.bind(this),Math.floor(Math.random()*2*mR))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ln;(function(r){r[r.OVERWRITE=0]="OVERWRITE",r[r.MERGE=1]="MERGE",r[r.ACK_USER_WRITE=2]="ACK_USER_WRITE",r[r.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ln||(Ln={}));function yp(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function bp(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function vp(r){return{fromUser:!1,fromServer:!0,queryId:r,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zc{constructor(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Ln.ACK_USER_WRITE,this.source=yp()}operationForChild(t){if(Dt(this.path)){if(this.affectedTree.value!=null)return tt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new zt(t));return new zc(Bt(),e,this.revert)}}else return tt(Tt(this.path)===t,"operationForChild called for unrelated child."),new zc(Xt(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(t,e){this.source=t,this.path=e,this.type=Ln.LISTEN_COMPLETE}operationForChild(t){return Dt(this.path)?new Bo(this.source,Bt()):new Bo(this.source,Xt(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Ln.OVERWRITE}operationForChild(t){return Dt(this.path)?new Ps(this.source,Bt(),this.snap.getImmediateChild(t)):new Ps(this.source,Xt(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Ln.MERGE}operationForChild(t){if(Dt(this.path)){const e=this.children.subtree(new zt(t));return e.isEmpty()?null:e.value?new Ps(this.source,Bt(),e.value):new Za(this.source,Bt(),e)}else return tt(Tt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Za(this.source,Xt(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Dt(t))return this.isFullyInitialized()&&!this.filtered_;const e=Tt(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function bR(r,t,e,n){const s=[],o=[];return t.forEach(c=>{c.type==="child_changed"&&r.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&o.push(cR(c.childName,c.snapshotNode))}),po(r,s,"child_removed",t,n,e),po(r,s,"child_added",t,n,e),po(r,s,"child_moved",o,n,e),po(r,s,"child_changed",t,n,e),po(r,s,"value",t,n,e),s}function po(r,t,e,n,s,o){const c=n.filter(h=>h.type===e);c.sort((h,d)=>AR(r,h,d)),c.forEach(h=>{const d=vR(r,h,o);s.forEach(f=>{f.respondsTo(h.type)&&t.push(f.createEvent(d,r.query_))})})}function vR(r,t,e){return t.type==="value"||t.type==="child_removed"||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,r.index_)),t}function AR(r,t,e){if(t.childName==null||e.childName==null)throw er("Should only compare child_ events.");const n=new Mt(t.childName,t.snapshotNode),s=new Mt(e.childName,e.snapshotNode);return r.index_.compare(n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lu(r,t){return{eventCache:r,serverCache:t}}function So(r,t,e,n){return lu(new Bs(t,e,n),r.serverCache)}function z0(r,t,e,n){return lu(r.eventCache,new Bs(t,e,n))}function Of(r){return r.eventCache.isFullyInitialized()?r.eventCache.getNode():null}function Fs(r){return r.serverCache.isFullyInitialized()?r.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tf;const SR=()=>(tf||(tf=new nn(rx)),tf);class Wt{static fromObject(t){let e=new Wt(null);return Re(t,(n,s)=>{e=e.set(new zt(n),s)}),e}constructor(t,e=SR()){this.value=t,this.children=e}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(this.value!=null&&e(this.value))return{path:Bt(),value:this.value};if(Dt(t))return null;{const n=Tt(t),s=this.children.get(n);if(s!==null){const o=s.findRootMostMatchingPathAndValue(Xt(t),e);return o!=null?{path:ne(new zt(n),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Dt(t))return this;{const e=Tt(t),n=this.children.get(e);return n!==null?n.subtree(Xt(t)):new Wt(null)}}set(t,e){if(Dt(t))return new Wt(e,this.children);{const n=Tt(t),o=(this.children.get(n)||new Wt(null)).set(Xt(t),e),c=this.children.insert(n,o);return new Wt(this.value,c)}}remove(t){if(Dt(t))return this.children.isEmpty()?new Wt(null):new Wt(null,this.children);{const e=Tt(t),n=this.children.get(e);if(n){const s=n.remove(Xt(t));let o;return s.isEmpty()?o=this.children.remove(e):o=this.children.insert(e,s),this.value===null&&o.isEmpty()?new Wt(null):new Wt(this.value,o)}else return this}}get(t){if(Dt(t))return this.value;{const e=Tt(t),n=this.children.get(e);return n?n.get(Xt(t)):null}}setTree(t,e){if(Dt(t))return e;{const n=Tt(t),o=(this.children.get(n)||new Wt(null)).setTree(Xt(t),e);let c;return o.isEmpty()?c=this.children.remove(n):c=this.children.insert(n,o),new Wt(this.value,c)}}fold(t){return this.fold_(Bt(),t)}fold_(t,e){const n={};return this.children.inorderTraversal((s,o)=>{n[s]=o.fold_(ne(t,s),e)}),e(t,this.value,n)}findOnPath(t,e){return this.findOnPath_(t,Bt(),e)}findOnPath_(t,e,n){const s=this.value?n(e,this.value):!1;if(s)return s;if(Dt(t))return null;{const o=Tt(t),c=this.children.get(o);return c?c.findOnPath_(Xt(t),ne(e,o),n):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,Bt(),e)}foreachOnPath_(t,e,n){if(Dt(t))return this;{this.value&&n(e,this.value);const s=Tt(t),o=this.children.get(s);return o?o.foreachOnPath_(Xt(t),ne(e,s),n):new Wt(null)}}foreach(t){this.foreach_(Bt(),t)}foreach_(t,e){this.children.inorderTraversal((n,s)=>{s.foreach_(ne(t,n),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,n)=>{n.value&&t(e,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(t){this.writeTree_=t}static empty(){return new In(new Wt(null))}}function Eo(r,t,e){if(Dt(t))return new In(new Wt(e));{const n=r.writeTree_.findRootMostValueAndPath(t);if(n!=null){const s=n.path;let o=n.value;const c=en(s,t);return o=o.updateChild(c,e),new In(r.writeTree_.set(s,o))}else{const s=new Wt(e),o=r.writeTree_.setTree(t,s);return new In(o)}}}function kf(r,t,e){let n=r;return Re(e,(s,o)=>{n=Eo(n,ne(t,s),o)}),n}function Wb(r,t){if(Dt(t))return In.empty();{const e=r.writeTree_.setTree(t,new Wt(null));return new In(e)}}function Lf(r,t){return Gs(r,t)!=null}function Gs(r,t){const e=r.writeTree_.findRootMostValueAndPath(t);return e!=null?r.writeTree_.get(e.path).getChild(en(e.path,t)):null}function Kb(r){const t=[],e=r.writeTree_.value;return e!=null?e.isLeafNode()||e.forEachChild(ie,(n,s)=>{t.push(new Mt(n,s))}):r.writeTree_.children.inorderTraversal((n,s)=>{s.value!=null&&t.push(new Mt(n,s.value))}),t}function Ji(r,t){if(Dt(t))return r;{const e=Gs(r,t);return e!=null?new In(new Wt(e)):new In(r.writeTree_.subtree(t))}}function If(r){return r.writeTree_.isEmpty()}function Ja(r,t){return U0(Bt(),r.writeTree_,t)}function U0(r,t,e){if(t.value!=null)return e.updateChild(r,t.value);{let n=null;return t.children.inorderTraversal((s,o)=>{s===".priority"?(tt(o.value!==null,"Priority writes must always be leaf nodes"),n=o.value):e=U0(ne(r,s),o,e)}),!e.getChild(r).isEmpty()&&n!==null&&(e=e.updateChild(ne(r,".priority"),n)),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ap(r,t){return V0(t,r)}function ER(r,t,e,n,s){tt(n>r.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),r.allWrites.push({path:t,snap:e,writeId:n,visible:s}),s&&(r.visibleWrites=Eo(r.visibleWrites,t,e)),r.lastWriteId=n}function wR(r,t,e,n){tt(n>r.lastWriteId,"Stacking an older merge on top of newer ones"),r.allWrites.push({path:t,children:e,writeId:n,visible:!0}),r.visibleWrites=kf(r.visibleWrites,t,e),r.lastWriteId=n}function CR(r,t){for(let e=0;e<r.allWrites.length;e++){const n=r.allWrites[e];if(n.writeId===t)return n}return null}function TR(r,t){const e=r.allWrites.findIndex(h=>h.writeId===t);tt(e>=0,"removeWrite called with nonexistent writeId.");const n=r.allWrites[e];r.allWrites.splice(e,1);let s=n.visible,o=!1,c=r.allWrites.length-1;for(;s&&c>=0;){const h=r.allWrites[c];h.visible&&(c>=e&&xR(h,n.path)?s=!1:xn(n.path,h.path)&&(o=!0)),c--}if(s){if(o)return RR(r),!0;if(n.snap)r.visibleWrites=Wb(r.visibleWrites,n.path);else{const h=n.children;Re(h,d=>{r.visibleWrites=Wb(r.visibleWrites,ne(n.path,d))})}return!0}else return!1}function xR(r,t){if(r.snap)return xn(r.path,t);for(const e in r.children)if(r.children.hasOwnProperty(e)&&xn(ne(r.path,e),t))return!0;return!1}function RR(r){r.visibleWrites=j0(r.allWrites,DR,Bt()),r.allWrites.length>0?r.lastWriteId=r.allWrites[r.allWrites.length-1].writeId:r.lastWriteId=-1}function DR(r){return r.visible}function j0(r,t,e){let n=In.empty();for(let s=0;s<r.length;++s){const o=r[s];if(t(o)){const c=o.path;let h;if(o.snap)xn(e,c)?(h=en(e,c),n=Eo(n,h,o.snap)):xn(c,e)&&(h=en(c,e),n=Eo(n,Bt(),o.snap.getChild(h)));else if(o.children){if(xn(e,c))h=en(e,c),n=kf(n,h,o.children);else if(xn(c,e))if(h=en(c,e),Dt(h))n=kf(n,Bt(),o.children);else{const d=$a(o.children,Tt(h));if(d){const f=d.getChild(Xt(h));n=Eo(n,Bt(),f)}}}else throw er("WriteRecord should have .snap or .children")}}return n}function G0(r,t,e,n,s){if(!n&&!s){const o=Gs(r.visibleWrites,t);if(o!=null)return o;{const c=Ji(r.visibleWrites,t);if(If(c))return e;if(e==null&&!Lf(c,Bt()))return null;{const h=e||yt.EMPTY_NODE;return Ja(c,h)}}}else{const o=Ji(r.visibleWrites,t);if(!s&&If(o))return e;if(!s&&e==null&&!Lf(o,Bt()))return null;{const c=function(f){return(f.visible||s)&&(!n||!~n.indexOf(f.writeId))&&(xn(f.path,t)||xn(t,f.path))},h=j0(r.allWrites,c,t),d=e||yt.EMPTY_NODE;return Ja(h,d)}}}function MR(r,t,e){let n=yt.EMPTY_NODE;const s=Gs(r.visibleWrites,t);if(s)return s.isLeafNode()||s.forEachChild(ie,(o,c)=>{n=n.updateImmediateChild(o,c)}),n;if(e){const o=Ji(r.visibleWrites,t);return e.forEachChild(ie,(c,h)=>{const d=Ja(Ji(o,new zt(c)),h);n=n.updateImmediateChild(c,d)}),Kb(o).forEach(c=>{n=n.updateImmediateChild(c.name,c.node)}),n}else{const o=Ji(r.visibleWrites,t);return Kb(o).forEach(c=>{n=n.updateImmediateChild(c.name,c.node)}),n}}function NR(r,t,e,n,s){tt(n||s,"Either existingEventSnap or existingServerSnap must exist");const o=ne(t,e);if(Lf(r.visibleWrites,o))return null;{const c=Ji(r.visibleWrites,o);return If(c)?s.getChild(e):Ja(c,s.getChild(e))}}function OR(r,t,e,n){const s=ne(t,e),o=Gs(r.visibleWrites,s);if(o!=null)return o;if(n.isCompleteForChild(e)){const c=Ji(r.visibleWrites,s);return Ja(c,n.getNode().getImmediateChild(e))}else return null}function kR(r,t){return Gs(r.visibleWrites,t)}function LR(r,t,e,n,s,o,c){let h;const d=Ji(r.visibleWrites,t),f=Gs(d,Bt());if(f!=null)h=f;else if(e!=null)h=Ja(d,e);else return[];if(h=h.withIndex(c),!h.isEmpty()&&!h.isLeafNode()){const g=[],_=c.getCompare(),y=o?h.getReverseIteratorFrom(n,c):h.getIteratorFrom(n,c);let b=y.getNext();for(;b&&g.length<s;)_(b,n)!==0&&g.push(b),b=y.getNext();return g}else return[]}function IR(){return{visibleWrites:In.empty(),allWrites:[],lastWriteId:-1}}function Uc(r,t,e,n){return G0(r.writeTree,r.treePath,t,e,n)}function Sp(r,t){return MR(r.writeTree,r.treePath,t)}function Qb(r,t,e,n){return NR(r.writeTree,r.treePath,t,e,n)}function jc(r,t){return kR(r.writeTree,ne(r.treePath,t))}function PR(r,t,e,n,s,o){return LR(r.writeTree,r.treePath,t,e,n,s,o)}function Ep(r,t,e){return OR(r.writeTree,r.treePath,t,e)}function q0(r,t){return V0(ne(r.treePath,t),r.writeTree)}function V0(r,t){return{treePath:r,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,n=t.childName;tt(e==="child_added"||e==="child_changed"||e==="child_removed","Only child changes supported for tracking"),tt(n!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(n);if(s){const o=s.type;if(e==="child_added"&&o==="child_removed")this.changeMap.set(n,Io(n,t.snapshotNode,s.snapshotNode));else if(e==="child_removed"&&o==="child_added")this.changeMap.delete(n);else if(e==="child_removed"&&o==="child_changed")this.changeMap.set(n,Lo(n,s.oldSnap));else if(e==="child_changed"&&o==="child_added")this.changeMap.set(n,Qa(n,t.snapshotNode));else if(e==="child_changed"&&o==="child_changed")this.changeMap.set(n,Io(n,t.snapshotNode,s.oldSnap));else throw er("Illegal combination of changes: "+t+" occurred after "+s)}else this.changeMap.set(n,t)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{getCompleteChild(t){return null}getChildAfterChild(t,e,n){return null}}const Y0=new FR;class wp{constructor(t,e,n=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const n=this.optCompleteServerCache_!=null?new Bs(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ep(this.writes_,t,n)}}getChildAfterChild(t,e,n){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Fs(this.viewCache_),o=PR(this.writes_,s,e,1,n,t);return o.length===0?null:o[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HR(r){return{filter:r}}function zR(r,t){tt(t.eventCache.getNode().isIndexed(r.filter.getIndex()),"Event snap not indexed"),tt(t.serverCache.getNode().isIndexed(r.filter.getIndex()),"Server snap not indexed")}function UR(r,t,e,n,s){const o=new BR;let c,h;if(e.type===Ln.OVERWRITE){const f=e;f.source.fromUser?c=Pf(r,t,f.path,f.snap,n,s,o):(tt(f.source.fromServer,"Unknown source."),h=f.source.tagged||t.serverCache.isFiltered()&&!Dt(f.path),c=Gc(r,t,f.path,f.snap,n,s,h,o))}else if(e.type===Ln.MERGE){const f=e;f.source.fromUser?c=GR(r,t,f.path,f.children,n,s,o):(tt(f.source.fromServer,"Unknown source."),h=f.source.tagged||t.serverCache.isFiltered(),c=Bf(r,t,f.path,f.children,n,s,h,o))}else if(e.type===Ln.ACK_USER_WRITE){const f=e;f.revert?c=YR(r,t,f.path,n,s,o):c=qR(r,t,f.path,f.affectedTree,n,s,o)}else if(e.type===Ln.LISTEN_COMPLETE)c=VR(r,t,e.path,n,o);else throw er("Unknown operation type: "+e.type);const d=o.getChanges();return jR(t,c,d),{viewCache:c,changes:d}}function jR(r,t,e){const n=t.eventCache;if(n.isFullyInitialized()){const s=n.getNode().isLeafNode()||n.getNode().isEmpty(),o=Of(r);(e.length>0||!r.eventCache.isFullyInitialized()||s&&!n.getNode().equals(o)||!n.getNode().getPriority().equals(o.getPriority()))&&e.push(H0(Of(t)))}}function X0(r,t,e,n,s,o){const c=t.eventCache;if(jc(n,e)!=null)return t;{let h,d;if(Dt(e))if(tt(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const f=Fs(t),g=f instanceof yt?f:yt.EMPTY_NODE,_=Sp(n,g);h=r.filter.updateFullNode(t.eventCache.getNode(),_,o)}else{const f=Uc(n,Fs(t));h=r.filter.updateFullNode(t.eventCache.getNode(),f,o)}else{const f=Tt(e);if(f===".priority"){tt(ns(e)===1,"Can't have a priority with additional path components");const g=c.getNode();d=t.serverCache.getNode();const _=Qb(n,e,g,d);_!=null?h=r.filter.updatePriority(g,_):h=c.getNode()}else{const g=Xt(e);let _;if(c.isCompleteForChild(f)){d=t.serverCache.getNode();const y=Qb(n,e,c.getNode(),d);y!=null?_=c.getNode().getImmediateChild(f).updateChild(g,y):_=c.getNode().getImmediateChild(f)}else _=Ep(n,f,t.serverCache);_!=null?h=r.filter.updateChild(c.getNode(),f,_,g,s,o):h=c.getNode()}}return So(t,h,c.isFullyInitialized()||Dt(e),r.filter.filtersNodes())}}function Gc(r,t,e,n,s,o,c,h){const d=t.serverCache;let f;const g=c?r.filter:r.filter.getIndexedFilter();if(Dt(e))f=g.updateFullNode(d.getNode(),n,null);else if(g.filtersNodes()&&!d.isFiltered()){const b=d.getNode().updateChild(e,n);f=g.updateFullNode(d.getNode(),b,null)}else{const b=Tt(e);if(!d.isCompleteForPath(e)&&ns(e)>1)return t;const A=Xt(e),w=d.getNode().getImmediateChild(b).updateChild(A,n);b===".priority"?f=g.updatePriority(d.getNode(),w):f=g.updateChild(d.getNode(),b,w,A,Y0,null)}const _=z0(t,f,d.isFullyInitialized()||Dt(e),g.filtersNodes()),y=new wp(s,_,o);return X0(r,_,e,s,y,h)}function Pf(r,t,e,n,s,o,c){const h=t.eventCache;let d,f;const g=new wp(s,t,o);if(Dt(e))f=r.filter.updateFullNode(t.eventCache.getNode(),n,c),d=So(t,f,!0,r.filter.filtersNodes());else{const _=Tt(e);if(_===".priority")f=r.filter.updatePriority(t.eventCache.getNode(),n),d=So(t,f,h.isFullyInitialized(),h.isFiltered());else{const y=Xt(e),b=h.getNode().getImmediateChild(_);let A;if(Dt(y))A=n;else{const S=g.getCompleteChild(_);S!=null?dp(y)===".priority"&&S.getChild(O0(y)).isEmpty()?A=S:A=S.updateChild(y,n):A=yt.EMPTY_NODE}if(b.equals(A))d=t;else{const S=r.filter.updateChild(h.getNode(),_,A,y,g,c);d=So(t,S,h.isFullyInitialized(),r.filter.filtersNodes())}}}return d}function Zb(r,t){return r.eventCache.isCompleteForChild(t)}function GR(r,t,e,n,s,o,c){let h=t;return n.foreach((d,f)=>{const g=ne(e,d);Zb(t,Tt(g))&&(h=Pf(r,h,g,f,s,o,c))}),n.foreach((d,f)=>{const g=ne(e,d);Zb(t,Tt(g))||(h=Pf(r,h,g,f,s,o,c))}),h}function Jb(r,t,e){return e.foreach((n,s)=>{t=t.updateChild(n,s)}),t}function Bf(r,t,e,n,s,o,c,h){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let d=t,f;Dt(e)?f=n:f=new Wt(null).setTree(e,n);const g=t.serverCache.getNode();return f.children.inorderTraversal((_,y)=>{if(g.hasChild(_)){const b=t.serverCache.getNode().getImmediateChild(_),A=Jb(r,b,y);d=Gc(r,d,new zt(_),A,s,o,c,h)}}),f.children.inorderTraversal((_,y)=>{const b=!t.serverCache.isCompleteForChild(_)&&y.value===null;if(!g.hasChild(_)&&!b){const A=t.serverCache.getNode().getImmediateChild(_),S=Jb(r,A,y);d=Gc(r,d,new zt(_),S,s,o,c,h)}}),d}function qR(r,t,e,n,s,o,c){if(jc(s,e)!=null)return t;const h=t.serverCache.isFiltered(),d=t.serverCache;if(n.value!=null){if(Dt(e)&&d.isFullyInitialized()||d.isCompleteForPath(e))return Gc(r,t,e,d.getNode().getChild(e),s,o,h,c);if(Dt(e)){let f=new Wt(null);return d.getNode().forEachChild(qa,(g,_)=>{f=f.set(new zt(g),_)}),Bf(r,t,e,f,s,o,h,c)}else return t}else{let f=new Wt(null);return n.foreach((g,_)=>{const y=ne(e,g);d.isCompleteForPath(y)&&(f=f.set(g,d.getNode().getChild(y)))}),Bf(r,t,e,f,s,o,h,c)}}function VR(r,t,e,n,s){const o=t.serverCache,c=z0(t,o.getNode(),o.isFullyInitialized()||Dt(e),o.isFiltered());return X0(r,c,e,n,Y0,s)}function YR(r,t,e,n,s,o){let c;if(jc(n,e)!=null)return t;{const h=new wp(n,t,s),d=t.eventCache.getNode();let f;if(Dt(e)||Tt(e)===".priority"){let g;if(t.serverCache.isFullyInitialized())g=Uc(n,Fs(t));else{const _=t.serverCache.getNode();tt(_ instanceof yt,"serverChildren would be complete if leaf node"),g=Sp(n,_)}g=g,f=r.filter.updateFullNode(d,g,o)}else{const g=Tt(e);let _=Ep(n,g,t.serverCache);_==null&&t.serverCache.isCompleteForChild(g)&&(_=d.getImmediateChild(g)),_!=null?f=r.filter.updateChild(d,g,_,Xt(e),h,o):t.eventCache.getNode().hasChild(g)?f=r.filter.updateChild(d,g,yt.EMPTY_NODE,Xt(e),h,o):f=d,f.isEmpty()&&t.serverCache.isFullyInitialized()&&(c=Uc(n,Fs(t)),c.isLeafNode()&&(f=r.filter.updateFullNode(f,c,o)))}return c=t.serverCache.isFullyInitialized()||jc(n,Bt())!=null,So(t,f,c,r.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const n=this.query_._queryParams,s=new mp(n.getIndex()),o=hR(n);this.processor_=HR(o);const c=e.serverCache,h=e.eventCache,d=s.updateFullNode(yt.EMPTY_NODE,c.getNode(),null),f=o.updateFullNode(yt.EMPTY_NODE,h.getNode(),null),g=new Bs(d,c.isFullyInitialized(),s.filtersNodes()),_=new Bs(f,h.isFullyInitialized(),o.filtersNodes());this.viewCache_=lu(_,g),this.eventGenerator_=new yR(this.query_)}get query(){return this.query_}}function $R(r){return r.viewCache_.serverCache.getNode()}function WR(r,t){const e=Fs(r.viewCache_);return e&&(r.query._queryParams.loadsAllData()||!Dt(t)&&!e.getImmediateChild(Tt(t)).isEmpty())?e.getChild(t):null}function tv(r){return r.eventRegistrations_.length===0}function KR(r,t){r.eventRegistrations_.push(t)}function ev(r,t,e){const n=[];if(e){tt(t==null,"A cancel should cancel all event registrations.");const s=r.query._path;r.eventRegistrations_.forEach(o=>{const c=o.createCancelEvent(e,s);c&&n.push(c)})}if(t){let s=[];for(let o=0;o<r.eventRegistrations_.length;++o){const c=r.eventRegistrations_[o];if(!c.matches(t))s.push(c);else if(t.hasAnyCallback()){s=s.concat(r.eventRegistrations_.slice(o+1));break}}r.eventRegistrations_=s}else r.eventRegistrations_=[];return n}function nv(r,t,e,n){t.type===Ln.MERGE&&t.source.queryId!==null&&(tt(Fs(r.viewCache_),"We should always have a full cache before handling merges"),tt(Of(r.viewCache_),"Missing event cache, even though we have a server cache"));const s=r.viewCache_,o=UR(r.processor_,s,t,e,n);return zR(r.processor_,o.viewCache),tt(o.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),r.viewCache_=o.viewCache,$0(r,o.changes,o.viewCache.eventCache.getNode(),null)}function QR(r,t){const e=r.viewCache_.eventCache,n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(ie,(o,c)=>{n.push(Qa(o,c))}),e.isFullyInitialized()&&n.push(H0(e.getNode())),$0(r,n,e.getNode(),t)}function $0(r,t,e,n){const s=n?[n]:r.eventRegistrations_;return bR(r.eventGenerator_,t,e,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qc;class ZR{constructor(){this.views=new Map}}function JR(r){tt(!qc,"__referenceConstructor has already been defined"),qc=r}function tD(){return tt(qc,"Reference.ts has not been loaded"),qc}function eD(r){return r.views.size===0}function Cp(r,t,e,n){const s=t.source.queryId;if(s!==null){const o=r.views.get(s);return tt(o!=null,"SyncTree gave us an op for an invalid query."),nv(o,t,e,n)}else{let o=[];for(const c of r.views.values())o=o.concat(nv(c,t,e,n));return o}}function nD(r,t,e,n,s){const o=t._queryIdentifier,c=r.views.get(o);if(!c){let h=Uc(e,s?n:null),d=!1;h?d=!0:n instanceof yt?(h=Sp(e,n),d=!1):(h=yt.EMPTY_NODE,d=!1);const f=lu(new Bs(h,d,!1),new Bs(n,s,!1));return new XR(t,f)}return c}function iD(r,t,e,n,s,o){const c=nD(r,t,n,s,o);return r.views.has(t._queryIdentifier)||r.views.set(t._queryIdentifier,c),KR(c,e),QR(c,e)}function sD(r,t,e,n){const s=t._queryIdentifier,o=[];let c=[];const h=is(r);if(s==="default")for(const[d,f]of r.views.entries())c=c.concat(ev(f,e,n)),tv(f)&&(r.views.delete(d),f.query._queryParams.loadsAllData()||o.push(f.query));else{const d=r.views.get(s);d&&(c=c.concat(ev(d,e,n)),tv(d)&&(r.views.delete(s),d.query._queryParams.loadsAllData()||o.push(d.query)))}return h&&!is(r)&&o.push(new(tD())(t._repo,t._path)),{removed:o,events:c}}function W0(r){const t=[];for(const e of r.views.values())e.query._queryParams.loadsAllData()||t.push(e);return t}function Va(r,t){let e=null;for(const n of r.views.values())e=e||WR(n,t);return e}function K0(r,t){if(t._queryParams.loadsAllData())return cu(r);{const n=t._queryIdentifier;return r.views.get(n)}}function Q0(r,t){return K0(r,t)!=null}function is(r){return cu(r)!=null}function cu(r){for(const t of r.views.values())if(t.query._queryParams.loadsAllData())return t;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vc;function aD(r){tt(!Vc,"__referenceConstructor has already been defined"),Vc=r}function rD(){return tt(Vc,"Reference.ts has not been loaded"),Vc}let oD=1;class iv{constructor(t){this.listenProvider_=t,this.syncPointTree_=new Wt(null),this.pendingWriteTree_=IR(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Z0(r,t,e,n,s){return ER(r.pendingWriteTree_,t,e,n,s),s?sr(r,new Ps(yp(),t,e)):[]}function lD(r,t,e,n){wR(r.pendingWriteTree_,t,e,n);const s=Wt.fromObject(e);return sr(r,new Za(yp(),t,s))}function Ki(r,t,e=!1){const n=CR(r.pendingWriteTree_,t);if(TR(r.pendingWriteTree_,t)){let o=new Wt(null);return n.snap!=null?o=o.set(Bt(),!0):Re(n.children,c=>{o=o.set(new zt(c),!0)}),sr(r,new zc(n.path,o,e))}else return[]}function uu(r,t,e){return sr(r,new Ps(bp(),t,e))}function cD(r,t,e){const n=Wt.fromObject(e);return sr(r,new Za(bp(),t,n))}function uD(r,t){return sr(r,new Bo(bp(),t))}function hD(r,t,e){const n=xp(r,e);if(n){const s=Rp(n),o=s.path,c=s.queryId,h=en(o,t),d=new Bo(vp(c),h);return Dp(r,o,d)}else return[]}function Ff(r,t,e,n,s=!1){const o=t._path,c=r.syncPointTree_.get(o);let h=[];if(c&&(t._queryIdentifier==="default"||Q0(c,t))){const d=sD(c,t,e,n);eD(c)&&(r.syncPointTree_=r.syncPointTree_.remove(o));const f=d.removed;if(h=d.events,!s){const g=f.findIndex(y=>y._queryParams.loadsAllData())!==-1,_=r.syncPointTree_.findOnPath(o,(y,b)=>is(b));if(g&&!_){const y=r.syncPointTree_.subtree(o);if(!y.isEmpty()){const b=pD(y);for(let A=0;A<b.length;++A){const S=b[A],w=S.query,C=eA(r,S);r.listenProvider_.startListening(wo(w),Yc(r,w),C.hashFn,C.onComplete)}}}!_&&f.length>0&&!n&&(g?r.listenProvider_.stopListening(wo(t),null):f.forEach(y=>{const b=r.queryToTagMap.get(hu(y));r.listenProvider_.stopListening(wo(y),b)}))}gD(r,f)}return h}function dD(r,t,e,n){const s=xp(r,n);if(s!=null){const o=Rp(s),c=o.path,h=o.queryId,d=en(c,t),f=new Ps(vp(h),d,e);return Dp(r,c,f)}else return[]}function fD(r,t,e,n){const s=xp(r,n);if(s){const o=Rp(s),c=o.path,h=o.queryId,d=en(c,t),f=Wt.fromObject(e),g=new Za(vp(h),d,f);return Dp(r,c,g)}else return[]}function sv(r,t,e,n=!1){const s=t._path;let o=null,c=!1;r.syncPointTree_.foreachOnPath(s,(y,b)=>{const A=en(y,s);o=o||Va(b,A),c=c||is(b)});let h=r.syncPointTree_.get(s);h?(c=c||is(h),o=o||Va(h,Bt())):(h=new ZR,r.syncPointTree_=r.syncPointTree_.set(s,h));let d;o!=null?d=!0:(d=!1,o=yt.EMPTY_NODE,r.syncPointTree_.subtree(s).foreachChild((b,A)=>{const S=Va(A,Bt());S&&(o=o.updateImmediateChild(b,S))}));const f=Q0(h,t);if(!f&&!t._queryParams.loadsAllData()){const y=hu(t);tt(!r.queryToTagMap.has(y),"View does not exist, but we have a tag");const b=mD();r.queryToTagMap.set(y,b),r.tagToQueryMap.set(b,y)}const g=Ap(r.pendingWriteTree_,s);let _=iD(h,t,e,g,o,d);if(!f&&!c&&!n){const y=K0(h,t);_=_.concat(_D(r,t,y))}return _}function Tp(r,t,e){const s=r.pendingWriteTree_,o=r.syncPointTree_.findOnPath(t,(c,h)=>{const d=en(c,t),f=Va(h,d);if(f)return f});return G0(s,t,o,e,!0)}function sr(r,t){return J0(t,r.syncPointTree_,null,Ap(r.pendingWriteTree_,Bt()))}function J0(r,t,e,n){if(Dt(r.path))return tA(r,t,e,n);{const s=t.get(Bt());e==null&&s!=null&&(e=Va(s,Bt()));let o=[];const c=Tt(r.path),h=r.operationForChild(c),d=t.children.get(c);if(d&&h){const f=e?e.getImmediateChild(c):null,g=q0(n,c);o=o.concat(J0(h,d,f,g))}return s&&(o=o.concat(Cp(s,r,n,e))),o}}function tA(r,t,e,n){const s=t.get(Bt());e==null&&s!=null&&(e=Va(s,Bt()));let o=[];return t.children.inorderTraversal((c,h)=>{const d=e?e.getImmediateChild(c):null,f=q0(n,c),g=r.operationForChild(c);g&&(o=o.concat(tA(g,h,d,f)))}),s&&(o=o.concat(Cp(s,r,n,e))),o}function eA(r,t){const e=t.query,n=Yc(r,e);return{hashFn:()=>($R(t)||yt.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return n?hD(r,e._path,n):uD(r,e._path);{const o=cx(s,e);return Ff(r,e,null,o)}}}}function Yc(r,t){const e=hu(t);return r.queryToTagMap.get(e)}function hu(r){return r._path.toString()+"$"+r._queryIdentifier}function xp(r,t){return r.tagToQueryMap.get(t)}function Rp(r){const t=r.indexOf("$");return tt(t!==-1&&t<r.length-1,"Bad queryKey."),{queryId:r.substr(t+1),path:new zt(r.substr(0,t))}}function Dp(r,t,e){const n=r.syncPointTree_.get(t);tt(n,"Missing sync point for query tag that we're tracking");const s=Ap(r.pendingWriteTree_,t);return Cp(n,e,s,null)}function pD(r){return r.fold((t,e,n)=>{if(e&&is(e))return[cu(e)];{let s=[];return e&&(s=W0(e)),Re(n,(o,c)=>{s=s.concat(c)}),s}})}function wo(r){return r._queryParams.loadsAllData()&&!r._queryParams.isDefault()?new(rD())(r._repo,r._path):r}function gD(r,t){for(let e=0;e<t.length;++e){const n=t[e];if(!n._queryParams.loadsAllData()){const s=hu(n),o=r.queryToTagMap.get(s);r.queryToTagMap.delete(s),r.tagToQueryMap.delete(o)}}}function mD(){return oD++}function _D(r,t,e){const n=t._path,s=Yc(r,t),o=eA(r,e),c=r.listenProvider_.startListening(wo(t),s,o.hashFn,o.onComplete),h=r.syncPointTree_.subtree(n);if(s)tt(!is(h.value),"If we're adding a query, it shouldn't be shadowed");else{const d=h.fold((f,g,_)=>{if(!Dt(f)&&g&&is(g))return[cu(g).query];{let y=[];return g&&(y=y.concat(W0(g).map(b=>b.query))),Re(_,(b,A)=>{y=y.concat(A)}),y}});for(let f=0;f<d.length;++f){const g=d[f];r.listenProvider_.stopListening(wo(g),Yc(r,g))}}return c}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mp{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new Mp(e)}node(){return this.node_}}class Np{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=ne(this.path_,t);return new Np(this.syncTree_,e)}node(){return Tp(this.syncTree_,this.path_)}}const yD=function(r){return r=r||{},r.timestamp=r.timestamp||new Date().getTime(),r},av=function(r,t,e){if(!r||typeof r!="object")return r;if(tt(".sv"in r,"Unexpected leaf node or priority contents"),typeof r[".sv"]=="string")return bD(r[".sv"],t,e);if(typeof r[".sv"]=="object")return vD(r[".sv"],t);tt(!1,"Unexpected server value: "+JSON.stringify(r,null,2))},bD=function(r,t,e){switch(r){case"timestamp":return e.timestamp;default:tt(!1,"Unexpected server value: "+r)}},vD=function(r,t,e){r.hasOwnProperty("increment")||tt(!1,"Unexpected server value: "+JSON.stringify(r,null,2));const n=r.increment;typeof n!="number"&&tt(!1,"Unexpected increment value: "+n);const s=t.node();if(tt(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return n;const c=s.getValue();return typeof c!="number"?n:c+n},nA=function(r,t,e,n){return Op(t,new Np(e,r),n)},iA=function(r,t,e){return Op(r,new Mp(t),e)};function Op(r,t,e){const n=r.getPriority().val(),s=av(n,t.getImmediateChild(".priority"),e);let o;if(r.isLeafNode()){const c=r,h=av(c.getValue(),t,e);return h!==c.getValue()||s!==c.getPriority().val()?new we(h,ce(s)):r}else{const c=r;return o=c,s!==c.getPriority().val()&&(o=o.updatePriority(new we(s))),c.forEachChild(ie,(h,d)=>{const f=Op(d,t.getImmediateChild(h),e);f!==d&&(o=o.updateImmediateChild(h,f))}),o}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kp{constructor(t="",e=null,n={children:{},childCount:0}){this.name=t,this.parent=e,this.node=n}}function Lp(r,t){let e=t instanceof zt?t:new zt(t),n=r,s=Tt(e);for(;s!==null;){const o=$a(n.node.children,s)||{children:{},childCount:0};n=new kp(s,n,o),e=Xt(e),s=Tt(e)}return n}function ar(r){return r.node.value}function sA(r,t){r.node.value=t,Hf(r)}function aA(r){return r.node.childCount>0}function AD(r){return ar(r)===void 0&&!aA(r)}function du(r,t){Re(r.node.children,(e,n)=>{t(new kp(e,r,n))})}function rA(r,t,e,n){e&&t(r),du(r,s=>{rA(s,t,!0)})}function SD(r,t,e){let n=r.parent;for(;n!==null;){if(t(n))return!0;n=n.parent}return!1}function Wo(r){return new zt(r.parent===null?r.name:Wo(r.parent)+"/"+r.name)}function Hf(r){r.parent!==null&&ED(r.parent,r.name,r)}function ED(r,t,e){const n=AD(e),s=ei(r.node.children,t);n&&s?(delete r.node.children[t],r.node.childCount--,Hf(r)):!n&&!s&&(r.node.children[t]=e.node,r.node.childCount++,Hf(r))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=/[\[\].#$\/\u0000-\u001F\u007F]/,CD=/[\[\].#$\u0000-\u001F\u007F]/,ef=10*1024*1024,Ip=function(r){return typeof r=="string"&&r.length!==0&&!wD.test(r)},oA=function(r){return typeof r=="string"&&r.length!==0&&!CD.test(r)},TD=function(r){return r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),oA(r)},lA=function(r){return r===null||typeof r=="string"||typeof r=="number"&&!ru(r)||r&&typeof r=="object"&&ei(r,".sv")},Xc=function(r,t,e,n){n&&t===void 0||fu(Wa(r,"value"),t,e)},fu=function(r,t,e){const n=e instanceof zt?new Gx(e,r):e;if(t===void 0)throw new Error(r+"contains undefined "+Ts(n));if(typeof t=="function")throw new Error(r+"contains a function "+Ts(n)+" with contents = "+t.toString());if(ru(t))throw new Error(r+"contains "+t.toString()+" "+Ts(n));if(typeof t=="string"&&t.length>ef/3&&au(t)>ef)throw new Error(r+"contains a string greater than "+ef+" utf8 bytes "+Ts(n)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let s=!1,o=!1;if(Re(t,(c,h)=>{if(c===".value")s=!0;else if(c!==".priority"&&c!==".sv"&&(o=!0,!Ip(c)))throw new Error(r+" contains an invalid key ("+c+") "+Ts(n)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);qx(n,c),fu(r,h,n),Vx(n)}),s&&o)throw new Error(r+' contains ".value" child '+Ts(n)+" in addition to actual children.")}},xD=function(r,t){let e,n;for(e=0;e<t.length;e++){n=t[e];const o=ko(n);for(let c=0;c<o.length;c++)if(!(o[c]===".priority"&&c===o.length-1)){if(!Ip(o[c]))throw new Error(r+"contains an invalid key ("+o[c]+") in path "+n.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}t.sort(jx);let s=null;for(e=0;e<t.length;e++){if(n=t[e],s!==null&&xn(s,n))throw new Error(r+"contains a path "+s.toString()+" that is ancestor of another path "+n.toString());s=n}},cA=function(r,t,e,n){const s=Wa(r,"values");if(!(t&&typeof t=="object")||Array.isArray(t))throw new Error(s+" must be an object containing the children to replace.");const o=[];Re(t,(c,h)=>{const d=new zt(c);if(fu(s,h,ne(e,d)),dp(d)===".priority"&&!lA(h))throw new Error(s+"contains an invalid value for '"+d.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(d)}),xD(s,o)},RD=function(r,t,e){if(ru(t))throw new Error(Wa(r,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!lA(t))throw new Error(Wa(r,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},uA=function(r,t,e,n){if(!oA(e))throw new Error(Wa(r,t)+'was an invalid path = "'+e+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},DD=function(r,t,e,n){e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),uA(r,t,e)},Ha=function(r,t){if(Tt(t)===".info")throw new Error(r+" failed = Can't modify data under /.info/")},MD=function(r,t){const e=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!Ip(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||e.length!==0&&!TD(e))throw new Error(Wa(r,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function pu(r,t){let e=null;for(let n=0;n<t.length;n++){const s=t[n],o=s.getPath();e!==null&&!fp(o,e.path)&&(r.eventLists_.push(e),e=null),e===null&&(e={events:[],path:o}),e.events.push(s)}e&&r.eventLists_.push(e)}function hA(r,t,e){pu(r,e),dA(r,n=>fp(n,t))}function Pn(r,t,e){pu(r,e),dA(r,n=>xn(n,t)||xn(t,n))}function dA(r,t){r.recursionDepth_++;let e=!0;for(let n=0;n<r.eventLists_.length;n++){const s=r.eventLists_[n];if(s){const o=s.path;t(o)?(OD(r.eventLists_[n]),r.eventLists_[n]=null):e=!1}}e&&(r.eventLists_=[]),r.recursionDepth_--}function OD(r){for(let t=0;t<r.events.length;t++){const e=r.events[t];if(e!==null){r.events[t]=null;const n=e.getEventRunner();vo&&Te("event: "+e.toString()),nr(n)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD="repo_interrupt",LD=25;class ID{constructor(t,e,n,s){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ND,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Hc(),this.transactionQueueTree_=new kp,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function PD(r,t,e){if(r.stats_=up(r.repoInfo_),r.forceRestClient_||fx())r.server_=new Fc(r.repoInfo_,(n,s,o,c)=>{rv(r,n,s,o,c)},r.authTokenProvider_,r.appCheckProvider_),setTimeout(()=>ov(r,!0),0);else{if(typeof e<"u"&&e!==null){if(typeof e!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{xe(e)}catch(n){throw new Error("Invalid authOverride provided: "+n)}}r.persistentConnection_=new Ai(r.repoInfo_,t,(n,s,o,c)=>{rv(r,n,s,o,c)},n=>{ov(r,n)},n=>{BD(r,n)},r.authTokenProvider_,r.appCheckProvider_,e),r.server_=r.persistentConnection_}r.authTokenProvider_.addTokenChangeListener(n=>{r.server_.refreshAuthToken(n)}),r.appCheckProvider_.addTokenChangeListener(n=>{r.server_.refreshAppCheckToken(n.token)}),r.statsReporter_=yx(r.repoInfo_,()=>new _R(r.stats_,r.server_)),r.infoData_=new dR,r.infoSyncTree_=new iv({startListening:(n,s,o,c)=>{let h=[];const d=r.infoData_.getNode(n._path);return d.isEmpty()||(h=uu(r.infoSyncTree_,n._path,d),setTimeout(()=>{c("ok")},0)),h},stopListening:()=>{}}),Pp(r,"connected",!1),r.serverSyncTree_=new iv({startListening:(n,s,o,c)=>(r.server_.listen(n,o,s,(h,d)=>{const f=c(h,d);Pn(r.eventQueue_,n._path,f)}),[]),stopListening:(n,s)=>{r.server_.unlisten(n,s)}})}function fA(r){const e=r.infoData_.getNode(new zt(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e}function gu(r){return yD({timestamp:fA(r)})}function rv(r,t,e,n,s){r.dataUpdateCount++;const o=new zt(t);e=r.interceptServerDataCallback_?r.interceptServerDataCallback_(t,e):e;let c=[];if(s)if(n){const d=Nc(e,f=>ce(f));c=fD(r.serverSyncTree_,o,d,s)}else{const d=ce(e);c=dD(r.serverSyncTree_,o,d,s)}else if(n){const d=Nc(e,f=>ce(f));c=cD(r.serverSyncTree_,o,d)}else{const d=ce(e);c=uu(r.serverSyncTree_,o,d)}let h=o;c.length>0&&(h=tr(r,o)),Pn(r.eventQueue_,h,c)}function ov(r,t){Pp(r,"connected",t),t===!1&&zD(r)}function BD(r,t){Re(t,(e,n)=>{Pp(r,e,n)})}function Pp(r,t,e){const n=new zt("/.info/"+t),s=ce(e);r.infoData_.updateSnapshot(n,s);const o=uu(r.infoSyncTree_,n,s);Pn(r.eventQueue_,n,o)}function Bp(r){return r.nextWriteId_++}function FD(r,t,e,n,s){mu(r,"set",{path:t.toString(),value:e,priority:n});const o=gu(r),c=ce(e,n),h=Tp(r.serverSyncTree_,t),d=iA(c,h,o),f=Bp(r),g=Z0(r.serverSyncTree_,t,d,f,!0);pu(r.eventQueue_,g),r.server_.put(t.toString(),c.val(!0),(y,b)=>{const A=y==="ok";A||Ve("set at "+t+" failed: "+y);const S=Ki(r.serverSyncTree_,f,!A);Pn(r.eventQueue_,t,S),ss(r,s,y,b)});const _=Hp(r,t);tr(r,_),Pn(r.eventQueue_,_,[])}function HD(r,t,e,n){mu(r,"update",{path:t.toString(),value:e});let s=!0;const o=gu(r),c={};if(Re(e,(h,d)=>{s=!1,c[h]=nA(ne(t,h),ce(d),r.serverSyncTree_,o)}),s)Te("update() called with empty data.  Don't do anything."),ss(r,n,"ok",void 0);else{const h=Bp(r),d=lD(r.serverSyncTree_,t,c,h);pu(r.eventQueue_,d),r.server_.merge(t.toString(),e,(f,g)=>{const _=f==="ok";_||Ve("update at "+t+" failed: "+f);const y=Ki(r.serverSyncTree_,h,!_),b=y.length>0?tr(r,t):t;Pn(r.eventQueue_,b,y),ss(r,n,f,g)}),Re(e,f=>{const g=Hp(r,ne(t,f));tr(r,g)}),Pn(r.eventQueue_,t,[])}}function zD(r){mu(r,"onDisconnectEvents");const t=gu(r),e=Hc();Nf(r.onDisconnect_,Bt(),(s,o)=>{const c=nA(s,o,r.serverSyncTree_,t);ir(e,s,c)});let n=[];Nf(e,Bt(),(s,o)=>{n=n.concat(uu(r.serverSyncTree_,s,o));const c=Hp(r,s);tr(r,c)}),r.onDisconnect_=Hc(),Pn(r.eventQueue_,Bt(),n)}function UD(r,t,e){r.server_.onDisconnectCancel(t.toString(),(n,s)=>{n==="ok"&&Mf(r.onDisconnect_,t),ss(r,e,n,s)})}function lv(r,t,e,n){const s=ce(e);r.server_.onDisconnectPut(t.toString(),s.val(!0),(o,c)=>{o==="ok"&&ir(r.onDisconnect_,t,s),ss(r,n,o,c)})}function jD(r,t,e,n,s){const o=ce(e,n);r.server_.onDisconnectPut(t.toString(),o.val(!0),(c,h)=>{c==="ok"&&ir(r.onDisconnect_,t,o),ss(r,s,c,h)})}function GD(r,t,e,n){if(Af(e)){Te("onDisconnect().update() called with empty data.  Don't do anything."),ss(r,n,"ok",void 0);return}r.server_.onDisconnectMerge(t.toString(),e,(s,o)=>{s==="ok"&&Re(e,(c,h)=>{const d=ce(h);ir(r.onDisconnect_,ne(t,c),d)}),ss(r,n,s,o)})}function qD(r,t,e){let n;Tt(t._path)===".info"?n=sv(r.infoSyncTree_,t,e):n=sv(r.serverSyncTree_,t,e),hA(r.eventQueue_,t._path,n)}function VD(r,t,e){let n;Tt(t._path)===".info"?n=Ff(r.infoSyncTree_,t,e):n=Ff(r.serverSyncTree_,t,e),hA(r.eventQueue_,t._path,n)}function YD(r){r.persistentConnection_&&r.persistentConnection_.interrupt(kD)}function mu(r,...t){let e="";r.persistentConnection_&&(e=r.persistentConnection_.id+":"),Te(e,...t)}function ss(r,t,e,n){t&&nr(()=>{if(e==="ok")t(null);else{const s=(e||"error").toUpperCase();let o=s;n&&(o+=": "+n);const c=new Error(o);c.code=s,t(c)}})}function pA(r,t,e){return Tp(r.serverSyncTree_,t,e)||yt.EMPTY_NODE}function Fp(r,t=r.transactionQueueTree_){if(t||_u(r,t),ar(t)){const e=mA(r,t);tt(e.length>0,"Sending zero length transaction queue"),e.every(s=>s.status===0)&&XD(r,Wo(t),e)}else aA(t)&&du(t,e=>{Fp(r,e)})}function XD(r,t,e){const n=e.map(f=>f.currentWriteId),s=pA(r,t,n);let o=s;const c=s.hash();for(let f=0;f<e.length;f++){const g=e[f];tt(g.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),g.status=1,g.retryCount++;const _=en(t,g.path);o=o.updateChild(_,g.currentOutputSnapshotRaw)}const h=o.val(!0),d=t;r.server_.put(d.toString(),h,f=>{mu(r,"transaction put response",{path:d.toString(),status:f});let g=[];if(f==="ok"){const _=[];for(let y=0;y<e.length;y++)e[y].status=2,g=g.concat(Ki(r.serverSyncTree_,e[y].currentWriteId)),e[y].onComplete&&_.push(()=>e[y].onComplete(null,!0,e[y].currentOutputSnapshotResolved)),e[y].unwatcher();_u(r,Lp(r.transactionQueueTree_,t)),Fp(r,r.transactionQueueTree_),Pn(r.eventQueue_,t,g);for(let y=0;y<_.length;y++)nr(_[y])}else{if(f==="datastale")for(let _=0;_<e.length;_++)e[_].status===3?e[_].status=4:e[_].status=0;else{Ve("transaction at "+d.toString()+" failed: "+f);for(let _=0;_<e.length;_++)e[_].status=4,e[_].abortReason=f}tr(r,t)}},c)}function tr(r,t){const e=gA(r,t),n=Wo(e),s=mA(r,e);return $D(r,s,n),n}function $D(r,t,e){if(t.length===0)return;const n=[];let s=[];const c=t.filter(h=>h.status===0).map(h=>h.currentWriteId);for(let h=0;h<t.length;h++){const d=t[h],f=en(e,d.path);let g=!1,_;if(tt(f!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),d.status===4)g=!0,_=d.abortReason,s=s.concat(Ki(r.serverSyncTree_,d.currentWriteId,!0));else if(d.status===0)if(d.retryCount>=LD)g=!0,_="maxretry",s=s.concat(Ki(r.serverSyncTree_,d.currentWriteId,!0));else{const y=pA(r,d.path,c);d.currentInputSnapshot=y;const b=t[h].update(y.val());if(b!==void 0){fu("transaction failed: Data returned ",b,d.path);let A=ce(b);typeof b=="object"&&b!=null&&ei(b,".priority")||(A=A.updatePriority(y.getPriority()));const w=d.currentWriteId,C=gu(r),D=iA(A,y,C);d.currentOutputSnapshotRaw=A,d.currentOutputSnapshotResolved=D,d.currentWriteId=Bp(r),c.splice(c.indexOf(w),1),s=s.concat(Z0(r.serverSyncTree_,d.path,D,d.currentWriteId,d.applyLocally)),s=s.concat(Ki(r.serverSyncTree_,w,!0))}else g=!0,_="nodata",s=s.concat(Ki(r.serverSyncTree_,d.currentWriteId,!0))}Pn(r.eventQueue_,e,s),s=[],g&&(t[h].status=2,(function(y){setTimeout(y,Math.floor(0))})(t[h].unwatcher),t[h].onComplete&&(_==="nodata"?n.push(()=>t[h].onComplete(null,!1,t[h].currentInputSnapshot)):n.push(()=>t[h].onComplete(new Error(_),!1,null))))}_u(r,r.transactionQueueTree_);for(let h=0;h<n.length;h++)nr(n[h]);Fp(r,r.transactionQueueTree_)}function gA(r,t){let e,n=r.transactionQueueTree_;for(e=Tt(t);e!==null&&ar(n)===void 0;)n=Lp(n,e),t=Xt(t),e=Tt(t);return n}function mA(r,t){const e=[];return _A(r,t,e),e.sort((n,s)=>n.order-s.order),e}function _A(r,t,e){const n=ar(t);if(n)for(let s=0;s<n.length;s++)e.push(n[s]);du(t,s=>{_A(r,s,e)})}function _u(r,t){const e=ar(t);if(e){let n=0;for(let s=0;s<e.length;s++)e[s].status!==2&&(e[n]=e[s],n++);e.length=n,sA(t,e.length>0?e:void 0)}du(t,n=>{_u(r,n)})}function Hp(r,t){const e=Wo(gA(r,t)),n=Lp(r.transactionQueueTree_,t);return SD(n,s=>{nf(r,s)}),nf(r,n),rA(n,s=>{nf(r,s)}),e}function nf(r,t){const e=ar(t);if(e){const n=[];let s=[],o=-1;for(let c=0;c<e.length;c++)e[c].status===3||(e[c].status===1?(tt(o===c-1,"All SENT items should be at beginning of queue."),o=c,e[c].status=3,e[c].abortReason="set"):(tt(e[c].status===0,"Unexpected transaction status in abort"),e[c].unwatcher(),s=s.concat(Ki(r.serverSyncTree_,e[c].currentWriteId,!0)),e[c].onComplete&&n.push(e[c].onComplete.bind(null,new Error("set"),!1,null))));o===-1?sA(t,void 0):e.length=o+1,Pn(r.eventQueue_,Wo(t),s);for(let c=0;c<n.length;c++)nr(n[c])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WD(r){let t="";const e=r.split("/");for(let n=0;n<e.length;n++)if(e[n].length>0){let s=e[n];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}t+="/"+s}return t}function KD(r){const t={};r.charAt(0)==="?"&&(r=r.substring(1));for(const e of r.split("&")){if(e.length===0)continue;const n=e.split("=");n.length===2?t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]):Ve(`Invalid query segment '${e}' in query '${r}'`)}return t}const cv=function(r,t){const e=QD(r),n=e.namespace;e.domain==="firebase.com"&&Ei(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!n||n==="undefined")&&e.domain!=="localhost"&&Ei("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||sx();const s=e.scheme==="ws"||e.scheme==="wss";return{repoInfo:new E0(e.host,e.secure,n,s,t,"",n!==e.subdomain),path:new zt(e.pathString)}},QD=function(r){let t="",e="",n="",s="",o="",c=!0,h="https",d=443;if(typeof r=="string"){let f=r.indexOf("//");f>=0&&(h=r.substring(0,f-1),r=r.substring(f+2));let g=r.indexOf("/");g===-1&&(g=r.length);let _=r.indexOf("?");_===-1&&(_=r.length),t=r.substring(0,Math.min(g,_)),g<_&&(s=WD(r.substring(g,_)));const y=KD(r.substring(Math.min(r.length,_)));f=t.indexOf(":"),f>=0?(c=h==="https"||h==="wss",d=parseInt(t.substring(f+1),10)):f=t.length;const b=t.slice(0,f);if(b.toLowerCase()==="localhost")e="localhost";else if(b.split(".").length<=2)e=b;else{const A=t.indexOf(".");n=t.substring(0,A).toLowerCase(),e=t.substring(A+1),o=n}"ns"in y&&(o=y.ns)}return{host:t,port:d,domain:e,subdomain:n,secure:c,scheme:h,pathString:s,namespace:o}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ZD=(function(){let r=0;const t=[];return function(e){const n=e===r;r=e;let s;const o=new Array(8);for(s=7;s>=0;s--)o[s]=uv.charAt(e%64),e=Math.floor(e/64);tt(e===0,"Cannot push at time == 0");let c=o.join("");if(n){for(s=11;s>=0&&t[s]===63;s--)t[s]=0;t[s]++}else for(s=0;s<12;s++)t[s]=Math.floor(Math.random()*64);for(s=0;s<12;s++)c+=uv.charAt(t[s]);return tt(c.length===20,"nextPushId: Length should be 20."),c}})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(t,e,n,s){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=s}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+xe(this.snapshot.exportVal())}}class tM{constructor(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eM{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return tt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(t,e){this._repo=t,this._path=e}cancel(){const t=new Jn;return UD(this._repo,this._path,t.wrapCallback(()=>{})),t.promise}remove(){Ha("OnDisconnect.remove",this._path);const t=new Jn;return lv(this._repo,this._path,null,t.wrapCallback(()=>{})),t.promise}set(t){Ha("OnDisconnect.set",this._path),Xc("OnDisconnect.set",t,this._path,!1);const e=new Jn;return lv(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}setWithPriority(t,e){Ha("OnDisconnect.setWithPriority",this._path),Xc("OnDisconnect.setWithPriority",t,this._path,!1),RD("OnDisconnect.setWithPriority",e);const n=new Jn;return jD(this._repo,this._path,t,e,n.wrapCallback(()=>{})),n.promise}update(t){Ha("OnDisconnect.update",this._path),cA("OnDisconnect.update",t,this._path);const e=new Jn;return GD(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(t,e,n,s){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=s}get key(){return Dt(this._path)?null:dp(this._path)}get ref(){return new as(this._repo,this._path)}get _queryIdentifier(){const t=Xb(this._queryParams),e=lp(t);return e==="{}"?"default":e}get _queryObject(){return Xb(this._queryParams)}isEqual(t){if(t=Us(t),!(t instanceof zp))return!1;const e=this._repo===t._repo,n=fp(this._path,t._path),s=this._queryIdentifier===t._queryIdentifier;return e&&n&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+Ux(this._path)}}class as extends zp{constructor(t,e){super(t,e,new _p,!1)}get parent(){const t=O0(this._path);return t===null?null:new as(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class $c{constructor(t,e,n){this._node=t,this.ref=e,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new zt(t),n=Fo(this.ref,t);return new $c(this._node.getChild(e),n,ie)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(n,s)=>t(new $c(s,Fo(this.ref,n),ie)))}hasChild(t){const e=new zt(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Xn(r,t){return r=Us(r),r._checkNotDeleted("ref"),t!==void 0?Fo(r._root,t):r._root}function Fo(r,t){return r=Us(r),Tt(r._path)===null?DD("child","path",t):uA("child","path",t),new as(r._repo,ne(r._path,t))}function iM(r){return r=Us(r),new nM(r._repo,r._path)}function sM(r,t){r=Us(r),Ha("push",r._path),Xc("push",t,r._path,!0);const e=fA(r._repo),n=ZD(e),s=Fo(r,n),o=Fo(r,n);let c;return t!=null?c=Tc(o,t).then(()=>o):c=Promise.resolve(o),s.then=c.then.bind(c),s.catch=c.then.bind(c,void 0),s}function Tc(r,t){r=Us(r),Ha("set",r._path),Xc("set",t,r._path,!1);const e=new Jn;return FD(r._repo,r._path,t,null,e.wrapCallback(()=>{})),e.promise}function hv(r,t){cA("update",t,r._path);const e=new Jn;return HD(r._repo,r._path,t,e.wrapCallback(()=>{})),e.promise}class Up{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,e){const n=e._queryParams.getIndex();return new JD("value",this,new $c(t.snapshotNode,new as(e._repo,e._path),n))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new tM(this,t,e):null}matches(t){return t instanceof Up?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function aM(r,t,e,n,s){const o=new eM(e,void 0),c=new Up(o);return qD(r._repo,r,c),()=>VD(r._repo,r,c)}function Ac(r,t,e,n){return aM(r,"value",t)}JR(as);aD(as);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rM="FIREBASE_DATABASE_EMULATOR_HOST",zf={};let oM=!1;function lM(r,t,e,n){const s=t.lastIndexOf(":"),o=t.substring(0,s),c=rp(o);r.repoInfo_=new E0(t,c,r.repoInfo_.namespace,r.repoInfo_.webSocketOnly,r.repoInfo_.nodeAdmin,r.repoInfo_.persistenceKey,r.repoInfo_.includeNamespaceInQueryParams,!0,e),n&&(r.authTokenProvider_=n)}function cM(r,t,e,n,s){let o=n||r.options.databaseURL;o===void 0&&(r.options.projectId||Ei("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Te("Using default host for project ",r.options.projectId),o=`${r.options.projectId}-default-rtdb.firebaseio.com`);let c=cv(o,s),h=c.repoInfo,d;typeof process<"u"&&Db&&(d=Db[rM]),d?(o=`http://${d}?ns=${h.namespace}`,c=cv(o,s),h=c.repoInfo):c.repoInfo.secure;const f=new gx(r.name,r.options,t);MD("Invalid Firebase Database URL",c),Dt(c.path)||Ei("Database URL must point to the root of a Firebase Database (not including a child path).");const g=hM(h,r,f,new px(r,e));return new dM(g,r)}function uM(r,t){const e=zf[t];(!e||e[r.key]!==r)&&Ei(`Database ${t}(${r.repoInfo_}) has already been deleted.`),YD(r),delete e[r.key]}function hM(r,t,e,n){let s=zf[t.name];s||(s={},zf[t.name]=s);let o=s[r.toURLString()];return o&&Ei("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new ID(r,oM,e,n),s[r.toURLString()]=o,o}class dM{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(PD(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new as(this._repo,Bt())),this._rootInternal}_delete(){return this._rootInternal!==null&&(uM(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Ei("Cannot call "+t+" on a deleted database.")}}function fM(r=HT(),t){const e=LT(r,"database").getImmediate({identifier:t});if(!e._instanceStarted){const n=bC("database");n&&pM(e,...n)}return e}function pM(r,t,e,n={}){r=Us(r),r._checkNotDeleted("useEmulator");const s=`${t}:${e}`,o=r._repoInternal;if(r._instanceStarted){if(s===r._repoInternal.repoInfo_.host&&Oc(n,o.repoInfo_.emulatorOptions))return;Ei("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let c;if(o.repoInfo_.nodeAdmin)n.mockUserToken&&Ei('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new Cc(Cc.OWNER);else if(n.mockUserToken){const h=typeof n.mockUserToken=="string"?n.mockUserToken:AC(n.mockUserToken,r.app.options.projectId);c=new Cc(h)}rp(t)&&(vC(t),wC("Database",!0)),lM(o,s,n,c)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gM(r){ZT(FT),Lc(new Mo("database",(t,{instanceIdentifier:e})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return cM(n,s,o,e)},"PUBLIC").setMultipleInstances(!0)),ja(Mb,Nb,r),ja(Mb,Nb,"esm2020")}Ai.prototype.simpleListen=function(r,t){this.sendRequest("q",{p:r},t)};Ai.prototype.echo=function(r,t){this.sendRequest("echo",{d:r},t)};gM();const mM={apiKey:"",authDomain:"watchtask-35eb1.firebaseapp.com",databaseURL:"https://watchtask-35eb1-default-rtdb.firebaseio.com",projectId:"watchtask-35eb1",storageBucket:"watchtask-35eb1.appspot.com",messagingSenderId:"421711878688",appId:"1:421711878688:web:xxxxxxxxxxxxxxxx"},_M=r0(mM),$n=fM(_M);function dv(){return crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const t=Math.random()*16|0;return(r==="x"?t:t&3|8).toString(16)})}const Wn="peers",yM="profilesDB",Qn="profiles";async function Oa(){return sp(yM,1,{upgrade(r){r.objectStoreNames.contains(Qn)||r.createObjectStore(Qn,{keyPath:"code"})}})}function bM({autoStart:r=!0}={}){const[t]=ht.useState(()=>dv()),[e,n]=ht.useState(null),[s,o]=ht.useState([]),[c,h]=ht.useState({}),[d,f]=ht.useState([]),[g,_]=ht.useState("idle"),[y,b]=ht.useState(!1),A=ht.useRef(null),S=ht.useRef({}),w=ht.useRef({}),C=ht.useRef(null),D=ht.useRef(!1),x=ht.useRef(null),I=ht.useRef(0),O=ht.useRef({}),P=ht.useRef(null),G=ht.useRef({}),Y=ht.useRef(!1),j=ht.useCallback(N=>f(q=>[...q,N]),[]),at=ht.useCallback(async()=>{const q=await(await Oa()).getAll(Qn);o(q)},[]),nt=ht.useCallback(async N=>{if(!N||!N.code)return;const q=await Oa();await q.get(Qn,N.code)||(await q.put(Qn,N),await at(),j(`Perfil ${N.code} almacenado`))},[at,j]),pt=ht.useCallback((N,q)=>{try{const K=JSON.parse(q);if(K.__type==="profile"){h(Q=>({...Q,[N]:{...Q[N]||{},profile:K.profile}})),nt(K.profile);return}if(K.__type==="profilesSync"&&Array.isArray(K.profiles)){const Q=K.profiles.length;K.profiles.forEach(Z=>nt(Z)),G.current[N]=Q,s.length>=Q&&(Y.current=!0),j(`[sync:recv] profilesSync de ${N} len=${Q} local=${s.length}`);return}if(K.__type==="requestProfiles"){if(s.length){const Q=S.current[N];Q?.dc?.readyState==="open"&&(Q.dc.send(JSON.stringify({__type:"profilesSync",profiles:s})),w.current[N]={len:s.length,sentOnce:!0},j(`[_sync:respond] ALWAYS profilesSync a ${N} len=${s.length}`))}return}if(setTimeout(()=>{if(!Y.current&&s.length&&(w.current[targetId]||{len:0,sentOnce:!1}).len<s.length)try{dc.send(JSON.stringify({__type:"profilesSync",profiles:s})),w.current[targetId]={len:s.length,sentOnce:!0},j(`[sync:onopen-fallback] reenviado profilesSync a ${targetId} len=${s.length}`)}catch{}},1e3),K.__type==="loginValidateRequest"){const{code:Q,password:Z}=K;(async()=>{const Ut=await(await Oa()).get(Qn,Q),Ye=!!Ut&&(!Ut.password||Ut.password===Z),De=S.current[N];De?.dc?.readyState==="open"&&De.dc.send(JSON.stringify({__type:"loginValidateResult",code:Q,ok:Ye}))})();return}if(K.__type==="loginValidateResult"){A.current&&A.current.code===K.code&&K.ok&&(b(!0),A.current=null,_("login validado (remoto)"),j("Login validado remotamente"));return}if(K.__type==="ping"){const Q=S.current[N];Q?.dc?.readyState==="open"&&Q.dc.send(JSON.stringify({__type:"pong",seq:K.seq,t:K.t})),j(`[ping<-] de ${N} seq=${K.seq}`);return}if(K.__type==="pong"){const Q=O.current[K.seq];if(Q){const Z=Date.now()-Q;delete O.current[K.seq],j(`[pong<-] de ${N} seq=${K.seq} rtt=${Z}ms`)}else j(`[pong<-] desconocido seq=${K.seq} de ${N}`);return}}catch{}j(`${N}: ${q}`)},[j,nt,s]),et=ht.useCallback(async()=>{try{const N=await Oa();if(!await N.get(Qn,"1111")){const K={code:"1111",name:"Root Admin",uuid:dv(),role:"admin",speciality:"admin",password:"1234"};await N.put(Qn,K),j("Perfil root admin creado (1111 / 1234)"),await at()}}catch{j("No se pudo crear root admin")}},[j,at]),Et=ht.useCallback(async N=>{if(!D.current)throw new Error("Solo admin puede agregar perfiles");await(await Oa()).put(Qn,N),await at(),Object.values(S.current).forEach(({dc:K})=>{K?.readyState==="open"&&K.send(JSON.stringify({__type:"profile",profile:N}))})},[at]),St=ht.useCallback(async(N,q)=>{const Q=await(await Oa()).get(Qn,N);if(!Q)throw new Error("Perfil no encontrado local");if(Q.password&&Q.password!==q)throw new Error("Password incorrecto local");const Z=Object.values(S.current).some(({dc:De})=>De?.readyState==="open"||De?.readyState==="connecting");if(n(Q),D.current=Q.role==="admin",!Z){b(!0),_("login validado (sin peers)"),j("Login validado localmente (no peers disponibles)");return}_("validando login remoto"),A.current={code:N,password:q};const rt=()=>{Object.values(S.current).forEach(({dc:De})=>{De?.readyState==="open"&&De.send(JSON.stringify({__type:"loginValidateRequest",code:N,password:q}))})};rt();let Ut=0;const Ye=setInterval(()=>{if(y){clearInterval(Ye);return}Ut++,rt(),Ut>=2&&clearInterval(Ye)},1200);setTimeout(()=>{y||(b(!0),_("login validado (fallback)"),j("Login validado por fallback tras retries"))},4e3)},[j,y]),k=ht.useCallback(async()=>{const N=Xn($n,`${Wn}/${t}`);await Tc(N,{ts:Date.now(),profileCode:null,profileName:null,profileCount:0}),iM(N).remove().catch(()=>{})},[t]),U=ht.useCallback(()=>{if(C.current)return;const N=Xn($n,Wn);C.current=Ac(N,q=>{const K=q.val()||{},Q=Object.keys(K).filter(Z=>Z!==t);Q.forEach(Z=>{S.current[Z]||$(Z)}),Object.keys(S.current).forEach(Z=>{Q.includes(Z)||(S.current[Z].pc.close(),delete S.current[Z],h(rt=>({...rt,[Z]:{...rt[Z]||{},state:"offline"}})))}),h(Z=>{const rt={...Z};return Q.forEach(Ut=>{const Ye=K[Ut]||{};rt[Ut]={...rt[Ut]||{},presenceProfileCode:Ye.profileCode||null,presenceProfileName:Ye.profileName||null,presenceProfileCount:Ye.profileCount??null}}),rt})})},[t]),it=ht.useCallback(async N=>{const q=S.current[N];if(!q)return;const{pc:K}=q;try{const Q=await K.createOffer();await K.setLocalDescription(Q);const Z=Xn($n,`${Wn}/${N}/offers/${t}`);await Tc(Z,Q)}catch{j(`Error creando offer a ${N}`)}},[j,t]),bt=ht.useCallback((N,q)=>{const K=Xn($n,`${Wn}/${t}/offers/${N}`);Ac(K,async Z=>{const rt=Z.val();if(rt&&(!q.currentRemoteDescription||q.currentRemoteDescription.type!=="offer")){await q.setRemoteDescription(rt);const Ut=await q.createAnswer();await q.setLocalDescription(Ut),await Tc(Xn($n,`${Wn}/${N}/answers/${t}`),Ut)}});const Q=Xn($n,`${Wn}/${t}/answers/${N}`);Ac(Q,async Z=>{const rt=Z.val();rt&&q.signalingState==="have-local-offer"&&await q.setRemoteDescription(rt)})},[t]),R=ht.useCallback((N,q)=>{const K=Xn($n,`${Wn}/${t}/candidates/${N}`);Ac(K,async Q=>{const Z=Q.val()||{};for(const rt of Object.keys(Z)){const Ut=Z[rt];try{await q.addIceCandidate(new RTCIceCandidate(Ut))}catch{}}})},[t]),$=ht.useCallback(N=>{const q=new RTCPeerConnection,K=Z=>{S.current[N].dc=Z,h(rt=>({...rt,[N]:{...rt[N]||{},state:Z.readyState}})),Z.onopen=()=>{if(h(rt=>({...rt,[N]:{...rt[N]||{},state:"open"}})),j(`Canal abierto con ${N}`),e&&Z.send(JSON.stringify({__type:"profile",profile:e})),s.length&&(()=>{const rt=w.current[N]||{len:0,sentOnce:!1};return!rt.sentOnce||rt.len<s.length})()){Z.send(JSON.stringify({__type:"profilesSync",profiles:s}));const rt=w.current[N]?.sentOnce;w.current[N]={len:s.length,sentOnce:!0},j(rt?`ProfilesSync reenviado onopen a ${N} (len=${s.length})`:`ProfilesSync enviado onopen-first a ${N} (len=${s.length})`)}if(Y.current||(Z.send(JSON.stringify({__type:"requestProfiles"})),j(`[sync:request] requestProfiles onopen a ${N}`)),A.current){const{code:rt,password:Ut}=A.current;Z.send(JSON.stringify({__type:"loginValidateRequest",code:rt,password:Ut}))}},Z.onmessage=rt=>pt(N,rt.data),Z.onclose=()=>h(rt=>({...rt,[N]:{...rt[N]||{},state:"closed"}}))};S.current[N]={pc:q,dc:null,makingOffer:!1},h(Z=>({...Z,[N]:{...Z[N]||{},state:"connecting"}}));const Q=t<N;if(Q){const Z=q.createDataChannel("mesh");K(Z)}else q.ondatachannel=Z=>{S.current[N]&&K(Z.channel)};q.onicecandidate=Z=>{if(Z.candidate){const rt=Xn($n,`${Wn}/${N}/candidates/${t}`);sM(rt,Z.candidate.toJSON())}},q.onconnectionstatechange=()=>{h(Z=>({...Z,[N]:{...Z[N]||{},connState:q.connectionState}}))},Q&&it(N),bt(N,q),R(N,q)},[j,e,t,s,pt,it,bt,R]),J=ht.useCallback(N=>{Object.entries(S.current).forEach(([q,{dc:K}])=>{K?.readyState==="open"&&K.send(N)}),j(`Yo: ${N}`)},[j]);return ht.useEffect(()=>{s.length&&Object.entries(S.current).forEach(([N,{dc:q}])=>{const K=w.current[N]||{len:0};q?.readyState==="open"&&K.len<s.length&&(q.send(JSON.stringify({__type:"profilesSync",profiles:s})),w.current[N]={len:s.length,sentOnce:!0},j(`ProfilesSync enviado diferido a ${N} (len=${s.length})`))})},[s,j]),ht.useEffect(()=>{if(!s.length)return;let N=0;const q=setInterval(()=>{if(N+=3e3,N>15e3){clearInterval(q);return}Object.entries(S.current).forEach(([K,{dc:Q}])=>{if(Q?.readyState==="open"){const Z=w.current[K]||{len:0,sentOnce:!1},rt=G.current[K]||0;if(!Z.sentOnce||Z.len<s.length||rt===0)try{Q.send(JSON.stringify({__type:"profilesSync",profiles:s})),w.current[K]={len:s.length,sentOnce:!0},j(`[sync:proactive] broadcast a ${K} len=${s.length}`)}catch{}}})},3e3);return()=>clearInterval(q)},[s,j]),ht.useEffect(()=>{if(!P.current)return P.current=setInterval(()=>{Object.entries(S.current).forEach(([N,{dc:q}])=>{if(q?.readyState==="open"){const K=++I.current,Q=Date.now();O.current[K]=Q;try{q.send(JSON.stringify({__type:"ping",seq:K,t:Q})),j(`[ping->] a ${N} seq=${K}`)}catch{}}})},5e3),()=>{P.current&&(clearInterval(P.current),P.current=null)}},[j]),ht.useEffect(()=>{if(Y.current)return;let N=0;const q=setInterval(()=>{if(Y.current){clearInterval(q);return}N++,Object.entries(S.current).forEach(([Q,{dc:Z}])=>{Z?.readyState==="open"&&Z.send(JSON.stringify({__type:"requestProfiles"}))}),j(`[sync:periodic] requestProfiles extra intento ${N}`);const K=Math.max(0,...Object.values(G.current));K&&s.length>=K?(Y.current=!0,j(`[sync] completado por periodic len=${s.length}`),clearInterval(q)):N>=10&&(clearInterval(q),j("[sync:periodic] stop tras 10 intentos"))},4e3);return()=>clearInterval(q)},[s,j]),ht.useEffect(()=>{if(s.length){x.current&&(clearInterval(x.current),x.current=null);return}if(!Object.values(S.current).some(({dc:K})=>K?.readyState==="open")||x.current)return;let q=0;return x.current=setInterval(()=>{if(s.length){clearInterval(x.current),x.current=null;return}q++,Object.entries(S.current).forEach(([K,{dc:Q}])=>{Q?.readyState==="open"&&Q.send(JSON.stringify({__type:"requestProfiles"}))}),j(`[sync:retry] requestProfiles intento ${q}`),q>=8&&(clearInterval(x.current),x.current=null,j("[sync:retry] máximo de intentos alcanzado"))},2500),()=>{x.current&&(clearInterval(x.current),x.current=null)}},[s,j]),ht.useEffect(()=>{if(r)return k(),U(),(async()=>(await et(),await at()))(),()=>{C.current&&C.current(),Object.values(S.current).forEach(({pc:N})=>N.close()),x.current&&(clearInterval(x.current),x.current=null)}},[r,k,U,at,et]),ht.useEffect(()=>{if(!e)return;const N=Xn($n,`${Wn}/${t}`);hv(N,{profileCode:e.code||null,profileName:e.name||null}).catch(()=>{}),Object.values(S.current).forEach(({dc:q})=>{q?.readyState==="open"&&q.send(JSON.stringify({__type:"profile",profile:e}))})},[e,t]),ht.useEffect(()=>{const N=Xn($n,`${Wn}/${t}`);hv(N,{profileCount:s.length}).catch(()=>{}),Object.entries(c).forEach(([q,K])=>{if(K.presenceProfileCount!=null&&K.presenceProfileCount>s.length){const Q=S.current[q];Q?.dc?.readyState==="open"&&(Q.dc.send(JSON.stringify({__type:"requestProfiles"})),j(`[sync:catchup] solicito perfiles a ${q} remote=${K.presenceProfileCount} local=${s.length}`))}})},[s.length]),{peerId:t,status:g,messages:d,peers:Object.entries(c).map(([N,q])=>({id:N,...q})),knownProfiles:s,profile:e,addProfile:Et,login:St,broadcast:J,isAdmin:D.current,loginValidated:y}}function vM(){const{peerId:r,peers:t,messages:e,knownProfiles:n,profile:s,addProfile:o,login:c,broadcast:h,isAdmin:d,loginValidated:f}=bM(),[g,_]=ht.useState(""),[y,b]=ht.useState(""),[A,S]=ht.useState("maintenance"),[w,C]=ht.useState("mechanic"),[D,x]=ht.useState(""),[I,O]=ht.useState(""),[P,G]=ht.useState(""),[Y,j]=ht.useState(""),at=async()=>{try{await o({code:g.trim(),name:y,uuid:crypto.randomUUID(),role:A,speciality:w,password:Y}),_(""),b(""),j("")}catch(et){console.warn(et)}},nt=async()=>{try{await c(D.trim(),I)}catch(et){console.warn(et)}},pt=()=>{P&&(h(P),G(""))};return st.jsxs("div",{className:"flex flex-col gap-4",children:[st.jsxs("div",{className:"text-xs font-mono p-2 bg-gray-100 rounded border",children:["PeerId: ",r]}),!s&&st.jsxs("div",{className:"card bg-white border p-3 flex flex-col gap-2",children:[st.jsx("h3",{className:"heading",children:"Login"}),st.jsxs("div",{className:"flex flex-col gap-2",children:[st.jsxs("div",{className:"flex gap-2",children:[st.jsx("input",{className:"input",placeholder:"code",value:D,onChange:et=>x(et.target.value)}),st.jsx("input",{className:"input",placeholder:"password",type:"password",value:I,onChange:et=>O(et.target.value)}),st.jsx("button",{className:"btn btn-primary",onClick:nt,children:"Entrar"})]}),st.jsx("div",{className:"text-[10px] text-gray-500",children:f?"Validado":"Pendiente validación"})]})]}),d&&st.jsxs("div",{className:"card bg-white border p-3 flex flex-col gap-2",children:[st.jsx("h3",{className:"heading",children:"Agregar Perfil (admin)"}),st.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[st.jsx("input",{className:"input col-span-1",placeholder:"code",value:g,onChange:et=>_(et.target.value)}),st.jsx("input",{className:"input col-span-1",placeholder:"nombre",value:y,onChange:et=>b(et.target.value)}),st.jsxs("select",{className:"input",value:A,onChange:et=>S(et.target.value),children:[st.jsx("option",{value:"admin",children:"admin"}),st.jsx("option",{value:"supervisor",children:"supervisor"}),st.jsx("option",{value:"maintenance",children:"maintenance"})]}),st.jsxs("select",{className:"input",value:w,onChange:et=>C(et.target.value),children:[st.jsx("option",{value:"electric",children:"electric"}),st.jsx("option",{value:"mechanic",children:"mechanic"}),st.jsx("option",{value:"admin",children:"admin"})]}),st.jsx("input",{className:"input col-span-2",placeholder:"password",type:"password",value:Y,onChange:et=>j(et.target.value)})]}),st.jsx("button",{className:"btn btn-outline",onClick:at,disabled:!g||!y,children:"Guardar"})]}),st.jsxs("div",{className:"card p-3 border flex flex-col gap-2",children:[st.jsxs("h3",{className:"heading",children:["Perfiles (",n.length,")"]}),st.jsx("ul",{className:"max-h-40 overflow-auto text-xs space-y-1",children:n.map(et=>st.jsxs("li",{className:"px-2 py-1 bg-gray-50 rounded border flex justify-between",children:[st.jsxs("span",{children:[et.code," - ",et.name]}),st.jsx("span",{className:"opacity-60",children:et.role})]},et.code))})]}),st.jsxs("div",{className:"card p-3 border flex flex-col gap-2",children:[st.jsxs("h3",{className:"heading",children:["Peers (",t.length,")"]}),st.jsx("ul",{className:"text-xs space-y-1 max-h-32 overflow-auto",children:t.map(et=>st.jsxs("li",{className:"px-2 py-1 bg-blue-50 rounded border border-blue-100",children:[st.jsxs("div",{className:"flex justify-between",children:[st.jsx("span",{children:et.presenceProfileCode||et.profile?.code||et.id.slice(0,8)}),st.jsx("span",{children:et.state})]}),(et.profile||et.presenceProfileName)&&st.jsxs("div",{className:"text-[10px] mt-1 italic",children:[(et.profile?.name||et.presenceProfileName)??""," (",et.profile?.role||"?",")"]})]},et.id))})]}),st.jsxs("div",{className:"card p-3 border flex flex-col gap-2",children:[st.jsx("h3",{className:"heading",children:"Chat"}),st.jsxs("div",{className:"flex gap-2",children:[st.jsx("input",{className:"input flex-1",placeholder:"mensaje",value:P,onChange:et=>G(et.target.value)}),st.jsx("button",{className:"btn btn-primary",onClick:pt,disabled:!P,children:"Enviar"})]}),st.jsx("ul",{className:"text-xs max-h-48 overflow-auto space-y-1",children:e.map((et,Et)=>st.jsx("li",{className:"px-2 py-1 bg-gray-100 rounded",children:et},Et))})]})]})}function AM(){const[r,t]=ht.useState(0),[e,n]=ht.useState(0);ht.useEffect(()=>{navigator.storage&&navigator.storage.persist&&navigator.storage.persist().then(o=>{console.log(o?"Almacenamiento persistente garantizado":"No se pudo garantizar almacenamiento persistente")})},[]),ht.useEffect(()=>{async function o(){const h=await sp("pdfDataDB",1,{upgrade(f){f.objectStoreNames.contains("pdfData")||f.createObjectStore("pdfData",{keyPath:"id"})}});let d=0;try{d=await h.count("pdfData")}catch{d=0}n(d)}o();const c=setInterval(o,5e3);return()=>clearInterval(c)},[]);async function s(o){await lC(o,t)}return st.jsxs("div",{className:"min-h-screen flex flex-col",children:[st.jsx("header",{className:"bg-blue-700 text-white shadow-sm",children:st.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-4 flex flex-col sm:flex-row gap-4 sm:items-center sm:justify-between",children:[st.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"WatchTask"}),st.jsx("div",{className:"flex items-center gap-3",children:st.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium cursor-pointer",children:[st.jsx("span",{className:"hidden sm:inline",children:"Cargar PDF"}),st.jsx("input",{type:"file",accept:"application/pdf",onChange:o=>s(o.target.files[0]),className:"block text-sm text-white file:mr-4 file:py-1 file:px-3 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-white file:text-blue-700 hover:file:bg-blue-100"})]})})]})}),st.jsxs("main",{className:"flex-1 max-w-5xl w-full mx-auto px-4 py-6 grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[st.jsxs("section",{className:"card md:col-span-1 lg:col-span-1 flex flex-col gap-2",children:[st.jsx("h2",{className:"heading",children:"Resumen"}),st.jsx("p",{className:"muted",children:"Estado general de los datos procesados."}),st.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-3 text-center",children:[st.jsxs("div",{className:"p-3 rounded-md bg-blue-50 border border-blue-100",children:[st.jsx("p",{className:"text-xs uppercase tracking-wide text-blue-600 font-semibold",children:"Órdenes"}),st.jsx("p",{className:"text-lg font-semibold text-blue-700",children:r})]}),st.jsxs("div",{className:"p-3 rounded-md bg-blue-50 border border-blue-100",children:[st.jsx("p",{className:"text-xs uppercase tracking-wide text-blue-600 font-semibold",children:"En DB"}),st.jsx("p",{className:"text-lg font-semibold text-blue-700",children:e})]})]})]}),st.jsx("section",{className:"card md:col-span-1 lg:col-span-2 flex flex-col gap-6",children:st.jsx(vM,{})})]}),st.jsx("footer",{className:"mt-auto bg-white border-t border-gray-200",children:st.jsx("div",{className:"max-w-5xl mx-auto px-4 py-3 text-xs text-gray-500 flex items-center justify-between",children:st.jsxs("span",{children:["© ",new Date().getFullYear()," WatchTask v0.0.4.9.1"]})})})]})}WE.createRoot(document.getElementById("root")).render(st.jsx(ht.StrictMode,{children:st.jsx(AM,{})}));
